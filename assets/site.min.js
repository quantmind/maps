!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.d3=t.d3||{})}(this,function(t){"use strict";function e(){}function n(t,n){var r=new e;if(t instanceof e)t.each(function(t,e){r.set(e,t)});else if(Array.isArray(t)){var i,a=-1,o=t.length;if(null==n)for(;++a<o;)r.set(a,t[a]);else for(;++a<o;)r.set(n(i=t[a],a,t),i)}else if(t)for(var u in t)r.set(u,t[u]);return r}function r(){}function i(t,e){var n=new r;if(t instanceof r)t.each(function(t){n.add(t)});else if(t){var i=-1,a=t.length;if(null==e)for(;++i<a;)n.add(t[i]);else for(;++i<a;)n.add(e(t[i],i,t))}return n}function a(t){return"[object Object]"===nr.call(t)}function o(t){return"[object String]"===nr.call(t)}function u(t){return"[object Function]"===nr.call(t)}function s(t){return"[object Array]"===nr.call(t)}function c(t){return"[object Promise]"===nr.call(t)}function l(){return xr||(kr(function(){xr=0}),xr=Mr.now()+wr)}function f(){this._call=this._time=this._next=null}function h(t,e,n){var r=new f;return r.restart(t,e,n),r}function d(){xr=(_r=Mr.now())+wr,vr=mr=0;try{!function(){l(),++vr;for(var t,e=sr;e;)(t=xr-e._time)>=0&&e._call.call(null,t),e=e._next;--vr}()}finally{vr=0,function(){var t,e,n=sr,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:sr=e);cr=t,p(r)}(),xr=0}}function p(t){if(!vr){mr&&(mr=clearTimeout(mr));t-xr>24?(t<1/0&&(mr=setTimeout(d,t-Mr.now()-wr)),yr&&(yr=clearInterval(yr))):(yr||(_r=Mr.now(),yr=setInterval(function(){var t=Mr.now(),e=t-_r;e>br&&(wr-=e,_r=t)},br)),vr=1,kr(d))}}function g(t,e,n){return function(r){var i=$r;$r=r;try{t.call(this,this.__data__,e,n)}finally{$r=i}}}function v(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function m(t,e){return t.style.getPropertyValue(e)||qr(t).getComputedStyle(t,null).getPropertyValue(e)}function y(t){return t.trim().split(/^|\s+/)}function b(t){return t.classList||new _(t)}function _(t){this._node=t,this._names=y(t.getAttribute("class")||"")}function x(t,e){for(var n=b(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function w(t,e){for(var n=b(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function M(t,e,n){var r=qr(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function k(t,e){this._groups=t,this._parents=e}function A(){return new k([[document.documentElement]],Xr)}function E(t){function e(t){Br(this).el=t}return e.prototype=er({},Vr,t),e}function T(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new S(r)}function S(t){this._=t}function C(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Qr,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}function N(t){var e=lr.handlebars;if(e||(e=rr?window.handlebars:require("handlebars")),e)return e.compile(t);fr("compile function requires handlebars")}function P(t,e){if(o(t)){if(!e)return t;var n=N(t);if(!n)return t;t=n}return t(e)}function z(t,e){var n=Wr(document.createElement("div"));n.html(P(t,e));var r=n.node().children;return 1!==r.length&&fr("HtmlElement function should return one root element only, got "+r.length),r[0]}function O(t){this.response=t,this.description=t.statusText}function D(t){if(t.status>=300)throw new O(t);var e=(t.headers.get("content-type")||"").split(";")[0];if("application/json"===e)return t.json();throw new Error("Expected JSON content type, got "+e)}function j(t,e,n){return n?z(t,e):P(t,e)}function $(t,e,n){switch(e.type){case ii.IDENTIFIER:return t[e.name];case ii.LITERAL:return n?t[e.value]:e.value;case ii.ARRAY_EXP:return e.elements.map(function(e){return $(t,e)});case ii.LOGICAL_EXP:case ii.BINARY_EXP:return function(t,e,n){yi[t]||(yi[t]=new Function("a","b","return a "+t+" b"));return yi[t](e,n)}(e.operator,$(t,e.left),$(t,e.right));case ii.CALL_EXP:return function(t,e,n){var r;n=n.map(function(e){return $(t,e)}),e.type!==ii.IDENTIFIER&&(t=$(t,e.object),e=e.property);if(!(r=t[e.name]))throw new EvalError('callable "'+e.name+'" not found in context');return r.apply(t,n)}(t,e.callee,e.arguments);case ii.MEMBER_EXP:return $($(t,e.object),e.property,!0);case ii.CONDITIONAL_EXP:return $(t,e.test)?$(t,e.consequent):$(t,e.alternate);case ii.UNARY_EXP:return function(t,e){mi[t]||(mi[t]=new Function("arg","return "+t+" arg"));return mi[t](e)}(e.operator,$(t,e.argument))}}function L(t,e){switch(1===arguments.length&&(e=i()),t.type){case ii.IDENTIFIER:e.add(t.name);break;case ii.ARRAY_EXP:t.elements.forEach(function(t){return L(t,e)});break;case ii.LOGICAL_EXP:case ii.BINARY_EXP:L(t.left,e),L(t.right,e);break;case ii.CALL_EXP:L(t.callee,e),t.arguments.forEach(function(t){return L(t,e)});break;case ii.MEMBER_EXP:e.add(F(t));break;case ii.CONDITIONAL_EXP:L(t.test,e),L(t.consequent,e),$(t.alternate,e);break;case ii.UNARY_EXP:L(t.argument,e)}return e}function F(t){return t.type===ii.IDENTIFIER?t.name:F(t.object)+"."+t.property.name}function U(t){this.codes=ii,this.expr=t,this.parsed=vi(t)}function H(t,e,r,i){var a=n(),o=null;a.set("",wi()),Object.defineProperties(xi(t),{$events:{get:function(){return a}},parent:{get:function(){return r}},isolated:{get:function(){return i}}}),t.$child=function(e){return null===o&&(o=function(t){function e(e){H(this,e,t,!1)}return e.prototype=t,e}(t)),new o(e)},t.$update(e)}function Y(t){return a(t)&&"[object d3Model]"===t.toString()}function R(t,e){var n=t.$events.get(e);return!n&&t.parent?R(t.parent,e):n}function q(t,e){e?t.on("change."+e,null):t.on("change",null)}function X(t,e){H(this,t,e,!0)}function W(t){return new X(t)}function I(t,e,n){var r=t.get(e.uid),a=3===arguments.length?e[n]:void 0;r||(r={model:e,events:i()},t.set(e.uid,r)),u(a)||2===arguments.length?r.events.add(""):a instanceof W?(r.events.add(""),I(t,a)):(e.$isReactive(n)||e.$set(n,e[n]),r.events.add(n))}function B(t,e,r){function i(e){var i=ar(e,"parent"),a=n(i?i.components:null),o=n(i?i.directives:r),h=T("message","mounted"),d={};s.each(function(t,e){a.set(e,t)}),c.each(function(t,e){o.set(e,t)}),V(a,ar(e,"components")),G(o,ar(e,"directives")),Object.defineProperties(this,{name:{get:function(){return t}},components:{get:function(){return a}},directives:{get:function(){return o}},parent:{get:function(){return i}},root:{get:function(){return i?i.root:this}},cache:{get:function(){return i?i.cache:d}},props:{get:function(){return f}},uid:{get:function(){return this.model.uid}},events:{get:function(){return h}}}),this.model=er({},u(l)?l():l,ar(e,"model")),Si.call("component-created",void 0,this)}function a(t){return new i(t)}u(e)&&(e={render:e});var o=er({},e),s=V(n(),ar(o,"components")),c=G(n(),ar(o,"directives")),l=ar(o,"model"),f=ar(o,"props");return i.prototype=er({},ri,Ci,o),a.prototype=i.prototype,a}function V(t,e){return n(e).each(function(e,n){t.set(n,B(n,e,Ci))}),t}function G(t,e){return n(e).each(function(e,n){t.set(n,Ei(e))}),t}function K(t,e,n){return Object.defineProperty(Br(t),"el",{get:function(){return e}}),t.select(e).view(t).mount(null,n).then(function(){return function(t,e){var n=t.parent;t.childrenMounted(),n&&!n.isMounted?n.events.on("mounted."+t.uid,function(){Z(t,e)}):Z(t,e)}(t,n)})}function Z(t,e){return void 0===t.isMounted?(t.isMounted=!1,!1):(t.isMounted?fr("view "+t.name+" already mounted"):(t.isMounted=!0,t.mounted(),e&&e(t),t.events.call("mounted",void 0,t,e),t.events.on("mounted",null),Si.call("component-mounted",void 0,t)),!0)}function J(){this.attrs={},this.all=[]}function Q(t,e,n,r){if(t&&t.tagName){var i=e.components.get(t.tagName.toLowerCase()),a=Pi(t,e.directives),o=a.preMount();if(o)return o.execute(e.model);var u=void 0;return u=i?[i({parent:e}).mount(t,n,r)]:ki(t.children).map(function(t){return Q(t,e,n,r)}),Promise.all(u).then(function(){return a.execute(e.model)})}}function tt(){var t=this.__d3_directives__,e=this.__d3_view__;t&&(t.all.forEach(function(t){return t.destroy()}),delete this.__d3_directives__),e&&(e.destroy(),delete this.__d3_view__)}function et(){document.removeEventListener("DOMContentLoaded",et),window.removeEventListener("load",et),nt()}function nt(){for(var t=void 0;lr.readyCallbacks.length;)t=lr.readyCallbacks.shift(),Ar(t)}function rt(t){var e=this.model.data.children;if(e){if(!s(e))return Fi("children should be an array of fields, for "+(void 0===e?"undefined":gr(e))),t;t.selectAll(".d3form").data(e).enter().append(function(t){var e=function(t){var e=t.type||"text";return Yi[e]||e}(t);e||(Fi("Could not find form component "+t.type),e="input",t.type="hidden");return document.createElement("d3-form-"+e)}).classed("d3form",!0)}return t}function it(t){var e=t.attr("min"),n=t.attr("max");return e=null===e?-1/0:+e,n=null===n?1/0:+n,[e,n]}function at(t){function e(r){var i=t(r+""),a=n.get(i);return a||n.set(i,a=new Promise(function(t,n){var r=document.createElement("script");r.onload=function(){if(1!==na.length)return n(new Error("invalid module"));t(na.pop()(e))},r.onerror=function(){n(new Error("unable to load module"))},r.async=!0,r.src=i,window.define=ut,document.head.appendChild(r)})),a}var n=new Map;return function(t){return arguments.length>1?Promise.all(ra.call(arguments,e)).then(function(t){var e,n,r={},i=-1,a=t.length;for(;++i<a;)for(n in e=t[i])aa.call(e,n)&&(null==e[n]?Object.defineProperty(r,n,{get:function(t,e){return function(){return t[e]}}(e,n)}):r[n]=e[n]);return r}):e(t)}}function ot(t){return t+""=="exports"}function ut(t,e,n){arguments.length<3&&(n=e,e=t),arguments.length<2&&(n=e,e=[]),na.push(ia.call(e,ot)?function(t){var r={};return Promise.all(ra.call(e,function(e){return ot(e+="")?r:t(e)})).then(function(t){return n.apply(null,t),r})}:function(t){return Promise.all(ra.call(e,t)).then(function(t){return"function"==typeof n?n.apply(null,t):n})})}function st(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=ga?10:a>=va?5:a>=ma?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=ga?10:a>=va?5:a>=ma?2:1)}function ct(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=ga?i*=10:a>=va?i*=5:a>=ma&&(i*=2),e<t?-i:i}function lt(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}")}function ft(t,e,r){s(t)&&(t={store:r,data:t,dimensions:{},series:n()}),Object.defineProperties(this,{_inner:{get:function(){return t}},store:{get:function(){return t.store}},data:{get:function(){return t.data}},dimensions:{get:function(){return t.dimensions}},series:{get:function(){return t.series}},type:{get:function(){return"dataframe"}}}),this.serie=e}function ht(t){this.frames=n(),Object.defineProperties(this,{store:{get:function(){return t}},type:{get:function(){return"frameCollection"}}})}function dt(t,e){return t.reduce(function(t,n){return void 0!==e(n)&&(t+=1),t},0)}function pt(t,e,n,r){function i(e){return t(e=new Date(+e)),e}return i.floor=i,i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return o;do{o.push(new Date(+n))}while(e(n,a),t(n),n<r);return o},i.filter=function(n){return pt(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})},n&&(i.count=function(e,r){return Ia.setTime(+e),Ba.setTime(+r),t(Ia),t(Ba),Math.floor(n(Ia,Ba))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}function gt(t){return pt(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ga)/Ka})}function vt(t){return pt(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/Ka})}function mt(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function yt(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function bt(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function _t(t){return new RegExp("^(?:"+t.map(function(t){return t.replace(wo,"\\$&")}).join("|")+")","i")}function xt(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function wt(t,e,n){var r=_o.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Mt(t,e,n){var r=_o.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function kt(t,e){return bt(t.getDate(),e,2)}function At(t,e){return bt(t.getMilliseconds(),e,3)}function Et(t,e){return bt(t.getUTCDate(),e,2)}function Tt(t,e){return bt(t.getUTCMilliseconds(),e,3)}function St(){return"%"}function Ct(t){return+t}function Nt(t){return Math.floor(+t/1e3)}function Pt(t,e,n){if(s(n)?t=t.new(n):n&&(t=n),e.length){var r=e.splice(0,1)[0],i=r?r(t):null;return c(i)?i.then(function(n){return Pt(t,e,n)}):Pt(t,e,i)}return t}function zt(t){var e=n();Object.defineProperties(this,{sources:{get:function(){return e}}}),this.transforms=er({},No),this.dataCount=0,this.model=t&&u(t.$child)?t:W(t)}function Ot(t,e){var n=t.__transition;if(!n||!(n=n[e])||n.state>$o)throw new Error("too late");return n}function Dt(t,e){var n=t.__transition;if(!n||!(n=n[e])||n.state>Fo)throw new Error("too late");return n}function jt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("too late");return n}function $t(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Lt(){}function Ft(t){var e;return t=(t+"").trim().toLowerCase(),(e=Go.exec(t))?(e=parseInt(e[1],16),new qt(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1)):(e=Ko.exec(t))?Ut(parseInt(e[1],16)):(e=Zo.exec(t))?new qt(e[1],e[2],e[3],1):(e=Jo.exec(t))?new qt(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Qo.exec(t))?Ht(e[1],e[2],e[3],e[4]):(e=tu.exec(t))?Ht(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=eu.exec(t))?Xt(e[1],e[2]/100,e[3]/100,1):(e=nu.exec(t))?Xt(e[1],e[2]/100,e[3]/100,e[4]):ru.hasOwnProperty(t)?Ut(ru[t]):"transparent"===t?new qt(NaN,NaN,NaN,0):null}function Ut(t){return new qt(t>>16&255,t>>8&255,255&t,1)}function Ht(t,e,n,r){return r<=0&&(t=e=n=NaN),new qt(t,e,n,r)}function Yt(t){return t instanceof Lt||(t=Ft(t)),t?(t=t.rgb(),new qt(t.r,t.g,t.b,t.opacity)):new qt}function Rt(t,e,n,r){return 1===arguments.length?Yt(t):new qt(t,e,n,null==r?1:r)}function qt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Xt(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Wt(t,e,n,r)}function Wt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function It(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Bt(t){if(t instanceof Vt)return new Vt(t.l,t.a,t.b,t.opacity);if(t instanceof Qt){var e=t.h*iu;return new Vt(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof qt||(t=Yt(t));var n=Jt(t.r),r=Jt(t.g),i=Jt(t.b),a=Gt((.4124564*n+.3575761*r+.1804375*i)/ou),o=Gt((.2126729*n+.7151522*r+.072175*i)/uu);return new Vt(116*o-16,500*(a-o),200*(o-Gt((.0193339*n+.119192*r+.9503041*i)/su)),t.opacity)}function Vt(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Gt(t){return t>hu?Math.pow(t,1/3):t/fu+cu}function Kt(t){return t>lu?t*t*t:fu*(t-cu)}function Zt(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Jt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Qt(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function te(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof ee)return new ee(t.h,t.s,t.l,t.opacity);t instanceof qt||(t=Yt(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(_u*r+yu*e-bu*n)/(_u+yu-bu),a=r-i,o=(mu*(n-i)-gu*a)/vu,u=Math.sqrt(o*o+a*a)/(mu*i*(1-i)),s=u?Math.atan2(o,a)*au-120:NaN;return new ee(s<0?s+360:s,u,i,t.opacity)}(t):new ee(t,e,n,null==r?1:r)}function ee(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function ne(t,e){return function(n){return t+n*e}}function re(t,e){var n=e-t;return n?ne(t,n):Au(isNaN(t)?e:t)}function ie(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var u=[],s=[];return a=t(a),o=t(o),function(t,r,i,a,o,u){if(t!==i||r!==a){var s=o.push("translate(",null,e,null,n);u.push({i:s-4,x:Tu(t,i)},{i:s-2,x:Tu(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,u,s),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Tu(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,u,s),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Tu(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,u,s),function(t,e,n,r,a,o){if(t!==n||e!==r){var u=a.push(i(a)+"scale(",null,",",null,")");o.push({i:u-4,x:Tu(t,n)},{i:u-2,x:Tu(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,u,s),a=o=null,function(t){for(var e,n=-1,r=s.length;++n<r;)u[(e=s[n]).i]=e.x(t);return u.join("")}}}function ae(t){return function e(n){function r(e,r){var i=t((e=te(e)).h,(r=te(r)).h),a=re(e.s,r.s),o=re(e.l,r.l),u=re(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=u(t),e+""}}return n=+n,r.gamma=e,r}(1)}function oe(t,e,n){var r=t._id;return t.each(function(){var t=Dt(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return jt(t,r).value[e]}}function ue(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function se(t){return A().transition(t)}function ce(){return++Yu}function le(t,e){return"string"==typeof t&&t.indexOf("%")===t.length-1?Wu(.01*parseFloat(t)*e):+t}function fe(t,e){for(var n=t.node?t.node():t;n&&"BODY"!==n.tagName;){if(n.getBoundingClientRect()[e])return n;n=n.parentNode}}function he(t){return t&&"px"==t.substring(t.length-2)?+t.substring(0,t.length-2):0}function de(t){if(s(t))return t.map(de);if(a(t)){var e={};for(var n in t)e[n]=de(t[n]);return e}return t}function pe(t){function e(e){var n=e+"",o=r.get(n);if(!o){if(a!==es)return a;r.set(n,o=i.push(e))}return t[(o-1)%t.length]}var r=n(),i=[],a=es;return t=null==t?[]:ts.call(t),e.domain=function(t){if(!arguments.length)return i.slice();i=[],r=n();for(var a,o,u=-1,s=t.length;++u<s;)r.has(o=(a=t[u])+"")||r.set(o,i.push(a));return e},e.range=function(n){return arguments.length?(t=ts.call(n),e):t.slice()},e.unknown=function(t){return arguments.length?(a=t,e):a},e.copy=function(){return pe().domain(i).range(t).unknown(a)},e}function ge(){function t(){var t=i().length,r=o[1]<o[0],f=o[r-0],h=o[1-r];e=(h-f)/Math.max(1,t-s+2*c),u&&(e=Math.floor(e)),f+=(h-f-e*(t-s))*l,n=e*(1-s),u&&(f=Math.round(f),n=Math.round(n));var d=pa(t).map(function(t){return f+e*t});return a(r?d.reverse():d)}var e,n,r=pe().unknown(void 0),i=r.domain,a=r.range,o=[0,1],u=!1,s=0,c=0,l=.5;return delete r.unknown,r.domain=function(e){return arguments.length?(i(e),t()):i()},r.range=function(e){return arguments.length?(o=[+e[0],+e[1]],t()):o.slice()},r.rangeRound=function(e){return o=[+e[0],+e[1]],u=!0,t()},r.bandwidth=function(){return n},r.step=function(){return e},r.round=function(e){return arguments.length?(u=!!e,t()):u},r.padding=function(e){return arguments.length?(s=c=Math.max(0,Math.min(1,e)),t()):s},r.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),t()):s},r.paddingOuter=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),t()):c},r.align=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),t()):l},r.copy=function(){return ge().domain(i()).range(o).round(u).paddingInner(s).paddingOuter(c).align(l)},t()}function ve(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return ve(e())},t}function me(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:ns(e)}function ye(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function be(t,e){function n(){return i=Math.min(u.length,s.length)>2?function(t,e,n,r){var i=Math.min(t.length,e.length)-1,a=new Array(i),o=new Array(i),u=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++u<i;)a[u]=n(t[u],t[u+1]),o[u]=r(e[u],e[u+1]);return function(e){var n=la(t,e,1,i)-1;return o[n](a[n](e))}}:function(t,e,n,r){var i=t[0],a=t[1],o=e[0],u=e[1];return a<i?(i=n(a,i),o=r(u,o)):(i=n(i,a),o=r(o,u)),function(t){return o(i(t))}},a=o=null,r}function r(e){return(a||(a=i(u,s,l?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=e?0:t>=n?1:r(t)}}}(t):t,c)))(+e)}var i,a,o,u=is,s=is,c=Pu,l=!1;return r.invert=function(t){return(o||(o=i(s,u,me,l?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=0?e:t>=1?n:r(t)}}}(e):e)))(+t)},r.domain=function(t){return arguments.length?(u=Qu.call(t,rs),n()):u.slice()},r.range=function(t){return arguments.length?(s=ts.call(t),n()):s.slice()},r.rangeRound=function(t){return s=ts.call(t),c=zu,n()},r.clamp=function(t){return arguments.length?(l=!!t,n()):l},r.interpolate=function(t){return arguments.length?(c=t,n()):c},n()}function _e(t){return new xe(t)}function xe(t){if(!(e=cs.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",r=e[2]||">",i=e[3]||"-",a=e[4]||"",o=!!e[5],u=e[6]&&+e[6],s=!!e[7],c=e[8]&&+e[8].slice(1),l=e[9]||"";"n"===l?(s=!0,l="g"):ss[l]||(l=""),(o||"0"===n&&"="===r)&&(o=!0,n="0",r="="),this.fill=n,this.align=r,this.sign=i,this.symbol=a,this.zero=o,this.width=u,this.comma=s,this.precision=c,this.type=l}function we(t){var e=t.domain;return t.ticks=function(t){var n=e();return ya(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){return vs(e(),t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),a=0,o=i.length-1,u=i[a],s=i[o];return s<u&&(r=u,u=s,s=r,r=a,a=o,o=r),(r=st(u,s,n))>0?r=st(u=Math.floor(u/r)*r,s=Math.ceil(s/r)*r,n):r<0&&(r=st(u=Math.ceil(u*r)/r,s=Math.floor(s*r)/r,n)),r>0?(i[a]=Math.floor(u/r)*r,i[o]=Math.ceil(s/r)*r,e(i)):r<0&&(i[a]=Math.ceil(u*r)/r,i[o]=Math.floor(s*r)/r,e(i)),t},t}function Me(){var t=be(me,Tu);return t.copy=function(){return ye(t,Me())},we(t)}function ke(){function t(t){return+t}var e=[0,1];return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=Qu.call(n,rs),t):e.slice()},t.copy=function(){return ke().domain(e)},we(t)}function Ae(t){return 10===t?function(t){return isFinite(t)?+("1e"+t):t<0?0:t}:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function Ee(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function Te(t){return function(e){return-t(-e)}}function Se(){function t(){return i=Ee(r),a=Ae(r),n()[0]<0&&(i=Te(i),a=Te(a)),e}var e=be(function(t,e){return(e=Math.log(e/t))?function(n){return Math.log(n/t)/e}:ns(e)},function(t,e){return t<0?function(n){return-Math.pow(-e,n)*Math.pow(-t,1-n)}:function(n){return Math.pow(e,n)*Math.pow(t,1-n)}}).domain([1,10]),n=e.domain,r=10,i=Ee(10),a=Ae(10);return e.base=function(e){return arguments.length?(r=+e,t()):r},e.domain=function(e){return arguments.length?(n(e),t()):n()},e.ticks=function(t){var e,o=n(),u=o[0],s=o[o.length-1];(e=s<u)&&(h=u,u=s,s=h);var c,l,f,h=i(u),d=i(s),p=null==t?10:+t,g=[];if(!(r%1)&&d-h<p){if(h=Math.round(h)-1,d=Math.round(d)+1,u>0){for(;h<d;++h)for(l=1,c=a(h);l<r;++l)if(!((f=c*l)<u)){if(f>s)break;g.push(f)}}else for(;h<d;++h)for(l=r-1,c=a(h);l>=1;--l)if(!((f=c*l)<u)){if(f>s)break;g.push(f)}}else g=ya(h,d,Math.min(d-h,p)).map(a);return e?g.reverse():g},e.tickFormat=function(t,n){if(null==n&&(n=10===r?".0e":","),"function"!=typeof n&&(n=fs(n)),t===1/0)return n;null==t&&(t=10);var o=Math.max(1,r*t/e.ticks().length);return function(t){var e=t/a(Math.round(i(t)));return e*r<r-.5&&(e*=r),e<=o?n(t):""}},e.nice=function(){return n(ms(n(),{floor:function(t){return a(Math.floor(i(t)))},ceil:function(t){return a(Math.ceil(i(t)))}}))},e.copy=function(){return ye(e,Se().base(r))},e}function Ce(t,e){return t<0?-Math.pow(-t,e):Math.pow(t,e)}function Ne(){var t=1,e=be(function(e,n){return(n=Ce(n,t)-(e=Ce(e,t)))?function(r){return(Ce(r,t)-e)/n}:ns(n)},function(e,n){return n=Ce(n,t)-(e=Ce(e,t)),function(r){return Ce(e+n*r,1/t)}}),n=e.domain;return e.exponent=function(e){return arguments.length?(t=+e,n(n())):t},e.copy=function(){return ye(e,Ne().exponent(t))},we(e)}function Pe(){function t(){var t=0,a=Math.max(1,r.length);for(i=new Array(a-1);++t<a;)i[t-1]=ba(n,t/a);return e}function e(t){if(!isNaN(t=+t))return r[la(i,t)]}var n=[],r=[],i=[];return e.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:n[0],e<i.length?i[e]:n[n.length-1]]},e.domain=function(e){if(!arguments.length)return n.slice();n=[];for(var r,i=0,a=e.length;i<a;++i)null==(r=e[i])||isNaN(r=+r)||n.push(r);return n.sort(sa),t()},e.range=function(e){return arguments.length?(r=ts.call(e),t()):r.slice()},e.quantiles=function(){return i.slice()},e.copy=function(){return Pe().domain(n).range(r)},e}function ze(){function t(t){if(t<=t)return o[la(a,t,0,i)]}function e(){var e=-1;for(a=new Array(i);++e<i;)a[e]=((e+1)*r-(e-i)*n)/(i+1);return t}var n=0,r=1,i=1,a=[.5],o=[0,1];return t.domain=function(t){return arguments.length?(n=+t[0],r=+t[1],e()):[n,r]},t.range=function(t){return arguments.length?(i=(o=ts.call(t)).length-1,e()):o.slice()},t.invertExtent=function(t){var e=o.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,a[0]]:e>=i?[a[i-1],r]:[a[e-1],a[e]]},t.copy=function(){return ze().domain([n,r]).range(o)},we(t)}function Oe(){function t(t){if(t<=t)return n[la(e,t,0,r)]}var e=[.5],n=[0,1],r=1;return t.domain=function(i){return arguments.length?(e=ts.call(i),r=Math.min(e.length,n.length-1),t):e.slice()},t.range=function(i){return arguments.length?(n=ts.call(i),r=Math.min(e.length,n.length-1),t):n.slice()},t.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},t.copy=function(){return Oe().domain(e).range(n)},t}function De(t,e,n,r,i,a,o,u,s){function c(e,n,r,i){if(null==e&&(e=10),"number"==typeof e){var a=Math.abs(r-n)/e,o=ca(function(t){return t[2]}).right(x,a);o===x.length?(i=ct(n/ks,r/ks,e),e=t):o?(i=(o=x[a/x[o-1][2]<x[o][2]/a?o-1:o])[1],e=o[0]):(i=ct(n,r,e),e=u)}return null==i?e:e.every(i)}var l=be(me,Tu),f=l.invert,h=l.domain,d=s(".%L"),p=s(":%S"),g=s("%I:%M"),v=s("%I %p"),m=s("%a %d"),y=s("%b %d"),b=s("%B"),_=s("%Y"),x=[[o,1,ys],[o,5,5*ys],[o,15,15*ys],[o,30,30*ys],[a,1,bs],[a,5,5*bs],[a,15,15*bs],[a,30,30*bs],[i,1,_s],[i,3,3*_s],[i,6,6*_s],[i,12,12*_s],[r,1,xs],[r,2,2*xs],[n,1,ws],[e,1,Ms],[e,3,3*Ms],[t,1,ks]];return l.invert=function(t){return new Date(f(t))},l.domain=function(t){return arguments.length?h(Qu.call(t,function(t){return t instanceof Date?+t:+new Date(+t)})):h().map(function(t){return new Date(t)})},l.ticks=function(t,e){var n,r=h(),i=r[0],a=r[r.length-1],o=a<i;return o&&(n=i,i=a,a=n),n=c(t,i,a,e),n=n?n.range(i,a+1):[],o?n.reverse():n},l.tickFormat=function(u,c){return null==c?function(u){return(o(u)<u?d:a(u)<u?p:i(u)<u?g:r(u)<u?v:e(u)<u?n(u)<u?m:y:t(u)<u?b:_)(u)}:s(c)},l.nice=function(t,e){var n=h();return(t=c(t,n[0],n[n.length-1],e))?h(ms(n,t)):l},l.copy=function(){return ye(l,De(t,e,n,r,i,a,o,u,s))},l}function je(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function $e(t){function e(e){var a=(e-n)/(r-n);return t(i?Math.max(0,Math.min(1,a)):a)}var n=0,r=1,i=!1;return e.domain=function(t){return arguments.length?(n=+t[0],r=+t[1],e):[n,r]},e.clamp=function(t){return arguments.length?(i=!!t,e):i},e.interpolator=function(n){return arguments.length?(t=n,e):t},e.copy=function(){return $e(t).domain([n,r]).clamp(i)},we(e)}function Le(){var t=this.__visual__;t?(t.destroy(),ur('Removed "'+t.toString()+'" from DOM, '+Gu.live.length+" live visuals left")):qa("d3-visual without __visual__ object")}function Fe(t,e){function n(e,n){var r=this.initialise(e,n);Object.defineProperties(this,{element:{get:function(){return r}},sel:{get:function(){return Wr(r)}},paperType:{get:function(){return t}}})}return n.prototype=er({},Ws,e),Gu.papers[t]=n,n}function Ue(t,e){var n=e.options[t];void 0===n||a(n)||(e.options[t]=Re(n||0))}function He(t,e,n){return Gs.reduce(function(r,i){return r[i]=le(t[i],Ks.indexOf(i)>-1?e:n),r},{})}function Ye(t){delete t.__boundingBox,s(t.layers)&&t.layers.forEach(Ye)}function Re(t){return{left:t,right:t,top:t,bottom:t}}function qe(t,e){function n(n){var h=null==i?e.ticks?e.ticks.apply(e,r):e.domain():i,d=null==a?e.tickFormat?e.tickFormat.apply(e,r):Js:a,p=Math.max(o,0)+s,g=e.range(),v=+g[0]+.5,m=+g[g.length-1]+.5,y=(e.bandwidth?function(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}:function(t){return function(e){return+t(e)}})(e.copy()),b=n.selection?n.selection():n,_=b.selectAll(".domain").data([null]),x=b.selectAll(".tick").data(h,e).order(),w=x.exit(),M=x.enter().append("g").attr("class","tick"),k=x.select("line"),A=x.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),x=x.merge(M),k=k.merge(M.append("line").attr("stroke","#000").attr(l+"2",c*o)),A=A.merge(M.append("text").attr("fill","#000").attr(l,c*p).attr("dy",t===Qs?"0em":t===ec?"0.71em":"0.32em")),n!==b&&(_=_.transition(n),x=x.transition(n),k=k.transition(n),A=A.transition(n),w=w.transition(n).attr("opacity",rc).attr("transform",function(t){return isFinite(t=y(t))?f(t):this.getAttribute("transform")}),M.attr("opacity",rc).attr("transform",function(t){var e=this.parentNode.__axis;return f(e&&isFinite(e=e(t))?e:y(t))})),w.remove(),_.attr("d",t===nc||t==tc?"M"+c*u+","+v+"H0.5V"+m+"H"+c*u:"M"+v+","+c*u+"V0.5H"+m+"V"+c*u),x.attr("opacity",1).attr("transform",function(t){return f(y(t))}),k.attr(l+"2",c*o),A.attr(l,c*p).text(d),b.filter(function(){return!this.__axis}).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===tc?"start":t===nc?"end":"middle"),b.each(function(){this.__axis=y})}var r=[],i=null,a=null,o=6,u=6,s=3,c=t===Qs||t===nc?-1:1,l=t===nc||t===tc?"x":"y",f=t===Qs||t===ec?function(t){return"translate("+(t+.5)+",0)"}:function(t){return"translate(0,"+(t+.5)+")"};return n.scale=function(t){return arguments.length?(e=t,n):e},n.ticks=function(){return r=Zs.call(arguments),n},n.tickArguments=function(t){return arguments.length?(r=null==t?[]:Zs.call(t),n):r.slice()},n.tickValues=function(t){return arguments.length?(i=null==t?null:Zs.call(t),n):i&&i.slice()},n.tickFormat=function(t){return arguments.length?(a=t,n):a},n.tickSize=function(t){return arguments.length?(o=u=+t,n):o},n.tickSizeInner=function(t){return arguments.length?(o=+t,n):o},n.tickSizeOuter=function(t){return arguments.length?(u=+t,n):u},n.tickPadding=function(t){return arguments.length?(s=+t,n):s},n}function Xe(t,e,n,r){var i=ic.get(t)(e).tickSize(n.tickSize);return null!==n.tickSizeOuter&&i.tickSizeOuter(n.tickSizeOuter),!function(t){return"[object Date]"===nr.call(t)}(r)?null!==n.format&&i.tickFormat(fs(n.format)):i.tickFormat(vo(n.timeFormat)),i.ticks(n.ticks)}function We(t,e,n){t.select("path.domain").attr("stroke",e.stroke);var r=t.selectAll("text").attr("fill",e.stroke);if(e.hide){var i=n.range();Math.abs(i[0]-i[i.length-1])<e.hide?t.style("opacity",0):t.style("opacity",1)}e.rotate&&r.attr("transform","rotate("+e.rotate+")").style("text-anchor",e.ancor)}function Ie(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Be(){return new Ie}function Ve(t){return t>=1?bc:t<=-1?-bc:Math.asin(t)}function Ge(t,e,n,r,i,a,o){var u=t-n,s=e-r,c=(o?a:-a)/vc(u*u+s*s),l=c*s,f=-c*u,h=t+l,d=e+f,p=n+l,g=r+f,v=(h+p)/2,m=(d+g)/2,y=p-h,b=g-d,_=y*y+b*b,x=i-a,w=h*g-p*d,M=(b<0?-1:1)*vc(dc(0,x*x*_-w*w)),k=(w*b-y*M)/_,A=(-w*y-b*M)/_,E=(w*b+y*M)/_,T=(-w*y+b*M)/_,S=k-v,C=A-m,N=E-v,P=T-m;return S*S+C*C>N*N+P*P&&(k=E,A=T),{cx:k,cy:A,x01:-l,y01:-f,x11:k*(i/x-1),y11:A*(i/x-1)}}function Ke(t){this._context=t}function Ze(t){return t[0]}function Je(t){return t[1]}function Qe(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function tn(t){this._context=t}function en(t){this._context=t}function nn(t){this._context=t}function rn(t,e){this._basis=new tn(t),this._beta=e}function an(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function on(t,e){this._context=t,this._k=(1-e)/6}function un(t,e){this._context=t,this._k=(1-e)/6}function sn(t,e){this._context=t,this._k=(1-e)/6}function cn(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>mc){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,s=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/s,i=(i*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/s}if(t._l23_a>mc){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*c+t._x1*t._l23_2a-e*t._l12_2a)/l,o=(o*c+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function ln(t,e){this._context=t,this._alpha=e}function fn(t,e){this._context=t,this._alpha=e}function hn(t,e){this._context=t,this._alpha=e}function dn(t){this._context=t}function pn(t){return t<0?-1:1}function gn(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),u=(a*i+o*r)/(r+i);return(pn(a)+pn(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(u))||0}function vn(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function mn(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,u=(a-r)/3;t._context.bezierCurveTo(r+u,i+u*e,a-u,o-u*n,a,o)}function yn(t){this._context=t}function bn(t){this._context=new _n(t)}function _n(t){this._context=t}function xn(t){this._context=t}function wn(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function Mn(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}function kn(t,e,n){return function(r){try{t.call(this,this.__data__,e,n)}finally{}}}function An(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function En(t){return t.trim().split(/^|\s+/)}function Tn(t){return t.classList||new Sn(t)}function Sn(t){this._node=t,this._names=En(t.getAttribute("class")||"")}function Cn(t,e){for(var n=Tn(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Nn(t,e){for(var n=Tn(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Pn(t,e,n){var r=ol(t),i=r.CustomEvent;i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function zn(t,e){this._groups=t,this._parents=e}function On(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new Dn(r)}function Dn(t){this._=t}function jn(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=sl,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}function $n(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=hl?i*=10:a>=dl?i*=5:a>=pl&&(i*=2),e<t?-i:i}function Ln(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:bl(e)}function Fn(t){return new Un(t)}function Un(t){if(!(e=El.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",r=e[2]||">",i=e[3]||"-",a=e[4]||"",o=!!e[5],u=e[6]&&+e[6],s=!!e[7],c=e[8]&&+e[8].slice(1),l=e[9]||"";"n"===l?(s=!0,l="g"):Al[l]||(l=""),(o||"0"===n&&"="===r)&&(o=!0,n="0",r="="),this.fill=n,this.align=r,this.sign=i,this.symbol=a,this.zero=o,this.width=u,this.comma=s,this.precision=c,this.type=l}function Hn(){var t=function(t,e){function n(){return i=Math.min(u.length,s.length)>2?function(t,e,n,r){var i=Math.min(t.length,e.length)-1,a=new Array(i),o=new Array(i),u=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++u<i;)a[u]=n(t[u],t[u+1]),o[u]=r(e[u],e[u+1]);return function(e){var n=fl(t,e,1,i)-1;return o[n](a[n](e))}}:function(t,e,n,r){var i=t[0],a=t[1],o=e[0],u=e[1];return a<i?(i=n(a,i),o=r(u,o)):(i=n(i,a),o=r(o,u)),function(t){return o(i(t))}},a=o=null,r}function r(e){return(a||(a=i(u,s,l?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=e?0:t>=n?1:r(t)}}}(t):t,c)))(+e)}var i,a,o,u=xl,s=xl,c=Pu,l=!1;return r.invert=function(t){return(o||(o=i(s,u,Ln,l?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=0?e:t>=1?n:r(t)}}}(e):e)))(+t)},r.domain=function(t){return arguments.length?(u=ml.call(t,_l),n()):u.slice()},r.range=function(t){return arguments.length?(s=yl.call(t),n()):s.slice()},r.rangeRound=function(t){return s=yl.call(t),c=zu,n()},r.clamp=function(t){return arguments.length?(l=!!t,n()):l},r.interpolate=function(t){return arguments.length?(c=t,n()):c},n()}(Ln,Tu);return t.copy=function(){return function(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}(t,Hn())},function(t){var e=t.domain;return t.ticks=function(t){var n=e();return gl(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){return Ol(e(),t,n)},t.nice=function(n){var r=e(),i=r.length-1,a=null==n?10:n,o=r[0],u=r[i],s=$n(o,u,a);return s&&(s=$n(Math.floor(o/s)*s,Math.ceil(u/s)*s,a),r[0]=Math.floor(o/s)*s,r[i]=Math.ceil(u/s)*s,e(r)),t},t}(t)}function Yn(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function Rn(t){if(!(e=Hl.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",r=e[2]||">",i=e[3]||"-",a=e[4]||"",o=!!e[5],u=e[6]&&+e[6],s=!!e[7],c=e[8]&&+e[8].slice(1),l=e[9]||"";"n"===l?(s=!0,l="g"):Ul[l]||(l=""),(o||"0"===n&&"="===r)&&(o=!0,n="0",r="="),this.fill=n,this.align=r,this.sign=i,this.symbol=a,this.zero=o,this.width=u,this.comma=s,this.precision=c,this.type=l}function qn(){$r.stopImmediatePropagation()}function Xn(t){return{type:t}}function Wn(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function In(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Bn(t){function e(e){var i=e.property("__brush",function(){var e=this.__brush||{selection:null};return e.extent=o.apply(this,arguments),e.dim=t,e}).selectAll(".overlay").data([Xn("overlay")]);i.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",yf.overlay).merge(i).each(function(){var t=Wn(this).extent;Wr(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])}),e.selectAll(".selection").data([Xn("selection")]).enter().append("rect").attr("class","selection").attr("cursor",yf.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var s=e.selectAll(".handle").data(t.handles,function(t){return t.type});s.exit().remove(),s.enter().append("rect").attr("class",function(t){return"handle handle--"+t.type}).attr("cursor",function(t){return yf[t.type]}),e.each(n).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",function(){function e(){var t=Fr(x);!O||b||_||(Math.abs(t[0]-j[0])>Math.abs(t[1]-j[1])?_=!0:b=!0),j=t,y=!0,lf(),i()}function i(){var t;switch(v=j[0]-D[0],m=j[1]-D[1],M){case hf:case ff:k&&(v=Math.max(C-s,Math.min(P-h,v)),c=s+v,d=h+v),A&&(m=Math.max(N-l,Math.min(z-p,m)),f=l+m,g=p+m);break;case df:k<0?(v=Math.max(C-s,Math.min(P-s,v)),c=s+v,d=h):k>0&&(v=Math.max(C-h,Math.min(P-h,v)),c=s,d=h+v),A<0?(m=Math.max(N-l,Math.min(z-l,m)),f=l+m,g=p):A>0&&(m=Math.max(N-p,Math.min(z-p,m)),f=l,g=p+m);break;case pf:k&&(c=Math.max(C,Math.min(P,s-v*k)),d=Math.max(C,Math.min(P,h+v*k))),A&&(f=Math.max(N,Math.min(z,l-m*A)),g=Math.max(N,Math.min(z,p+m*A)))}d<c&&(k*=-1,t=s,s=h,h=t,t=c,c=d,d=t,w in bf&&F.attr("cursor",yf[w=bf[w]])),g<f&&(A*=-1,t=l,l=p,p=t,t=f,f=g,g=t,w in _f&&F.attr("cursor",yf[w=_f[w]])),E.selection&&(S=E.selection),b&&(c=S[0][0],d=S[1][0]),_&&(f=S[0][1],g=S[1][1]),S[0][0]===c&&S[0][1]===f&&S[1][0]===d&&S[1][1]===g||(E.selection=[[c,f],[d,g]],n.call(x),$.brush())}function o(){if(qn(),$r.touches){if($r.touches.length)return;a&&clearTimeout(a),a=setTimeout(function(){a=null},500),L.on("touchmove.brush touchend.brush touchcancel.brush",null)}else!function(t,e){var n=t.document.documentElement,r=Wr(t).on("dragstart.drag",null);e&&(r.on("click.drag",of,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}($r.view,y),U.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);L.attr("pointer-events","all"),F.attr("cursor",yf.overlay),E.selection&&(S=E.selection),In(S)&&(E.selection=null,n.call(x)),$.end()}if($r.touches){if($r.changedTouches.length<$r.touches.length)return lf()}else if(a)return;if(!u.apply(this,arguments))return;var s,c,l,f,h,d,p,g,v,m,y,b,_,x=this,w=$r.target.__data__.type,M="selection"===($r.metaKey?w="overlay":w)?ff:$r.altKey?pf:df,k=t===vf?null:xf[w],A=t===gf?null:wf[w],E=Wn(x),T=E.extent,S=E.selection,C=T[0][0],N=T[0][1],P=T[1][0],z=T[1][1],O=k&&A&&$r.shiftKey,D=Fr(x),j=D,$=r(x,arguments).beforestart();"overlay"===w?E.selection=S=[[s=t===vf?C:D[0],l=t===gf?N:D[1]],[h=t===vf?P:s,p=t===gf?z:l]]:(s=S[0][0],l=S[0][1],h=S[1][0],p=S[1][1]);c=s,f=l,d=h,g=p;var L=Wr(x).attr("pointer-events","none"),F=L.selectAll(".overlay").attr("cursor",yf[w]);if($r.touches)L.on("touchmove.brush",e,!0).on("touchend.brush touchcancel.brush",o,!0);else{var U=Wr($r.view).on("keydown.brush",function(){switch($r.keyCode){case 16:O=k&&A;break;case 18:M===df&&(k&&(h=d-v*k,s=c+v*k),A&&(p=g-m*A,l=f+m*A),M=pf,i());break;case 32:M!==df&&M!==pf||(k<0?h=d-v:k>0&&(s=c-v),A<0?p=g-m:A>0&&(l=f-m),M=hf,F.attr("cursor",yf.selection),i());break;default:return}lf()},!0).on("keyup.brush",function(){switch($r.keyCode){case 16:O&&(b=_=O=!1,i());break;case 18:M===pf&&(k<0?h=d:k>0&&(s=c),A<0?p=g:A>0&&(l=f),M=df,i());break;case 32:M===hf&&($r.altKey?(k&&(h=d-v*k,s=c+v*k),A&&(p=g-m*A,l=f+m*A),M=pf):(k<0?h=d:k>0&&(s=c),A<0?p=g:A>0&&(l=f),M=df),F.attr("cursor",yf[w]),i());break;default:return}lf()},!0).on("mousemove.brush",e,!0).on("mouseup.brush",o,!0);uf($r.view)}qn(),Xo(x),n.call(x),$.start()})}function n(){var t=Wr(this),e=Wn(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",function(t){return"e"===t.type[t.type.length-1]?e[1][0]-c/2:e[0][0]-c/2}).attr("y",function(t){return"s"===t.type[0]?e[1][1]-c/2:e[0][1]-c/2}).attr("width",function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+c:c}).attr("height",function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+c:c})):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function r(t,e){return t.__brush.emitter||new i(t,e)}function i(t,e){this.that=t,this.args=e,this.state=t.__brush,this.active=0}var a,o=function(){var t=this.ownerSVGElement||this;return[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]},u=function(){return!$r.button},s=T(e,"start","brush","end"),c=6;return e.move=function(e,i){e.selection?e.on("start.brush",function(){r(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){r(this,arguments).end()}).tween("brush",function(){function e(t){o.selection=1===t&&In(c)?null:l(t),n.call(a),u.brush()}var a=this,o=a.__brush,u=r(a,arguments),s=o.selection,c=t.input("function"==typeof i?i.apply(this,arguments):i,o.extent),l=Pu(s,c);return s&&c?e:e(1)}):e.each(function(){var e=arguments,a=this.__brush,o=t.input("function"==typeof i?i.apply(this,e):i,a.extent),u=r(this,e).beforestart();Xo(this),a.selection=null==o||In(o)?null:o,n.call(this),u.start().brush().end()})},i.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(n){!function(t,e,n,r){var i=$r;t.sourceEvent=$r,$r=t;try{e.apply(n,r)}finally{$r=i}}(new cf(e,n,t.output(this.state.selection)),s.apply,s,[n,this.that,this.args])}},e.extent=function(t){return arguments.length?(o="function"==typeof t?t:sf([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),e):o},e.filter=function(t){return arguments.length?(u="function"==typeof t?t:sf(!!t),e):u},e.handleSize=function(t){return arguments.length?(c=+t,e):c},e.on=function(){var t=s.on.apply(s,arguments);return t===s?e:t},e}function Vn(t,e,n,r){this.data=t,this.stacked=r,this.x=e,this.y=n}function Gn(t){this.vertical=!0,this.init(t),this.sx.rangeRound([0,this.box.innerWidth]),this.sy.rangeRound([this.box.innerHeight,0])}function Kn(t){this.init(t),this.sx.rangeRound([0,this.box.innerHeight]),this.sy.rangeRound([0,this.box.innerWidth])}e.prototype=n.prototype={constructor:e,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var Zn=n.prototype;r.prototype=i.prototype={constructor:r,has:Zn.has,add:function(t){return t+="",this["$"+t]=t,this},remove:Zn.remove,clear:Zn.clear,values:Zn.keys,size:Zn.size,empty:Zn.empty,each:Zn.each};var Jn=Object.getOwnPropertySymbols,Qn=Object.prototype.hasOwnProperty,tr=Object.prototype.propertyIsEnumerable,er=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,r,i=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),a=1;a<arguments.length;a++){n=Object(arguments[a]);for(var o in n)Qn.call(n,o)&&(i[o]=n[o]);if(Jn){r=Jn(n);for(var u=0;u<r.length;u++)tr.call(n,r[u])&&(i[r[u]]=n[r[u]])}}return i},nr=Object.prototype.toString,rr="undefined"!=typeof window&&"[object Object]"!==nr.call(window),ir=rr?window.console:require("console"),ar=function(t,e){var n=void 0;if(a(t))return n=t[e],delete t[e],n;if(s(t)){var r=+e;return r==r?t.splice(r,1)[0]:(n=t[e],delete t[e],n)}},or="[d3-view-debug]",ur=function(t){lr.logger.debug&&lr.logger.debug(t)};ir.debug=null;var sr,cr,lr={logger:ir,fetch:function(){if(rr)return window.fetch}(),readyCallbacks:[],setDebug:function(t){!arguments.length||t?this.logger.debug=u(t)?t:function(t){lr.logger.info(or+" "+t)}:this.logger.debug=null}},fr=function(t){lr.logger.warn("[d3-view] "+t)},hr=n({disabled:"disabled",readonly:"readOnly",required:"required"}),dr={create:function(t){return this.arg?t:fr("Cannot bind to empty attribute. Specify :<attr-name>")},refresh:function(t,e){if("class"===this.arg)return this.refreshClass(e);if(s(e))return fr("Cannot apply array to attribute "+this.arg);var n=hr.get(this.arg);n?this.sel.property(n,e||!1):this.sel.attr(this.arg,e||null)},refreshClass:function(t){var e=this.sel;s(t)||(t=[t]),this.oldValue&&this.oldValue.forEach(function(t){t&&e.classed(t,!1)}),this.oldValue=t.map(function(t){var n=!0;return s(t)&&(n=t[1],t=t[0]),t&&e.classed(t,n),t})}},pr={refresh:function(t,e){if(function(t){return"[object Number]"===nr.call(t)}(e)&&(e=""+e),o(e)){var n=this,r=this.sel,i=this.passes?this.transition(r):null;i?i.style("opacity",0).on("end",function(){r.html(e),n.selectChildren().mount(),n.transition(r).style("opacity",1)}):(r.html(e),this.selectChildren().mount())}}},gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vr=(function(){function t(t){this.value=t}function e(e){function n(i,a){try{var o=e[i](a),u=o.value;u instanceof t?Promise.resolve(u.value).then(function(t){n("next",t)},function(t){n("throw",t)}):r(o.done?"return":"normal",o.value)}catch(t){r("throw",t)}}function r(t,e){switch(t){case"return":i.resolve({value:e,done:!0});break;case"throw":i.reject(e);break;default:i.resolve({value:e,done:!1})}(i=i.next)?n(i.key,i.arg):a=null}var i,a;this._invoke=function(t,e){return new Promise(function(r,o){var u={key:t,arg:e,resolve:r,reject:o,next:null};a?a=a.next=u:(i=a=u,n(t,e))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)}}(),0),mr=0,yr=0,br=1e3,_r=0,xr=0,wr=0,Mr="object"===("undefined"==typeof performance?"undefined":gr(performance))&&performance.now?performance:Date,kr="object"===("undefined"==typeof window?"undefined":gr(window))&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};f.prototype=h.prototype={constructor:f,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?l():+n)+(null==e?0:+e),this._next||cr===this||(cr?cr._next=this:sr=this,cr=this),this._call=t,this._time=n,p()},stop:function(){this._call&&(this._call=null,this._time=1/0,p())}};var Ar=function(t,e,n){var r=new f;return e=null==e?0:+e,r.restart(function(n){r.stop(),t(n+e)},e,n),r},Er=function(t,e){function n(){if(null!==r)return r;var n=this,i=arguments;return r=new Promise(function(a,o){Ar(function(){r=null;try{a(t?t.apply(n,i):void 0)}catch(t){o(t)}},e)})}var r=null;return n.promise=function(){return r},n},Tr="http://www.w3.org/1999/xhtml",Sr={svg:"http://www.w3.org/2000/svg",xhtml:Tr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Cr=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Sr.hasOwnProperty(e)?{space:Sr[e],local:t}:t},Nr=function(t){var e=Cr(t);return(e.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Tr&&e.documentElement.namespaceURI===Tr?e.createElement(t):e.createElementNS(n,t)}})(e)},Pr=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var zr=document.documentElement;if(!zr.matches){var Or=zr.webkitMatchesSelector||zr.msMatchesSelector||zr.mozMatchesSelector||zr.oMatchesSelector;Pr=function(t){return function(){return Or.call(this,t)}}}}var Dr=Pr,jr={},$r=null;if("undefined"!=typeof document){"onmouseenter"in document.documentElement||(jr={mouseenter:"mouseover",mouseleave:"mouseout"})}var Lr=function(){for(var t,e=$r;t=e.sourceEvent;)e=t;return e},Fr=function(t){var e=Lr();return e.changedTouches&&(e=e.changedTouches[0]),function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}(t,e)},Ur=function(t){return null==t?function(){}:function(){return this.querySelector(t)}},Hr=function(t){return null==t?function(){return[]}:function(){return this.querySelectorAll(t)}},Yr=function(t){return new Array(t.length)};v.prototype={constructor:v,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Rr="$",qr=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};_.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Xr=[null];k.prototype=A.prototype={constructor:k,select:function(t){"function"!=typeof t&&(t=Ur(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o,u=e[i],s=u.length,c=r[i]=new Array(s),l=0;l<s;++l)(a=u[l])&&(o=t.call(a,a.__data__,l,u))&&("__data__"in a&&(o.__data__=a.__data__),c[l]=o);return new k(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=Hr(t));for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o,u=e[a],s=u.length,c=0;c<s;++c)(o=u[c])&&(r.push(t.call(o,o.__data__,c,u)),i.push(o));return new k(r,i)},filter:function(t){"function"!=typeof t&&(t=Dr(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],u=o.length,s=r[i]=[],c=0;c<u;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&s.push(a);return new k(r,this._parents)},data:function(t,e){if(!t)return d=new Array(this.size()),c=-1,this.each(function(t){d[++c]=t}),d;var n=e?function(t,e,n,r,i,a,o){var u,s,c,l={},f=e.length,h=a.length,d=new Array(f);for(u=0;u<f;++u)(s=e[u])&&(d[u]=c=Rr+o.call(s,s.__data__,u,e),c in l?i[u]=s:l[c]=s);for(u=0;u<h;++u)(s=l[c=Rr+o.call(t,a[u],u,a)])?(r[u]=s,s.__data__=a[u],l[c]=null):n[u]=new v(t,a[u]);for(u=0;u<f;++u)(s=e[u])&&l[d[u]]===s&&(i[u]=s)}:function(t,e,n,r,i,a){for(var o,u=0,s=e.length,c=a.length;u<c;++u)(o=e[u])?(o.__data__=a[u],r[u]=o):n[u]=new v(t,a[u]);for(;u<s;++u)(o=e[u])&&(i[u]=o)},r=this._parents,i=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var a=i.length,o=new Array(a),u=new Array(a),s=new Array(a),c=0;c<a;++c){var l=r[c],f=i[c],h=f.length,d=t.call(l,l&&l.__data__,c,r),p=d.length,g=u[c]=new Array(p),m=o[c]=new Array(p);n(l,f,g,m,s[c]=new Array(h),d,e);for(var y,b,_=0,x=0;_<p;++_)if(y=g[_]){for(_>=x&&(x=_+1);!(b=m[x])&&++x<p;);y._next=b||null}}return o=new k(o,r),o._enter=u,o._exit=s,o},enter:function(){return new k(this._enter||this._groups.map(Yr),this._parents)},exit:function(){return new k(this._exit||this._groups.map(Yr),this._parents)},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),u=0;u<a;++u)for(var s,c=e[u],l=n[u],f=c.length,h=o[u]=new Array(f),d=0;d<f;++d)(s=c[d]||l[d])&&(h[d]=s);for(;u<r;++u)o[u]=e[u];return new k(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){t||(t=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN});for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i){for(var a,o=e[i],u=o.length,s=r[i]=new Array(u),c=0;c<u;++c)(a=o[c])&&(s[c]=a);s.sort(function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n})}return new k(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,u=a.length;o<u;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=Cr(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}:function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):m(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=y(t+"");if(arguments.length<2){for(var r=b(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?x:w)(this,t)}}:e?function(t){return function(){x(this,t)}}:function(t){return function(){w(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?function(){this.textContent=""}:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?function(){this.innerHTML=""}:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(function(){this.nextSibling&&this.parentNode.appendChild(this)})},lower:function(){return this.each(function(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)})},append:function(t){var e="function"==typeof t?t:Nr(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:Nr(t),r=null==e?function(){return null}:"function"==typeof e?e:Ur(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}),o=a.length;{if(!(arguments.length<2)){for(u=e?function(t,e,n){var r=jr.hasOwnProperty(t.type)?function(t,e,n){return t=g(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}:g;return function(i,a,o){var u,s=this.__on,c=r(e,a,o);if(s)for(var l=0,f=s.length;l<f;++l)if((u=s[l]).type===t.type&&u.name===t.name)return this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=c,u.capture=n),void(u.value=e);this.addEventListener(t.type,c,n),u={type:t.type,name:t.name,value:e,listener:c,capture:n},s?s.push(u):this.__on=[u]}}:function(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}},null==n&&(n=!1),r=0;r<o;++r)this.each(u(a[r],e,n));return this}var u=this.node().__on;if(u)for(var s,c=0,l=u.length;c<l;++c)for(r=0,s=u[c];r<o;++r)if((i=a[r]).type===s.type&&i.name===s.name)return s.value}},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return M(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return M(this,t,e)}})(t,e))}};var Wr=function(t){return"string"==typeof t?new k([[document.querySelector(t)]],[document.documentElement]):new k([[t]],Xr)},Ir=function(t){return"string"==typeof t?new k([document.querySelectorAll(t)],[document.documentElement]):new k([null==t?[]:t],Xr)},Br=function(t){return Object.defineProperty(t,"sel",{get:function(){return Wr(this.el)}}),t},Vr={on:function(t,e){var n=function(t,e,n){return Er(function(){e.$set(n,t.value())})}(this,t,e);this.sel.on("input",n).on("change",n)},off:function(){this.sel.on("input",null).on("change",null)},value:function(t){if(!arguments.length)return this.sel.property("value");this.sel.property("value",t)}},Gr=E(),Kr=E({value:function(t){if(!arguments.length)return this.sel.property("checked");this.sel.property("checked",t)}}),Zr={input:Gr,textarea:Gr,select:E({value:function(t){var e,n=this.sel,r=n.selectAll("option"),i=t;if(!arguments.length)return i=[],r.each(function(){(e=Wr(this)).property("selected")&&i.push(e.attr("value")||"")}),n.property("multiple")?i:i[0]||"";s(i)||(i=[t||""]),r.each(function(){e=Wr(this),t=e.attr("value")||"",e.property("selected",i.indexOf(t)>-1)})}}),checkbox:Kr},Jr={create:function(t){var e=this.sel.attr("type"),n=this.el.tagName.toLowerCase(),r=Zr[e]||Zr[n];return r?(this.tag=new r(this.el),t):fr("Cannot apply d3-value directive to "+n)},mount:function(t){var e=this.expression;if(e.parsed.type!==e.codes.IDENTIFIER)return fr('d3-value expression support identifiers only, got "'+e.parsed.type+'": '+this.expression);var n=this.expression.expr;return t.$set(n,this.tag.value()),this.tag.on(t,n),t},refresh:function(t,e){this.tag.value(e)},destroy:function(){this.tag.off()}},Qr={value:function(){}};S.prototype=T.prototype={constructor:S,on:function(t,e){var n,r=this._,i=function(t,e){return t.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}(t+"",r),a=-1,o=i.length;{if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<o;)if(n=(t=i[a]).type)r[n]=C(r[n],t.name,e);else if(null==e)for(n in r)r[n]=C(r[n],t.name,null);return this}for(;++a<o;)if((n=(t=i[a]).type)&&(n=function(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}(r[n],t.name)))return n}},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new S(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}},O.prototype=Error.prototype;var ti=function(t){return new Promise(function(e){e(t)})},ei=function(t){return t&&!u(t.size)?Wr(t):t},ni={isd3:!0,providers:lr,viewElement:z,select:function(t){return Wr(t)},selectAll:function(t){return Ir(t)},createElement:function(t){return Wr(document.createElement(t))},fetch:function(t,e){var n=lr.fetch;return 1==arguments.length?n(t):n(t,e)},fetchText:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.fetch.apply(this,[t].concat(n)).then(function(t){return t.text()})},json:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.fetch.apply(this,[t].concat(n)).then(D)},renderFromUrl:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.cache;return t in r?ti(j(r[t],e,n)):this.fetchText(t).then(function(i){return r[t]=i,j(i,e,n)})},on:function(t,e,n){if(t=ei(t),null===n)return t.on(e,null);t.on(e,function(){return n($r)})},selectChildren:function(t){return arguments.length||(t=this.el),this.selectAll(Array.prototype.slice.call(t.children))}};lr.transition={duration:0};var ri=er(ni,{transition:function(t){arguments.length||(t=this.sel);var e=this.transitionDuration(t);if(e>0)return t.transition(this.uid).duration(e)},transitionDuration:function(t){if(arguments.length||(t=this.sel),t&&u(t.transition)&&t.size()){var e=t.attr("data-transition-duration");return+(null===e?lr.transition.duration:e)}return 0}}),ii={COMPOUND:"Compound",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",LOGICAL_EXP:"LogicalExpression",CONDITIONAL_EXP:"ConditionalExpression",ARRAY_EXP:"ArrayExpression"},ai=function(t,e){var n=new Error(t+" at character "+e);throw n.index=e,n.description=t,n},oi={"-":!0,"!":!0,"~":!0,"+":!0},ui={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},si=function(t){var e,n=0;for(var r in t)(e=r.length)>n&&t.hasOwnProperty(r)&&(n=e);return n},ci=si(oi),li=si(ui),fi={true:!0,false:!1,null:null},hi=function(t){return ui[t]||0},di=function(t,e,n){return{type:"||"===t||"&&"===t?ii.LOGICAL_EXP:ii.BINARY_EXP,operator:t,left:e,right:n}},pi=function(t){return t>=48&&t<=57},gi=function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=128&&!ui[String.fromCharCode(t)]},vi=function(t){for(var e,n,r=0,i=t.charAt,a=t.charCodeAt,o=function(e){return i.call(t,e)},u=function(e){return a.call(t,e)},s=t.length,c=function(){for(var t=u(r);32===t||9===t;)t=u(++r)},l=function t(){var e,n,i=h();return c(),63!==u(r)?i:(r++,(e=t())||ai("Expected expression",r),c(),58===u(r)?(r++,(n=t())||ai("Expected expression",r),{type:ii.CONDITIONAL_EXP,test:i,consequent:e,alternate:n}):void ai("Expected :",r))},f=function(){c();for(var e=t.substr(r,li),n=e.length;n>0;){if(ui.hasOwnProperty(e))return r+=n,e;e=e.substr(0,--n)}return!1},h=function(){var t,e,n,i,a,o,u,s;if(o=d(),!(e=f()))return o;for(a={value:e,prec:hi(e)},(u=d())||ai("Expected expression after "+e,r),i=[o,a,u];(e=f())&&0!==(n=hi(e));){for(a={value:e,prec:n};i.length>2&&n<=i[i.length-2].prec;)u=i.pop(),e=i.pop().value,o=i.pop(),t=di(e,o,u),i.push(t);(t=d())||ai("Expected expression after "+e,r),i.push(a,t)}for(t=i[s=i.length-1];s>1;)t=di(i[s-1].value,i[s-2],t),s-=2;return t},d=function e(){var n,i,a;if(c(),n=u(r),pi(n)||46===n)return p();if(39===n||34===n)return g();if(gi(n)||40===n)return y();if(91===n)return _();for(a=(i=t.substr(r,ci)).length;a>0;){if(oi.hasOwnProperty(i))return r+=a,{type:ii.UNARY_EXP,operator:i,argument:e(),prefix:!0};i=i.substr(0,--a)}return!1},p=function(){for(var t,e,n="";pi(u(r));)n+=o(r++);if(46===u(r))for(n+=o(r++);pi(u(r));)n+=o(r++);if("e"===(t=o(r))||"E"===t){for(n+=o(r++),"+"!==(t=o(r))&&"-"!==t||(n+=o(r++));pi(u(r));)n+=o(r++);pi(u(r-1))||ai("Expected exponent ("+n+o(r)+")",r)}return e=u(r),gi(e)?ai("Variable names cannot start with a number ("+n+o(r)+")",r):46===e&&ai("Unexpected period",r),{type:ii.LITERAL,value:parseFloat(n),raw:n}},g=function(){for(var t,e="",n=o(r++),i=!1;r<s;){if((t=o(r++))===n){i=!0;break}if("\\"===t)switch(t=o(r++)){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+="\\"+t}else e+=t}return i||ai('Unclosed quote after "'+e+'"',r),{type:ii.LITERAL,value:e,raw:n+e+n}},v=function(){var e,n=u(r),i=r;for(gi(n)?r++:ai("Unexpected "+o(r),r);r<s&&(n=u(r),function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||t>=128&&!ui[String.fromCharCode(t)]}(n));)r++;return e=t.slice(i,r),fi.hasOwnProperty(e)?{type:ii.LITERAL,value:fi[e],raw:e}:"this"===e?{type:ii.THIS_EXP}:{type:ii.IDENTIFIER,name:e}},m=function(t){for(var e,n,i=[],a=!1;r<s;){if(c(),(e=u(r))===t){a=!0,r++;break}44===e?r++:((n=l())&&n.type!==ii.COMPOUND||ai("Expected comma",r),i.push(n))}return a||ai("Expected "+String.fromCharCode(t),r),i},y=function(){var t,e;for(e=40===(t=u(r))?b():v(),c(),t=u(r);46===t||91===t||40===t;)r++,46===t?(c(),e={type:ii.MEMBER_EXP,computed:!1,object:e,property:v()}):91===t?(e={type:ii.MEMBER_EXP,computed:!0,object:e,property:l()},c(),93!==(t=u(r))&&ai("Unclosed [",r),r++):40===t&&(e={type:ii.CALL_EXP,arguments:m(41),callee:e}),c(),t=u(r);return e},b=function(){r++;var t=l();if(c(),41===u(r))return r++,t;ai("Unclosed (",r)},_=function(){return r++,{type:ii.ARRAY_EXP,elements:m(93)}},x=[];r<s;)59===(e=u(r))||44===e?r++:(n=l())?x.push(n):r<s&&ai('Unexpected "'+o(r)+'"',r);return 1===x.length?x[0]:{type:ii.COMPOUND,body:x}};vi.addUnaryOp=function(t){return ci=Math.max(t.length,ci),oi[t]=!0,this},vi.addBinaryOp=function(t,e){return li=Math.max(t.length,li),ui[t]=e,this},vi.addLiteral=function(t,e){return fi[t]=e,this},vi.removeUnaryOp=function(t){return delete oi[t],t.length===ci&&(ci=si(oi)),this},vi.removeBinaryOp=function(t){return delete ui[t],t.length===li&&(li=si(ui)),this},vi.removeLiteral=function(t){return delete fi[t],this};var mi={},yi={};U.prototype={eval:function(t){return $(t,this.parsed)},safeEval:function(t){try{return $(t,this.parsed)}catch(t){fr("Could not evaluate <<"+this.expr+">> expression: "+t)}},identifiers:function(){return L(this.parsed).values()}};var bi=function(t){return new U(t)},_i=0,xi=function(t){var e="d3v"+ ++_i;return arguments.length?(Object.defineProperty(t,"uid",{get:function(){return e}}),t):e},wi=function(){var t=T("change"),e=0;return{on:function(e,n){return arguments.length<2?t.on(e):(t.on(e,n),this)},trigger:Er(function(){t.apply("change",this,arguments),e+=1}),triggered:function(){return e}}},Mi=function(t){return t&&t.constructor===Object},ki=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Array.prototype.slice.call(t,e)};W.prototype=X.prototype,X.prototype.toString=function(){return"[object d3Model]"},X.prototype.$on=function(t,e){1===arguments.length&&u(t)&&(e=t,t="");var n=t.split("."),r=n[0],i=R(this,r);return i?(this.$events.get(r)||n.push(this.uid),n[0]="change",i.on(n.join("."),e)):fr('Cannot bind to "'+r+'" - no such reactive property')},X.prototype.$change=function(t){var e=arguments.length?t:"",n=this.$events.get(e),r=ki(arguments,1);return n?n.trigger.apply(this,r):this.isolated?fr("attribute '"+e+"' is not a reactive property this model"):this.parent.$change(e),this},X.prototype.$update=function(t,e){if(t){e=2!==arguments.length||e;for(var n in t)(e||void 0===this[n])&&("$"===n.substring(0,1)?this.constructor.prototype[n]?fr("Cannot set attribute method "+n+", it is protected"):this[n]=t[n]:this.$set(n,t[n]))}return this},X.prototype.$set=function(t,e){this.$events.get(t)?this[t]=e:function(t,e,n){function r(r){if(a&&(r=a.get.call(t)),r!==n){var o=t.$$name||"model";ur("updating "+o+"."+e),t.$change(e,n).$change(),n=i(r,n)}}function i(e,n){return e===n?n:s(e)?function(t,e){Y(e)&&e.$off(),s(e)||(e=[]);for(var n=0;n<t.length;++n)t[n]=i(t[n],e[n]);return t}(e,n):Y(n)?function(t,e){return Mi(t)?(e.$update(t),e):(e.$off(),i(t))}(e,n):Mi(e)?t.$new(e):e}var a;t.$events.set(e,wi()),Object.defineProperty(t,e,function(){var i={get:function(){return n}};return u(n)&&(n={get:n}),Mi(n)&&u(n.get)?(n=(a=n).get.call(t),a.reactOn?a.reactOn.forEach(function(n){t.$on(n+"."+e,r)}):fr("reactive lazy property "+e+" does not specify 'reactOn' list or properties"),u(a.set)&&(i.set=a.set)):i.set=r,i}()),n=i(n),t.$change(e)}(this,t,e)},X.prototype.$new=function(t){return new X(t,this)},X.prototype.$off=function(t){if(void 0===t)this.$events.each(function(t){return q(t)});else{var e=t.split("."),n=e.splice(0,1)[0],r=this.$events.get(n);r&&q(r,e.join("."))}},X.prototype.$isReactive=function(t){return!!this.$events.has(t)||!(!this.parent||this.isolated)&&this.parent.$isReactive(t)},Object.defineProperty(X.prototype,"root",{get:function(){return this.parent?this.parent.root:this}});var Ai={create:function(t){return t},preMount:function(){},mount:function(t){return t},refresh:function(){},destroy:function(){},removeAttribute:function(){this.el.removeAttribute(this.name)},execute:function(t){this.active&&(this.removeAttribute(),this.identifiers=[],(t=this.mount(t))&&this.bindModel(t))},bindModel:function(t){var e=this,r=function(){var n=e.expression?e.expression.eval(t):void 0;e.refresh(t,n),e.passes++},i=void 0,o=void 0,u=void 0,s=void 0;if(this.expression){var c=n();this.expression.identifiers().forEach(function(n){for(i=n.split("."),o=t,u=null,s=0;s<i.length-1;++s)if(o=o[i[s]],!a(o)){u=i.slice(0,s+1).join("."),fr("Property "+u+" is not an object. Directive "+e.name+" cannot bind to "+n);break}if(null===u){if(!(o instanceof W))return fr(n+" is not a reactive model. Directive "+e.name+" cannot bind to it");I(c,o,i[i.length-1])}}),c.each(function(t){t.events.has("")?e.identifiers.push({model:t.model,attr:""}):t.events.each(function(n){e.identifiers.push({model:t.model,attr:n})})})}else e.identifiers.push({model:t,attr:""});this.identifiers.forEach(function(t){var n=t.attr+"."+e.uid;t.model.$on(n,r)}),this.bindDestroy(t),r()},bindDestroy:function(t){var e=this,n=this,r=this.destroy;n.destroy=function(){return r.call(n,t)},this.sel.on("remove."+n.uid,function(){e.identifiers.forEach(function(t){t.model.$off(t.attr+"."+n.uid)}),n.destroy()})}},Ei=function(t){function e(t,e,n){this.el=t,this.name=e.name,this.arg=n,this.passes=0;var r=Br(xi(this)).create(e.value);r&&(this.expression=bi(r)),this.active||(this.active=!e.value||this.expression)}function n(t,n,r){return new e(t,n,r)}return e.prototype=er({},ri,Ai,t),n.prototype=e.prototype,n},Ti=function(t){if(o(t))try{return JSON.parse(t)}catch(e){return t}return t},Si=T("message","component-created","component-mount","component-mounted"),Ci={render:function(){},childrenMounted:function(){},mounted:function(){},destroy:function(){},mount:function(t,e,n){var r=this;if(!Z(this)){Si.call("component-mount",void 0,this,t,e);var i=this.select(t),u=i.directives(),c=u?u.attrs:function(t){for(var e={},n=void 0,r=0;r<t.attributes.length;++r)e[(n=t.attributes[r]).name]=n.value;return e}(t),l=this.parent.model,f=i.datum(),h=this.props,d=this.model,p=er(function(t){var e=void 0;return Object.keys(t).reduce(function(n,r){return"data-"===r.substring(0,5)&&(n[e=r.split("-").splice(1).reduce(function(t,e,n){return t+=n?e.substring(0,1).toUpperCase()+e.substring(1):e},"")]=ar(t,r)),n},{})}(c),f,e),g=void 0,v=void 0;e=er({},f,e);for(g in d)void 0!==(v=ar(p,g))&&(o(v)&&(v=l.$isReactive(v)?function(t){return{reactOn:[t],get:function(){return this[t]}}}(v):Ti(v)),d[g]=v);this.model=d=l.$child(d),s(h)&&(h=h.reduce(function(t,e){return t[e]=void 0,t},{})),a(h)&&Object.keys(h).forEach(function(t){void 0!==(v=Ti(void 0===p[t]?void 0===e[t]?c[t]:e[t]:p[t]))?(o(v)&&d[v]&&(v=d[v]),e[t]=v):void 0!==h[t]&&(e[t]=h[t])}),d.$$name||(d.$$name=this.name);var m=this.render(e,c,t);return m.then||(m=ti(m)),m.then(function(e){return function(t,e,n,r){return n?(1!==(n=ei(n)).size()&&fr("render function must return a single HTML node"),n=n.node(),e.parentNode.insertBefore(n,e),t.select(e).remove(),K(t,n,r)):fr("render function must return a single HTML node. It returned nothing!")}(r,t,e,n)})}fr("already mounted")}},Ni=["name","class","disabled","readonly","required","href"],Pi=function(t,e){var n=Wr(t),r=n.directives();if(r)return r;if(r=new J,!e)return r;for(var i=0;i<t.attributes.length;++i){var a=t.attributes[i],o=a.name.split("-"),u="d3"===o[0]?o[1]:null,s=void 0;if(u){!(s=o.slice(2).join("-"))&&Ni.indexOf(u)>-1&&(s=u,u="attr");var c=e.get(u);c?r.add(c(t,a,s)):fr(t.tagName+' cannot find directive "'+u+'". Did you forget to register it?')}r.attrs[a.name]=a.value}return r.size()&&n.directives(r),r};J.prototype={size:function(){return this.all.length},pop:function(t){var e=this.all.indexOf(t);return e>-1&&(t.removeAttribute(),this.all.splice(e,1)),t},add:function(t){this.all.push(t)},forEach:function(t){this.all.forEach(t)},preMount:function(){for(var t=void 0,e=0;e<this.all.length;++e)if((t=this.all[e]).preMount())return this.pop(t)},execute:function(t){if(this.size())return Promise.all(this.all.map(function(e){return e.execute(t)}))}},A.prototype.mount=function(t,e){var n=[];return this.each(function(){var r=Wr(this).view();r?n.push(Q(this,r,t,e)):fr("Cannot mount, no view object available to mount to")}),Promise.all(n)},A.prototype.view=function(t){if(arguments.length)return this.property("__d3_view__",t);for(var e=this.node(),n=e.__d3_view__,r=e.parentNode;r&&!n;)n=r.__d3_view__,r=r.parentNode;return n},A.prototype.model=function(){var t=this.view();return t?t.model:null},A.prototype.directives=function(t){return arguments.length?this.property("__d3_directives__",t):this.node().__d3_directives__};var zi={use:function(t){return a(t)?t.install(this):t(this),this},addComponent:function(t,e){var n=B(t,e);return this.components.set(t,n),n},addDirective:function(t,e){var n=Ei(e);return this.directives.set(t,n),n},mount:function(t,e){if(Z(this))fr("already mounted");else if(Si.call("component-mount",void 0,this,t),t=function(t){if(!t)return fr("element not defined, pass an identifier or an HTMLElement object");var e=(u(t.node)?t:Wr(t)).node();if(e)return e;fr("could not find "+t+" element")}(t))return this.model=this.parent?this.parent.model.$child(this.model):W(this.model),K(this,t,e)}},Oi={attr:dr,html:pr,value:Jr,on:{mount:function(t){var e=this.arg||"click",n=this.expression;this.on(this.sel,e+"."+this.uid,function(e){var r=t.$child();r.$event=e,n.eval(r)}),this.bindDestroy(t)},destroy:function(){var t=this.arg||"click";this.on(this.sel,t+"."+this.uid,null)}},for:{create:function(t){var e=[];return t.trim().split(" ").forEach(function(t){t&&e.push(t)}),3!==e.length||"in"!=e[1]?fr('d3-for directive requires "item in expression" template, got "'+t+'"'):(this.itemName=e[0],this.itemClass="for"+this.uid,e[2])},preMount:function(){return!0},mount:function(t){if(this.creator=this.el,this.el=this.creator.parentNode,Wr(this.creator).remove(),this.el)return t},refresh:function(t,e){if(s(e)){var n=void 0,r=this.creator,i=r.tagName+"."+this.itemClass,a=this.itemName,o=this.sel,u=o.selectAll(i),c=u.filter(function(){return n=this.__d3_view__.model[a],e.indexOf(n)>-1}).data(e),l=u.filter(function(){return n=this.__d3_view__.model[a],-1===e.indexOf(n)}),f=B("forView",zi),h=o.view(),d=void 0,p=void 0,g=void 0,v=void 0;(this.transition(l)||l).style("opacity",0).remove(),c.enter().append(function(){return p=r.cloneNode(!0),g=h.select(p),h.transitionDuration(g)>0&&g.style("opacity",0),p}).classed(this.itemClass,!0).each(function(t,n){(d={index:n})[a]=t,f({model:d,parent:h}).mount(this,function(t){e[n]=t.model[a],(v=t.transition())&&v.style("opacity",1)})}).merge(c).each(function(t){this.__d3_view__.model[a]=t})}}},if:{mount:function(t){var e=this.sel;return this.display=e.style("display"),this.opacity=e.style("opacity"),this.display&&"none"!==this.display||(this.display="block"),t},refresh:function(t,e){var n=this.sel,r=this.passes?this.transition(n):null;e?n.style("display",this.display):r||n.style("display","none"),r&&(e?r.style("opacity",this.opacity):r.style("opacity",0).on("end",function(){return n.style("display","none")}))}}};if(rr){new MutationObserver(function(t){t.forEach(function(t){var e=t.removedNodes,n=void 0;e&&e.length&&e.forEach(function(t){"#text"!==t.nodeName&&(n=Wr(t)).view()&&(n.selectAll("*").each(tt),tt.call(t))})})}).observe(document.documentElement,{childList:!0,subtree:!0})}var Di=G(n(),Oi),ji=function(t){return B("view",zi,Di)(t)},$i=function(t){lr.readyCallbacks.push(t),"complete"!==document.readyState?(document.addEventListener("DOMContentLoaded",et),window.addEventListener("load",et)):nt()},Li={logger:ir},Fi=function(t){Li.logger.warn("[d3-form] "+t)},Ui={inputData:function(t,e){var n=this.model;return e||(e={}),e.id=e.id||n.uid,n.data=e,t.attr("id",e.id),e.classes&&t.classed(e.classes,!0),function(t,e,n){var r,i,o;if(a(n))for(i in n)a(r=n[i])&&("d3-"===i.substring(0,3)?(o=i.replace("-","_"),e.$set(o,r),r=o):r=JSON.stringify(r)),t.attr(i,r||"")}(t,n,e.attributes),e.disabled&&(o(e.disabled)?t.attr("d3-attr-disabled",e.disabled):t.property("disabled",!0)),e},wrap:function(t){var e=this,n=t;return e.model.$formExtensions.forEach(function(r){n=r(e,n,t)||n}),n},wrapTemplate:function(t,e){var n=document.createElement("div"),r=Wr(n).html(e).select("slot");if(!r.size())return Fi("template does not provide a slot element"),t;var i=Wr(r.node().parentNode);return t.nodes().forEach(function(t){i.insert(function(){return t},"slot")}),r.remove(),Ir(n.children)}},Hi=er({},Ui,{model:{value:null,error:"",isDirty:null,changed:!1,srOnly:!1,placeholder:"",showError:{reactOn:["error","isDirty"],get:function(){return!!this.error&&this.isDirty}},$validate:function(){}},inputData:function(t,e){if(!(e=Ui.inputData.call(this,t,e)).name)return Fi("Input field without a name");t.attr("name",e.name),e.placeholder=e.placeholder||e.label||e.name;var n=this.model;return n.form.inputs[e.name]=n,n.name=e.name,n.$on("value",function(){null===n.isDirty?n.isDirty=!1:(n.isDirty=!0,n.changed=!0),n.form.$change()}),e}}),Yi={text:"input",email:"input",password:"input",checkbox:"input",number:"input",date:"input",url:"input","datetime-local":"input"},Ri=er({},Ui,{render:function(t){var e=t?t.tag||"fieldset":"fieldset",n=this.createElement(e);return t=this.inputData(n,t),rt.call(this,n)}}),qi={get:function(t){var e=this.all.slice(0);if(a(t))for(var n in t)e.push(function(t,e){return{set:function(e,n){n[t]},validate:function(t,n){return e(t,n)}}}(n,t[n]));return e},set:function(t,e){var n=t.model;n._view=t,n.validators.forEach(function(t){return t.set(e,n.data)}),n.$on("value.validate",this.validate),n.$validate=this.validate},validate:function(){for(var t,e,n=this._view,r=this.validators,i=this.value,a=n.sel.attr("id")===this.data.id?n.sel:n.sel.select("#"+this.data.id),o=0;o<r.length;++o)if(t=r[o],e=t.validate(a,i)){!0===e&&(e="");break}this.error=e||""},all:[{set:function(t,e){var n=e.required;o(n)?t.attr("d3-required",n):t.property("required",n||null)},validate:function(t,e){if(t.property("required")){if(!e)return"required";if(""===e)return!0}}},{set:function(t,e){var n=e.minLength;o(n)?t.attr("d3-attr-minlength",n):void 0!==n&&t.attr("minlength",n)},validate:function(t,e){var n=+t.attr("minlength");if(n==n&&n>0&&e.length<n)return"too short - "+n+" characters or more expected"}},{set:function(t,e){var n=e.maxLength;o(n)?t.attr("d3-attr-maxlength",n):void 0!==n&&t.attr("maxlength",n)},validate:function(t,e){var n=+t.attr("maxlength");if(n==n&&n>0&&e&&e.length>n)return"too long - "+n+" characters or less expected"}},{set:function(t,e){var n=e.minimum;o(n)?t.attr("d3-attr-min",n):void 0!==n&&t.attr("min",n)},validate:function(t,e){var n=it(t);if(n&&+e<n[0])return"must be greater or equal "+n[0]}},{set:function(t,e){var n=e.maximum;o(n)?t.attr("d3-attr-max",n):void 0!==n&&t.attr("max",n)},validate:function(t,e){var n=it(t);if(n&&+e>n[1])return"must be less or equal "+n[1]}}]},Xi=["checkbox","radio"],Wi=er({},Hi,{render:function(t){var e=this.createElement("input");return t=this.inputData(e,t),e.attr("type",t.type||"text").attr("d3-value","value"),-1===Xi.indexOf(e.attr("type"))&&e.attr("placeholder",t.placeholder),qi.set(this,e),this.wrap(e)}}),Ii=er({},Hi,{render:function(t){var e=this.createElement("textarea");return t=this.inputData(e,t),e.attr("placeholder",t.placeholder).attr("d3-value","value"),qi.set(this,e),this.wrap(e)}}),Bi=er({},Hi,{model:er({options:[],$optionLabel:function(){return s(this.option)?this.option[1]||this.option[0]:this.option},$optionValue:function(){return s(this.option)?this.option[0]:this.option}},Hi.model),render:function(t){var e=this.createElement("select");return t=this.inputData(e,t),e.attr("d3-value","value").attr("placeholder",t.placeholder).append("option").attr("d3-for","option in options").attr("d3-html","$optionLabel()").attr("d3-attr-value","$optionValue()"),qi.set(this,e),this.wrap(e)}}),Vi=er({},Ui,{render:function(t){var e=t?t.tag||"button":"button",n=this.createElement(e);t=this.inputData(n,t);var r=this.model;return r.type=t.type||"submit",t.endpoint&&(r.endpoint=t.endpoint),r.$submit=function(){r.actions.submit.call(r,$r)},o(t.disabled)||(this.model.$set("disabled",t.disabled||null),t.disabled="disabled"),t.submit||(t.submit="$submit()"),n.attr("type",r.type).attr("name",r.name).attr("d3-attr-disabled",t.disabled).attr("d3-on-click",t.submit).html(t.label||"submit"),this.wrap(n)}}),Gi={default:function(t){this.message(t)},redirect:function(t){window.location.href=t.redirectTo||"/"}},Ki={submit:function(t){var e=this.form,n=er({},Zi,this.endpoint);t&&(t.preventDefault(),t.stopPropagation());var r=Li.fetch,i=e.$inputData(),a={};if(r)if(n.url){if("application/json"===n.contentType)a.headers={"Content-Type":n.contentType},a.body=JSON.stringify(i);else{a.body=new FormData;for(var o in i)a.body.set(o,i[o])}e.$setSubmit()?(a.method=n.method,r(n.url,a).then(function(t){e.$setSubmitDone();var n=(t.headers.get("content-type")||"").split(";")[0];"application/json"===n?t.json().then(function(n){e.$response(n,t.status,t.headers)}):Fi("Cannot load content type '"+n+"'")},function(){e.$setSubmitDone()})):e.$setSubmitDone()}else Fi("No url, cannot submit");else Fi("fetch provider not available, cannot submit")}},Zi={contentType:"application/json",method:"post"},Ji={props:["schema"],components:{"d3-form-fieldset":Ri,"d3-form-input":Wi,"d3-form-textarea":Ii,"d3-form-select":Bi,"d3-form-submit":Vi},model:{formSubmitted:!1,formPending:!1,$isValid:function(t){var e=void 0,n=!0;for(var r in this.inputs)e=this.inputs[r],t&&(e.isDirty=!0),e.$validate(),e.error&&(n=!1);return n},$setSubmit:function(){return this.formSubmitted=!0,this.formPending=!0,this.$isValid(!0)},$setSubmitDone:function(){this.formPending=!1},$inputData:function(){var t,e=this.inputs,n={};for(var r in e)((t=e[r].value)||Wi.changed)&&(n[r]=t);return n},$response:function(t,e,n){if(e<300)if(this.data.resultHandler){var r=Gi[this.data.resultHandler];r?r.call(this,t,e,n):Fi("Could not find "+this.data.resultHandler+" result handler")}else Gi.default.call(this,t,e,n);else this.$responseError(t,e,n)},$responseError:function(t){t.level="error",this.$message(t)}},render:function(t){function e(t){t=Ui.inputData.call(i,r,t),n.validators=qi.get(t.validators);for(var e in Ki){var a=t[e];o(a)&&(a=i.model.$get(a)),n.actions[e]=a||Ki[e]}return rt.call(i,r),r}var n=this.model,r=this.createElement("form").attr("novalidate",""),i=this;n.$formExtensions=this.root.$formExtensions||[],n.inputs={},n.actions={},n.form=n;var a=t.schema;if(o(a)){return(0,Li.fetch)(a,{method:"GET"}).then(function(t){if(200===t.status)return t.json().then(e);Fi("Could not load form from "+a+": status "+t.status)})}return e(a)}},Qi={install:function(t){t.addComponent("d3form",Ji),t.$formExtensions=[];for(var e in t.providers)Li[e]=t.providers[e]},actions:Ki,responses:Gi},ta={input:["inputGroup","label","formGroup"],checkbox:["formCheck"],textarea:["label","formGroup"],select:["label","formGroup"],submit:["submit"],wrappers:{label:function(t,e){var n=t.model.data;return t.wrapTemplate(e,function(t){var e=t.label||t.name;return"<label for="+t.id+' class="control-label" d3-class="[srOnly ? \'sr-only\' : null]">'+e+"</label>\n<slot></slot>"}(n))},formGroup:function(t,e,n){var r=t.model.data,i=void 0!==r.size?r.size:t.model.form.data.size,a=i?"form-control form-control-"+i:"form-control";return n.classed(a,!0).attr("d3-class","["+(r.required||!1)+' ? "form-control-required" : null, showError ? "form-control-danger" : null]'),t.wrapTemplate(e,'<div class="form-group" d3-class=\'showError ? "has-danger" : null\'>\n<slot></slot>\n<p d3-if="showError" class="text-danger error-block" d3-html="error"></p>\n</div>')},inputGroup:function(t,e,n){var r=t.model.data.group;if(!r)return e;var i="g"+n.attr("id");return n.attr("aria-describedby",i),t.wrapTemplate(e,function(t,e){return'<div class="input-group" :class="bootstrapStatus()">\n<span class="input-group-addon" id="'+t+'">'+r+"</span>\n<slot></slot>\n</div>"}(i))},formCheck:function(t,e,n){var r=t.model.data;return n.classed("form-check-input",!0),t.wrapTemplate(e,'<div class="form-check">\n<label class="form-check-label">\n<slot></slot>\n'+r.label+"\n</label>\n</div>")},submit:function(t,e,n){var r=t.model.data.theme||"primary";return n.classed("btn",!0).classed("btn-"+r,!0),t.wrapTemplate(e,'<div class="form-group">\n<slot></slot>\n</div>')}}},ea={install:function(t){if(!t.$formExtensions)return Fi("form bootstrap requires the form plugin installed first!");t.$formExtensions.push(function(t,e,n){var r=ta[n.attr("type")]||ta[n.node().tagName.toLowerCase()];if(!r)return e;var i=void 0;return r.forEach(function(r){(i=ta.wrappers[r])?e=i(t,e,n):Fi("Could not find form field wrapper "+r)}),e})}},na=[],ra=na.map,ia=na.some,aa=na.hasOwnProperty;at(function(t){if(!t.length||/^[\s._]/.test(t)||/\s$/.test(t))throw new Error("illegal name");return"https://unpkg.com/"+t});ut.amd={};var oa=new RegExp("^([a-z]+://|//)"),ua=at(function(t){var e=ua.libs.get(t)||t;return function(t){return"string"==typeof t&&oa.test(t)}(e)?e:"https://unpkg.com/"+t});ua.libs=n();var sa=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},ca=function(t){return 1===t.length&&(t=function(t){return function(e,n){return sa(t(e),n)}}(t)),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)<0?r=a+1:i=a}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)>0?i=a:r=a+1}return r}}},la=ca(sa).right,fa=function(t){return null===t?NaN:+t},ha=function(t,e){var n,r,i=t.length,a=0,o=-1,u=0,s=0;if(null==e)for(;++o<i;)isNaN(n=fa(t[o]))||(s+=(r=n-u)*(n-(u+=r/++a)));else for(;++o<i;)isNaN(n=fa(e(t[o],o,t)))||(s+=(r=n-u)*(n-(u+=r/++a)));if(a>1)return s/(a-1)},da=function(t,e){var n,r,i,a=t.length,o=-1;if(null==e){for(;++o<a;)if(null!=(n=t[o])&&n>=n)for(r=i=n;++o<a;)null!=(n=t[o])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++o<a;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=i=n;++o<a;)null!=(n=e(t[o],o,t))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]},pa=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a},ga=Math.sqrt(50),va=Math.sqrt(10),ma=Math.sqrt(2),ya=function(t,e,n){var r,i,a,o,u=-1;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=st(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(i=Math.ceil(e-t+1));++u<i;)a[u]=(t+u)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(i=Math.ceil(t-e+1));++u<i;)a[u]=(t-u)/o;return r&&a.reverse(),a},ba=function(t,e,n){if(null==n&&(n=fa),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t);return o+(+n(t[a+1],a+1,t)-o)*(i-a)}},_a=function(t,e){var n,r,i=t.length,a=-1;if(null==e){for(;++a<i;)if(null!=(n=t[a])&&n>=n)for(r=n;++a<i;)null!=(n=t[a])&&n>r&&(r=n)}else for(;++a<i;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=n;++a<i;)null!=(n=e(t[a],a,t))&&n>r&&(r=n);return r},xa=function(t,e){var n,r=t.length,i=-1,a=0;if(null==e)for(;++i<r;)(n=+t[i])&&(a+=n);else for(;++i<r;)(n=+e(t[i],i,t))&&(a+=n);return a},wa={initialise:function(t){this._data=t.data},getConfig:function(t){return s(t)?{data:t}:a(t)&&s(t.data)?t:void 0},getData:function(){return ti(this.asFrame(this._data))}},Ma={},ka={},Aa=34,Ea=10,Ta=13,Sa=function(t){function e(t,e){function n(){if(c)return ka;if(l)return l=!1,Ma;var e,n,r=u;if(t.charCodeAt(r)===Aa){for(;u++<o&&t.charCodeAt(u)!==Aa||t.charCodeAt(++u)===Aa;);return(e=u)>=o?c=!0:(n=t.charCodeAt(u++))===Ea?l=!0:n===Ta&&(l=!0,t.charCodeAt(u)===Ea&&++u),t.slice(r+1,e-1).replace(/""/g,'"')}for(;u<o;){if((n=t.charCodeAt(e=u++))===Ea)l=!0;else if(n===Ta)l=!0,t.charCodeAt(u)===Ea&&++u;else if(n!==i)continue;return t.slice(r,e)}return c=!0,t.slice(r,o)}var r,a=[],o=t.length,u=0,s=0,c=o<=0,l=!1;for(t.charCodeAt(o-1)===Ea&&--o,t.charCodeAt(o-1)===Ta&&--o;(r=n())!==ka;){for(var f=[];r!==Ma&&r!==ka;)f.push(r),r=n();e&&null==(f=e(f,s++))||a.push(f)}return a}function n(t){return null==t?"":r.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}var r=new RegExp('["'+t+"\n\r]"),i=t.charCodeAt(0);return{parse:function(t,n){var r,i,a=e(t,function(t,e){if(r)return r(t,e-1);i=t,r=n?function(t,e){var n=lt(t);return function(r,i){return e(n(r),i,t)}}(t,n):lt(t)});return a.columns=i,a},parseRows:e,format:function(e,r){return null==r&&(r=function(t){var e=Object.create(null),n=[];return t.forEach(function(t){for(var r in t)r in e||n.push(e[r]=r)}),n}(e)),[r.map(n).join(t)].concat(e.map(function(e){return r.map(function(t){return n(e[t])}).join(t)})).join("\n")},formatRows:function(e){return e.map(function(e){return e.map(n).join(t)}).join("\n")}}},Ca=Sa(",").parse,Na=Sa("\t").parse,Pa=function(t){lr.logger.warn("[d3-data-source] "+t)},za=["http","https","ws","wss"],Oa=i(["text/plain","text/csv","application/vnd.ms-excel"]),Da={getConfig:function(t){return function(t){return o(t)&&za.indexOf(t.split("://")[0])>-1}(t)?{url:t}:a(t)&&t.url?t:void 0},initialise:function(t){this.url=t.url},getData:function(){var t=lr.fetch,e=this;return t?t(this.url).then(function(t){var e=(t.headers.get("content-type")||"").split(";")[0];return Oa.has(e)?t.text().then(Ca):"text/tab-separated-values"===e?t.text().then(Na):"application/json"===e?t.json():(Pa("Cannot load content type '"+e+"'"),[])}).then(function(t){return e.asFrame(t)}):(Pa("fetch provider not available, cannot submit"),[])}},ja="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},$a=function(t,e){return e={exports:{}},t(e,e.exports),e.exports}(function(t,e){!function(t){function e(t){return t}function n(t,e){for(var n=0,r=e.length,i=new Array(r);n<r;++n)i[n]=t[e[n]];return i}function r(t){function e(e,n,r,i){for(;r<i;){var a=r+i>>>1;n<t(e[a])?i=a:r=a+1}return r}return e.right=e,e.left=function(e,n,r,i){for(;r<i;){var a=r+i>>>1;t(e[a])<n?r=a+1:i=a}return r},e}function i(t){function e(t,e,r){for(var i=r-e,a=1+(i>>>1);--a>0;)n(t,a,i,e);return t}function n(e,n,r,i){for(var a,o=e[--i+n],u=t(o);(a=n<<1)<=r&&(a<r&&t(e[i+a])>t(e[i+a+1])&&a++,!(u<=t(e[i+a])));)e[i+n]=e[i+a],n=a;e[i+n]=o}return e.sort=function(t,e,r){for(var i,a=r-e;--a>0;)i=t[e],t[e]=t[e+a],t[e+a]=i,n(t,1,a,e);return t},e}function a(t){var e=i(t);return function(n,r,i,a){var o,u,s,c=new Array(a=Math.min(i-r,a));for(u=0;u<a;++u)c[u]=n[r++];if(e(c,0,a),r<i){o=t(c[0]);do{t(s=n[r])>o&&(c[0]=s,o=t(e(c,0,a)[0]))}while(++r<i)}return c}}function o(t){return function(e,n,r){for(var i=n+1;i<r;++i){for(var a=i,o=e[i],u=t(o);a>n&&t(e[a-1])>u;--a)e[a]=e[a-1];e[a]=o}return e}}function u(t){function e(r,i,a){return(a-i<_?n:function(n,r,i){var a,o=(i-r)/6|0,u=r+o,s=i-1-o,c=r+i-1>>1,l=c-o,f=c+o,h=n[u],d=t(h),p=n[l],g=t(p),v=n[c],m=t(v),y=n[f],b=t(y),_=n[s],x=t(_);d>g&&(a=h,h=p,p=a,a=d,d=g,g=a);b>x&&(a=y,y=_,_=a,a=b,b=x,x=a);d>m&&(a=h,h=v,v=a,a=d,d=m,m=a);g>m&&(a=p,p=v,v=a,a=g,g=m,m=a);d>b&&(a=h,h=y,y=a,a=d,d=b,b=a);m>b&&(a=v,v=y,y=a,a=m,m=b,b=a);g>x&&(a=p,p=_,_=a,a=g,g=x,x=a);g>m&&(a=p,p=v,v=a,a=g,g=m,m=a);b>x&&(a=y,y=_,_=a,a=b,b=x,x=a);var w=p,M=g,k=y,A=b;n[u]=h,n[l]=n[r],n[c]=v,n[f]=n[i-1],n[s]=_;var E=r+1,T=i-2,S=M<=A&&M>=A;if(S)for(N=E;N<=T;++N){P=n[N];if((z=t(P))<M)N!==E&&(n[N]=n[E],n[E]=P),++E;else if(z>M)for(;;){if(!((O=t(n[T]))>M)){if(O<M){n[N]=n[E],n[E++]=n[T],n[T--]=P;break}n[N]=n[T],n[T--]=P;break}T--}}else for(N=E;N<=T;N++){P=n[N];if((z=t(P))<M)N!==E&&(n[N]=n[E],n[E]=P),++E;else if(z>A)for(;;){if(!((O=t(n[T]))>A)){O<M?(n[N]=n[E],n[E++]=n[T],n[T--]=P):(n[N]=n[T],n[T--]=P);break}if(--T<N)break}}if(n[r]=n[E-1],n[E-1]=w,n[i-1]=n[T+1],n[T+1]=k,e(n,r,E-1),e(n,T+2,i),S)return n;if(E<u&&T>s){for(var C;(C=t(n[E]))<=M&&C>=M;)++E;for(;(O=t(n[T]))<=A&&O>=A;)--T;for(var N=E;N<=T;N++){var P=n[N],z=t(P);if(z<=M&&z>=M)N!==E&&(n[N]=n[E],n[E]=P),E++;else if(z<=A&&z>=A)for(;;){var O;if(!((O=t(n[T]))<=A&&O>=A)){O<M?(n[N]=n[E],n[E++]=n[T],n[T--]=P):(n[N]=n[T],n[T--]=P);break}if(--T<N)break}}}return e(n,E,T+1)})(r,i,a)}var n=o(t);return e}function s(t){for(var e=new Array(t),n=-1;++n<t;)e[n]=0;return e}function c(t){return[0,t.length]}function l(){return null}function f(){return 0}function h(t){return t+1}function d(t){return t-1}function p(t){return function(e,n){return e+ +t(n)}}function g(t){return function(e,n){return e-t(n)}}function v(){function t(t){var e=s,n=t.length;return n&&(o=o.concat(t),w=k(w,s+=n),E.forEach(function(r){r(t,e,n)})),r}var r={add:t,remove:function(){for(var t=m(s,s),e=[],n=0,r=0;n<s;++n)w[n]?t[n]=r++:e.push(n);M.forEach(function(t){t(0,[],e)}),T.forEach(function(e){e(t)});for(var i,n=0,r=0;n<s;++n)(i=w[n])&&(n!==r&&(w[r]=i,o[r]=o[n]),++r);for(o.length=r;s>r;)w[--s]=0},dimension:function(t){function r(e,r,i){U=e.map(t),H=W(function(t){for(var e=m(t,t),n=-1;++n<t;)e[n]=n;return e}(i),0,i),U=n(U,H);var a,o=I(U),u=o[0],c=o[1];if(Y)for(a=0;a<i;++a)Y(U[a],a)||(w[H[a]+r]|=q);else{for(a=0;a<u;++a)w[H[a]+r]|=q;for(a=c;a<i;++a)w[H[a]+r]|=q}if(!r)return L=U,F=H,G=u,void(K=c);var l=L,f=F,h=0,d=0;for(L=new Array(s),F=m(s,s),a=0;h<r&&d<i;++a)l[h]<U[d]?(L[a]=l[h],F[a]=f[h++]):(L[a]=U[d],F[a]=H[d++]+r);for(;h<r;++h,++a)L[a]=l[h],F[a]=f[h];for(;d<i;++d,++a)L[a]=U[d],F[a]=H[d]+r;o=I(L),G=o[0],K=o[1]}function x(t,e,n){B.forEach(function(t){t(U,H,e,n)}),U=H=null}function S(t){for(var e,n=0,r=0;n<s;++n)w[e=F[n]]&&(n!==r&&(L[r]=L[n]),F[r]=t[e],++r);for(L.length=r;r<s;)F[r++]=0;var i=I(L);G=i[0],K=i[1]}function C(t){var e=t[0],n=t[1];if(Y)return Y=null,D(function(t,r){return e<=r&&r<n}),G=e,K=n,R;var r,i,a,o=[],u=[];if(e<G)for(r=e,i=Math.min(G,n);r<i;++r)w[a=F[r]]^=q,o.push(a);else if(e>G)for(r=G,i=Math.min(e,K);r<i;++r)w[a=F[r]]^=q,u.push(a);if(n>K)for(r=Math.max(e,K),i=n;r<i;++r)w[a=F[r]]^=q,o.push(a);else if(n<K)for(r=Math.max(G,n),i=K;r<i;++r)w[a=F[r]]^=q,u.push(a);return G=e,K=n,M.forEach(function(t){t(q,o,u)}),R}function N(t){return C((I=function(t,e){return function(n){var r=n.length;return[t.left(n,e,0,r),t.right(n,e,0,r)]}}(b,t))(L))}function P(t){return C((I=function(t,e){var n=e[0],r=e[1];return function(e){var i=e.length;return[t.left(e,n,0,i),t.left(e,r,0,i)]}}(b,t))(L))}function z(){return C((I=c)(L))}function O(t){return I=c,D(Y=t),G=0,K=s,R}function D(t){var e,n,r,i=[],a=[];for(e=0;e<s;++e)!(w[n=F[e]]&q)^!!(r=t(L[e],e))&&(r?(w[n]&=X,i.push(n)):(w[n]|=q,a.push(n)));M.forEach(function(t){t(q,i,a)})}function j(t){function n(e,n,r,i){function a(){++R===Y&&(E=A(E,H<<=1),z=A(z,H),Y=y(H))}var f,h,d,p,g,_,x=P,E=m(R,Y),T=j,S=U,C=R,N=0,O=0;for(G&&(T=S=l),P=new Array(R),R=0,z=C>1?k(z,s):m(s,Y),C&&(d=(h=x[0]).key);O<i&&!((p=t(e[O]))>=p);)++O;for(;O<i;){for(h&&d<=p?(g=h,_=d,E[N]=R,(h=x[++N])&&(d=h.key)):(g={key:p,value:S()},_=p),P[R]=g;!(p>_||(z[f=n[O]+r]=R,w[f]&X||(g.value=T(g.value,o[f])),++O>=i));)p=t(e[O]);a()}for(;N<C;)P[E[N]=R]=x[N++],a();if(R>N)for(N=0;N<r;++N)z[N]=E[z[N]];f=M.indexOf(W),R>1?(W=u,I=v):(!R&&K&&(R=1,P=[{key:null,value:S()}]),1===R?(W=c,I=b):(W=l,I=l),z=null),M[f]=W}function r(){if(R>1){for(var t=R,e=P,n=m(t,t),r=0,i=0;r<s;++r)w[r]&&(n[z[i]=z[r]]=1,++i);for(P=[],R=0,r=0;r<t;++r)n[r]&&(n[r]=R++,P.push(e[r]));if(R>1)for(r=0;r<i;++r)z[r]=n[z[r]];else z=null;M[M.indexOf(W)]=R>1?(I=v,W=u):1===R?(I=b,W=c):I=W=l}else if(1===R){if(K)return;for(r=0;r<s;++r)if(w[r])return;P=[],R=0,M[M.indexOf(W)]=W=I=l}}function u(t,e,n){if(t!==q&&!G){var r,i,a,u;for(r=0,a=e.length;r<a;++r)w[i=e[r]]&X||((u=P[z[i]]).value=j(u.value,o[i]));for(r=0,a=n.length;r<a;++r)(w[i=n[r]]&X)===t&&((u=P[z[i]]).value=$(u.value,o[i]))}}function c(t,e,n){if(t!==q&&!G){var r,i,a,u=P[0];for(r=0,a=e.length;r<a;++r)w[i=e[r]]&X||(u.value=j(u.value,o[i]));for(r=0,a=n.length;r<a;++r)(w[i=n[r]]&X)===t&&(u.value=$(u.value,o[i]))}}function v(){var t,e;for(t=0;t<R;++t)P[t].value=U();for(t=0;t<s;++t)w[t]&X||((e=P[z[t]]).value=j(e.value,o[t]))}function b(){var t,e=P[0];for(e.value=U(),t=0;t<s;++t)w[t]&X||(e.value=j(e.value,o[t]))}function _(){return G&&(I(),G=!1),P}function x(t,e,n){return j=t,$=e,U=n,G=!0,N}function E(){return x(h,d,f)}function S(t){function e(e){return t(e.value)}return O=a(e),D=i(e),N}function C(){var t=M.indexOf(W);return t>=0&&M.splice(t,1),(t=B.indexOf(n))>=0&&B.splice(t,1),(t=T.indexOf(r))>=0&&T.splice(t,1),N}var N={top:function(t){var e=O(_(),0,P.length,t);return D.sort(e,0,e.length)},all:_,reduce:x,reduceCount:E,reduceSum:function(t){return x(p(t),g(t),f)},order:S,orderNatural:function(){return S(e)},size:function(){return R},dispose:C,remove:C};V.push(N);var P,z,O,D,j,$,U,H=8,Y=y(H),R=0,W=l,I=l,G=!0,K=t===l;return arguments.length<1&&(t=e),M.push(W),B.push(n),T.push(r),n(L,F,0,s),E().orderNatural()}function $(){V.forEach(function(t){t.dispose()});var t=E.indexOf(r);return t>=0&&E.splice(t,1),(t=E.indexOf(x))>=0&&E.splice(t,1),(t=T.indexOf(S))>=0&&T.splice(t,1),v&=X,z()}var L,F,U,H,Y,R={filter:function(t){return null==t?z():Array.isArray(t)?P(t):"function"==typeof t?O(t):N(t)},filterExact:N,filterRange:P,filterFunction:O,filterAll:z,top:function(t){for(var e,n=[],r=K;--r>=G&&t>0;)w[e=F[r]]||(n.push(o[e]),--t);return n},bottom:function(t){for(var e,n=[],r=G;r<K&&t>0;)w[e=F[r]]||(n.push(o[e]),--t),r++;return n},group:j,groupAll:function(){var t=j(l),e=t.all;return delete t.all,delete t.top,delete t.order,delete t.orderNatural,delete t.size,t.value=function(){return e()[0].value},t},dispose:$,remove:$},q=~v&-~v,X=~q,W=u(function(t){return U[t]}),I=c,B=[],V=[],G=0,K=0;return E.unshift(r),E.push(x),T.push(S),v|=q,(_>=32?!q:v&-(1<<_))&&(w=A(w,_<<=1)),r(o,0,s),x(0,0,s),R},groupAll:function(){function t(t,e){var n;if(!m)for(n=e;n<s;++n)w[n]||(a=u(a,o[n]))}function e(t,e,n){var r,i,s;if(!m){for(r=0,s=e.length;r<s;++r)w[i=e[r]]||(a=u(a,o[i]));for(r=0,s=n.length;r<s;++r)w[i=n[r]]===t&&(a=c(a,o[i]))}}function n(t,e,n){return u=t,c=e,l=n,m=!0,v}function r(){return n(h,d,f)}function i(){var n=M.indexOf(e);return n>=0&&M.splice(n),(n=E.indexOf(t))>=0&&E.splice(n),v}var a,u,c,l,v={reduce:n,reduceCount:r,reduceSum:function(t){return n(p(t),g(t),f)},value:function(){return m&&(function(){var t;for(a=l(),t=0;t<s;++t)w[t]||(a=u(a,o[t]))}(),m=!1),a},dispose:i,remove:i},m=!0;return M.push(e),E.push(t),t(0,0),r()},size:function(){return s}},o=[],s=0,v=0,_=8,w=x(0),M=[],E=[],T=[];return arguments.length?t(arguments[0]):r}function m(t,e){return(e<257?x:e<65537?w:M)(t)}function y(t){return 8===t?256:16===t?65536:4294967296}v.version="1.3.12",v.permute=n;var b=v.bisect=r(e);b.by=r;(v.heap=i(e)).by=i;(v.heapselect=a(e)).by=a;(v.insertionsort=o(e)).by=o;(v.quicksort=u(e)).by=u;var _=32,x=s,w=s,M=s,k=function(t,e){for(var n=t.length;n<e;)t[n++]=0;return t},A=function(t,e){if(e>32)throw new Error("invalid array width!");return t};"undefined"!=typeof Uint8Array&&(x=function(t){return new Uint8Array(t)},w=function(t){return new Uint16Array(t)},M=function(t){return new Uint32Array(t)},k=function(t,e){if(t.length>=e)return t;var n=new t.constructor(e);return n.set(t),n},A=function(t,e){var n;switch(e){case 16:n=w(t.length);break;case 32:n=M(t.length);break;default:throw new Error("invalid array width!")}return n.set(t),n}),t.crossfilter=v}(e||ja)}).crossfilter,La=function(t){return function(e){return e[t]}};ft.prototype={dataFrame:function(){return this},size:function(){return this.data.length},new:function(t){return s(t)?new ft(t,null,this.store):new ft(this._inner,t)},cf:function(){return this._inner.cf||(this._inner.cf=$a(this.data)),this._inner.cf},dimension:function(t,e,n){1===arguments.length&&(n=!0);var r=this.dimensions[t];if(r){if(n)return r;r.dispose()}return e||(e=La(t)),this.dimensions[t]=this.cf().dimension(e),this.dimensions[t]},sortby:function(t,e){return this.new(this.dimension(t).top(e||1/0))},pivot:function(t,e,n,r){function i(i){var a=void 0,o=void 0;return function(u,s){return a=""+s[e],o=i*s[n],u[t]=s[t],a in u?u[a]+=o:u[a]=o,r in u?u[r]+=o:u[r]=o,u}}var a=this.dimension(t).group();return r||(r="total"),this.new(a.reduce(i(1),i(-1),Object).all().map(function(t){return t.value}))},add:function(){},map:function(t){return this.new(this.data.map(t))}};var Fa={initialise:function(t){this.source=t.source},getConfig:function(t){if(a(t)&&t.source)return s(t.source)||(t.source=[t.source]),t},getData:function(t){var e=this.store,n=this.source,r=this;return Promise.all(n.map(function(n){return e.getData(n,t)})).then(function(t){var i=void 0;return 1===t.length?i=t[0]:r.config.merge?i=r.mergeFrames(t):(i=new ht(e),t.forEach(function(t,e){i.frames.set(n[e],t)})),r.asFrame(i)})},mergeFrames:function(t){return t[0]}};ht.prototype={new:function(t){return new ft(t,null,this.store)},dataFrame:function(){for(var t=this.frames.values(),e=0;e<t.length;++e)if("dataframe"===t[e].type)return t[e]}};var Ua={initialise:function(t){this.expression=bi(t.expression)},getConfig:function(t){if(a(t)&&t.expression)return t},getData:function(t){var e=this,n=this.store.model.$child(t),r=this.expression.eval(n);return c(r)?r.then(function(t){return e.asFrame(t)}):e.asFrame(r)}},Ha=function(t){function e(t){return i.validate(t)?function(e){return n(e,t)}:i.logError()}var n=t.transform,r=t.schema||{},i=lr.jsonValidator?lr.jsonValidator(t.schema):Ya;return r.type||(r.type="object"),e.schema=r,e},Ya={validate:function(){return!0}},Ra=Ha({schema:{description:"The filter transform removes objects from a data frame based on a provided filter expression",properties:{expr:{type:"string"}},required:["expr"]},transform:function(t,e){var n=bi(e.expr);return t.data.reduce(function(e,r,i){return n.safeEval({d:r,index:i,frame:t})&&e.push(r),e},[])}}),qa=function(t,e){lr.logger.warn("[d3-visualize] "+t),e&&lr.logger.error(e.stack)},Xa=n({count:dt,max:_a,min:function(t,e){var n,r,i=t.length,a=-1;if(null==e){for(;++a<i;)if(null!=(n=t[a])&&n>=n)for(r=n;++a<i;)null!=(n=t[a])&&r>n&&(r=n)}else for(;++a<i;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=n;++a<i;)null!=(n=e(t[a],a,t))&&r>n&&(r=n);return r},sum:xa,mean:function(t,e){var n,r=t.length,i=r,a=-1,o=0;if(null==e)for(;++a<r;)isNaN(n=fa(t[a]))?--i:o+=n;else for(;++a<r;)isNaN(n=fa(e(t[a],a,t)))?--i:o+=n;if(i)return o/i},median:function(t,e){var n,r=t.length,i=-1,a=[];if(null==e)for(;++i<r;)isNaN(n=fa(t[i]))||a.push(n);else for(;++i<r;)isNaN(n=fa(e(t[i],i,t)))||a.push(n);return ba(a.sort(sa),.5)},variance:ha,deviation:function(t,e){var n=ha(t,e);return n?Math.sqrt(n):n}}),Wa=n({count:function(t){return t+1},sum:function(t,e){return t+e},max:Math.max,min:Math.min}),Ia=new Date,Ba=new Date,Va=pt(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});Va.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?pt(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):Va:null};var Ga=6e4,Ka=6048e5,Za=pt(function(t){t.setTime(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),Ja=pt(function(t){t.setTime(Math.floor(t/Ga)*Ga)},function(t,e){t.setTime(+t+e*Ga)},function(t,e){return(e-t)/Ga},function(t){return t.getMinutes()}),Qa=pt(function(t){var e=t.getTimezoneOffset()*Ga%36e5;e<0&&(e+=36e5),t.setTime(36e5*Math.floor((+t-e)/36e5)+e)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getHours()}),to=pt(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ga)/864e5},function(t){return t.getDate()-1}),eo=gt(0),no=gt(1),ro=(gt(2),gt(3),gt(4)),io=(gt(5),gt(6),pt(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()})),ao=pt(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});ao.every=function(t){return isFinite(t=Math.floor(t))&&t>0?pt(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var oo=pt(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*Ga)},function(t,e){return(e-t)/Ga},function(t){return t.getUTCMinutes()}),uo=pt(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getUTCHours()}),so=pt(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1}),co=vt(0),lo=vt(1),fo=(vt(2),vt(3),vt(4)),ho=(vt(5),vt(6),pt(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()})),po=pt(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});po.every=function(t){return isFinite(t=Math.floor(t))&&t>0?pt(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var go,vo,mo,yo,bo={"-":"",_:" ",0:"0"},_o=/^\s*\d+/,xo=/^%/,wo=/[\\^$*+?|[\]().{}]/g;!function(t){go=function(t){function e(t,e){return function(n){var r,i,a,o=[],u=-1,s=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++u<c;)37===t.charCodeAt(u)&&(o.push(t.slice(s,u)),null!=(i=bo[r=t.charAt(++u)])?r=t.charAt(++u):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),s=u+1);return o.push(t.slice(s,u)),o.join("")}}function n(t,e){return function(n){var i,a,o=yt(1900);if(r(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("p"in o&&(o.H=o.H%12+12*o.p),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(a=(i=mt(yt(o.y))).getUTCDay())>4||0===a?lo.ceil(i):lo(i),i=so.offset(i,7*(o.V-1)),o.y=i.getUTCFullYear(),o.m=i.getUTCMonth(),o.d=i.getUTCDate()+(o.w+6)%7):(i=(a=(i=e(yt(o.y))).getDay())>4||0===a?no.ceil(i):no(i),i=to.offset(i,7*(o.V-1)),o.y=i.getFullYear(),o.m=i.getMonth(),o.d=i.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),a="Z"in o?mt(yt(o.y)).getUTCDay():e(yt(o.y)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(a+5)%7:o.w+7*o.U-(a+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,mt(o)):e(o)}}function r(t,e,n,r){for(var i,a,o=0,u=e.length,s=n.length;o<u;){if(r>=s)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=k[i in bo?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}var i=t.dateTime,a=t.date,o=t.time,u=t.periods,s=t.days,c=t.shortDays,l=t.months,f=t.shortMonths,h=_t(u),d=xt(u),p=_t(s),g=xt(s),v=_t(c),m=xt(c),y=_t(l),b=xt(l),_=_t(f),x=xt(f),w={a:function(t){return c[t.getDay()]},A:function(t){return s[t.getDay()]},b:function(t){return f[t.getMonth()]},B:function(t){return l[t.getMonth()]},c:null,d:kt,e:kt,f:function(t,e){return At(t,e)+"000"},H:function(t,e){return bt(t.getHours(),e,2)},I:function(t,e){return bt(t.getHours()%12||12,e,2)},j:function(t,e){return bt(1+to.count(ao(t),t),e,3)},L:At,m:function(t,e){return bt(t.getMonth()+1,e,2)},M:function(t,e){return bt(t.getMinutes(),e,2)},p:function(t){return u[+(t.getHours()>=12)]},Q:Ct,s:Nt,S:function(t,e){return bt(t.getSeconds(),e,2)},u:function(t){var e=t.getDay();return 0===e?7:e},U:function(t,e){return bt(eo.count(ao(t),t),e,2)},V:function(t,e){var n=t.getDay();return t=n>=4||0===n?ro(t):ro.ceil(t),bt(ro.count(ao(t),t)+(4===ao(t).getDay()),e,2)},w:function(t){return t.getDay()},W:function(t,e){return bt(no.count(ao(t),t),e,2)},x:null,X:null,y:function(t,e){return bt(t.getFullYear()%100,e,2)},Y:function(t,e){return bt(t.getFullYear()%1e4,e,4)},Z:function(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+bt(e/60|0,"0",2)+bt(e%60,"0",2)},"%":St},M={a:function(t){return c[t.getUTCDay()]},A:function(t){return s[t.getUTCDay()]},b:function(t){return f[t.getUTCMonth()]},B:function(t){return l[t.getUTCMonth()]},c:null,d:Et,e:Et,f:function(t,e){return Tt(t,e)+"000"},H:function(t,e){return bt(t.getUTCHours(),e,2)},I:function(t,e){return bt(t.getUTCHours()%12||12,e,2)},j:function(t,e){return bt(1+so.count(po(t),t),e,3)},L:Tt,m:function(t,e){return bt(t.getUTCMonth()+1,e,2)},M:function(t,e){return bt(t.getUTCMinutes(),e,2)},p:function(t){return u[+(t.getUTCHours()>=12)]},Q:Ct,s:Nt,S:function(t,e){return bt(t.getUTCSeconds(),e,2)},u:function(t){var e=t.getUTCDay();return 0===e?7:e},U:function(t,e){return bt(co.count(po(t),t),e,2)},V:function(t,e){var n=t.getUTCDay();return t=n>=4||0===n?fo(t):fo.ceil(t),bt(fo.count(po(t),t)+(4===po(t).getUTCDay()),e,2)},w:function(t){return t.getUTCDay()},W:function(t,e){return bt(lo.count(po(t),t),e,2)},x:null,X:null,y:function(t,e){return bt(t.getUTCFullYear()%100,e,2)},Y:function(t,e){return bt(t.getUTCFullYear()%1e4,e,4)},Z:function(){return"+0000"},"%":St},k={a:function(t,e,n){var r=v.exec(e.slice(n));return r?(t.w=m[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=p.exec(e.slice(n));return r?(t.w=g[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=_.exec(e.slice(n));return r?(t.m=x[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=b[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,e,n){return r(t,i,e,n)},d:wt,e:wt,f:function(t,e,n){var r=_o.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1},H:Mt,I:Mt,j:function(t,e,n){var r=_o.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1},L:function(t,e,n){var r=_o.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1},m:function(t,e,n){var r=_o.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1},M:function(t,e,n){var r=_o.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1},p:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.p=d[r[0].toLowerCase()],n+r[0].length):-1},Q:function(t,e,n){var r=_o.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1},s:function(t,e,n){var r=_o.exec(e.slice(n));return r?(t.Q=1e3*+r[0],n+r[0].length):-1},S:function(t,e,n){var r=_o.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1},u:function(t,e,n){var r=_o.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1},U:function(t,e,n){var r=_o.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1},V:function(t,e,n){var r=_o.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1},w:function(t,e,n){var r=_o.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1},W:function(t,e,n){var r=_o.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1},x:function(t,e,n){return r(t,a,e,n)},X:function(t,e,n){return r(t,o,e,n)},y:function(t,e,n){var r=_o.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1},Y:function(t,e,n){var r=_o.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1},Z:function(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1},"%":function(t,e,n){var r=xo.exec(e.slice(n,n+1));return r?n+r[0].length:-1}};return w.x=e(a,w),w.X=e(o,w),w.c=e(i,w),M.x=e(a,M),M.X=e(o,M),M.c=e(i,M),{format:function(t){var n=e(t+="",w);return n.toString=function(){return t},n},parse:function(t){var e=n(t+="",function(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)});return e.toString=function(){return t},e},utcFormat:function(t){var n=e(t+="",M);return n.toString=function(){return t},n},utcParse:function(t){var e=n(t,mt);return e.toString=function(){return t},e}}}(t),vo=go.format,mo=go.utcFormat,yo=go.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Date.prototype.toISOString||mo("%Y-%m-%dT%H:%M:%S.%LZ"),+new Date("2000-01-01T00:00:00.000Z")||yo("%Y-%m-%dT%H:%M:%S.%LZ");var Mo={dataSource:null,size:{width:null,height:"70%"}};Mo.dateFormat="%d-%b-%y";var ko={date:function(t){return yo(t.dateFormat||Mo.dateFormat)},number:function(){return parseFloat}},Ao=Ha({shema:{description:"map a field values into another type",properties:{fields:{type:"object"},dateFormat:{type:"string"}},required:["fields"]},transform:function(t,e){var r=[],i=void 0,a=void 0;return n(e.fields).each(function(t,e){o(t)&&(t={type:t}),(a=ko[t.type])?r.push([e,a(t)]):qa("Cannot convert field "+e+" to type "+t.type)}),r.length&&(t=t.map(function(t){for(i=0;i<r.length;++i)t[r[i][0]]=r[i][1](t[r[i][0]]);return t})),t}}),Eo=function(t,e,n){return void 0!==n&&(t=Math.min(t,n)),void 0===e?t:Math.max(t,e)},To=Ha({shema:{description:"Create moving average series from existing one. The new series override the existing one unless the as array is provided",properties:{method:{type:"string"},alpha:{type:"number"},period:{type:"number"},fields:{type:"array",items:{type:"string"}},as:{type:"array",items:{type:"string"}}},required:["fields"]},transform:function(t,e){var n=e.as||[],r=e.method||"ema",i=void 0,a=void 0,o=void 0;e.fields.forEach(function(u,s){if(i=n[s]||u,"sma"===r){var c=Math.max(e.period||10,1),l=[],f=[];t.data.forEach(function(t,e){a=t[u],l.length===c&&(a-=f.splice(0,1)[0]),f.push(a),e&&(a+=l[l.length-1]),l.push(a),t[i]=a/l.length})}else{var h=Eo(e.alpha||.5,1-.999999,.999999);t.data.forEach(function(t,e){a=t[u],o=e?h*o+(1-h)*a:a,t[i]=o})}})}}),So=Ha({schema:{description:"Group entries which are below a given aggregate cutoff",properties:{field:{type:"string"},cutoff:{type:"number"}},required:["field","cutoff"]},transform:function(t,e){var n=La(e.field),r=xa(t.data,n),i=[],a=0;return t.dimension(e.field).bottom(1/0).reduce(function(t,o){return(a+=n(o))/r<e.cutoff?i.push(o):i?(i.push(o),(o={label:"other",children:i})[e.field]=a,i=null,t.push(o)):t.push(o),t},[])}}),Co=Ha({schema:{description:"Perfrom a difference for a group of fields along a dimension. It is possible to perform a difference for different groups",properties:{dimension:{type:"string"},period:{type:"integer",minimum:1},fields:{type:"array",items:{type:"string"}},as:{type:"array",items:{type:"string"}},groupby:{type:"string"}},required:["dimension","fields"]},transform:function(t,e){function n(t){var n=t.dimension(e.dimension),o=e.fields.reduce(function(t,e){return t[e]=0,t},{}),u=[],s=void 0,c=void 0;n.top(1/0).forEach(function(t,n){s=er({},t),u.push(t),c=n>i?u.splice(0,1)[0]:o,e.fields.forEach(function(e,n){t[r[n]||e]=t[e]-c[e]}),a.push(s)})}var r=e.as||[],i=e.period||1,a=[];if(e.groupby){var o=t.dimension(e.groupby);o.group().all().forEach(function(e){return n(t.new(o.filterAll().filter(e.key).top(1/0)))})}else n(t.new());return a}}),No=er(n({filter:Ra,aggregate:function(t){var e=t.fields,n=t.ops,r=t.as,i=t.groupby;return e||n?s(e)?(n||(n="count"),o(n)&&(n=function(t,e){var n=new Array(t);return n.fill(e),n}(e.length,n)),s(n)?(n.length<e.length&&qa("Aggregate transforms expects an ops array with same length as fields"),r||(r=[]),s(r)?function(t){var a,o,u=[];return i?function(t){var a=void 0,o=void 0,u=void 0,s=e.map(function(t,e){return o=n[e],u=Wa.get("count"),o&&((u=Wa.get(o))||(u=Wa.get("count"),qa("Operation "+o+" is not supported, use count"))),{field:t,as:r[e]||t,op:u}});return t.dimension(i).group().reduce(function(t,e){return s.reduce(function(t,n){return a=0,n.as in t&&(a=t[n.as]),t[n.as]=n.op(a,e[n.field]),t},t)},null,Object).all().map(function(t){return t.value[i]=t.key,t.value})}(t):(e.forEach(function(e,i){a=n[i],o=dt,a&&((o=Xa.get(a))||(o=dt,qa("Operation "+n[i]+" is not supported, use count"))),u.push({label:r[i]||e,data:o(t.data,function(t){return t[e]})})}),u)}:qa("Aggregate transform expects an array of as fields")):qa("Aggregate transform expects an array of ops")):qa("Aggregate transforms expect an array of fields"):function(t){var e=void 0;return t.data.reduce(function(t,n){for(e in n)e in t?t[e]+=1:t[e]=1;return t},{})}},mapfields:Ao,timeseries:function(t){var e=t.sortby,n=t.groupby;return e||qa('timeseries transform requires a "sortby" entry'),function(t){if(e){if(n){var r,i=t.dimension(n),a=i.group().top(1/0),o=t.new([]);return a.forEach(function(n){r=t.new(i.filterExact(n.key).top(1/0)).dimension(e).group().top(1/0),o.series.set(n.key,t.new(r).dimension("key").top(1/0))}),o}return t.new(t.dimension(e).top(1/0))}return t}},crossfilter:function(t){var e=t.fields,n=t.query;return s(e)?s(n)?n.length!=e.length?qa("crossfilter transform expects an query array with same length as fields"):function(t){var r=void 0,i=void 0;return e.forEach(function(e,a){o(i=n[a])&&(i=t.store.eval(i)),r=t.dimension(e).filterAll(),i&&r.filter(i)}),r?t.new(r.top(1/0)):t}:qa("crossfilter transform expects an array of query"):qa("crossfilter transform expects an array of fields")},movingaverage:To,groupsmall:So,diff:Co}),{add:function(t,e){this.set(t,Ha(e))}}),Po=T("init","data"),zo={getConfig:function(){},initialise:function(){},getData:function(){},addTransforms:function(t){var e=this,n=void 0;t&&(s(t)||(t=[t]),t.forEach(function(t){(n=No.get(t.type))?e.transforms.push(n(t)):qa('Transform type "'+t.type+'" not known')}))},asFrame:function(t){return s(t)&&(t=new ft(t=t.map(function(t){return t.constructor!==Object&&(t={data:t}),t}),null,this.store)),function(t,e){return e?Pt(t,e.slice()):t}(t,this.transforms)}},Oo=er(n(),{events:Po,add:function(t,e){function n(e,n){!function(t,e,n,r){var i=r.dataName(ar(n,"name")),a=[];Object.defineProperties(t,{name:{get:function(){return i}},store:{get:function(){return r}},type:{get:function(){return e}},transforms:{get:function(){return a}},config:{get:function(){return n}}}),t.initialise(n),t.addTransforms(ar(n,"transforms")),r.sources.set(i,t),Po.call("init",void 0,t)}(this,t,e,n)}return n.prototype=er({},zo,e),this.set(t,n),n},create:function(t,e){for(var n,r=this.values(),i=0;i<r.length;++i)if(n=r[i].prototype.getConfig(t))return new r[i](n,e)}});Oo.add("array",wa),Oo.add("remote",Da),Oo.add("composite",Fa),Oo.add("expression",Ua),zt.prototype={size:function(){return this.sources.size()},addSources:function(t){if(o(t)&&(t={source:t}),s(t)){var e=this;return t.map(function(t){return Oo.create(t,e)})}if(t)return Oo.create(t,this)},addTransforms:function(t){er(this.transforms,t)},source:function(t,e){if(1===arguments.length)return this.sources.get(t);if(null===e){var n=this.sources.get(t);return this.sources.remove(t),n}return this.sources.set(t,e),this},clearCache:function(){this.sources.each(function(t){delete t.cachedFrame})},getData:function(t,e){var n=this.sources.get(t);if(!n)throw new Error("Data source "+t+" not available");if(n.cachedFrame)return ti(n.cachedFrame);var r=n.getData(e);return c(r)||(r=ti(r)),r.then(function(t){return n.config.cache&&(n.cachedFrame=t),t})},eval:function(t,e){var n=this.model.$child(e);return n.dataStore=this,bi(t).safeEval(n)},dataName:function(t){if(this.dataCount++,t)return""+t;return this.source("default")?"source"+this.dataCount:"default"}};var Do=T("start","end","interrupt"),jo=[],$o=0,Lo=1,Fo=2,Uo=3,Ho=4,Yo=5,Ro=6,qo=function(t,e,n,r,i,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){function r(s){var c,l,f,h;if(n.state!==Lo)return a();for(c in u)if((h=u[c]).name===n.name){if(h.state===Uo)return Ar(r);h.state===Ho?(h.state=Ro,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete u[c]):+c<e&&(h.state=Ro,h.timer.stop(),delete u[c])}if(Ar(function(){n.state===Uo&&(n.state=Ho,n.timer.restart(i,n.delay,n.time),i(s))}),n.state=Fo,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Fo){for(n.state=Uo,o=new Array(f=n.tween.length),c=0,l=-1;c<f;++c)(h=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(o[++l]=h);o.length=l+1}}function i(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=Yo,1),i=-1,u=o.length;++i<u;)o[i].call(null,r);n.state===Yo&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){n.state=Ro,n.timer.stop(),delete u[e];for(var r in u)return;delete t.__transition}var o,u=t.__transition;u[e]=n,n.timer=h(function(t){n.state=Lo,n.timer.restart(r,n.delay,n.time),n.delay<=t&&r(t-n.delay)},0,n.time)}(t,n,{name:e,index:r,group:i,on:Do,tween:jo,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:$o})},Xo=function(t,e){var n,r,i,a=t.__transition,o=!0;if(a){e=null==e?null:e+"";for(i in a)(n=a[i]).name===e?(r=n.state>Fo&&n.state<Yo,n.state=Ro,n.timer.stop(),r&&n.on.call("interrupt",t,t.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete t.__transition}},Wo=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t},Io="\\s*([+-]?\\d+)\\s*",Bo="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Vo="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Go=/^#([0-9a-f]{3})$/,Ko=/^#([0-9a-f]{6})$/,Zo=new RegExp("^rgb\\("+[Io,Io,Io]+"\\)$"),Jo=new RegExp("^rgb\\("+[Vo,Vo,Vo]+"\\)$"),Qo=new RegExp("^rgba\\("+[Io,Io,Io,Bo]+"\\)$"),tu=new RegExp("^rgba\\("+[Vo,Vo,Vo,Bo]+"\\)$"),eu=new RegExp("^hsl\\("+[Bo,Vo,Vo]+"\\)$"),nu=new RegExp("^hsla\\("+[Bo,Vo,Vo,Bo]+"\\)$"),ru={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Wo(Lt,Ft,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),Wo(qt,Rt,$t(Lt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new qt(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new qt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),Wo(Wt,function(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Wt)return new Wt(t.h,t.s,t.l,t.opacity);if(t instanceof Lt||(t=Ft(t)),!t)return new Wt;if(t instanceof Wt)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,u=a-i,s=(a+i)/2;return u?(o=e===a?(n-r)/u+6*(n<r):n===a?(r-e)/u+2:(e-n)/u+4,u/=s<.5?a+i:2-a-i,o*=60):u=s>0&&s<1?0:o,new Wt(o,u,s,t.opacity)}(t):new Wt(t,e,n,null==r?1:r)},$t(Lt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Wt(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Wt(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new qt(It(t>=240?t-240:t+120,i,r),It(t,i,r),It(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var iu=Math.PI/180,au=180/Math.PI,ou=.95047,uu=1,su=1.08883,cu=4/29,lu=6/29,fu=3*lu*lu,hu=lu*lu*lu;Wo(Vt,function(t,e,n,r){return 1===arguments.length?Bt(t):new Vt(t,e,n,null==r?1:r)},$t(Lt,{brighter:function(t){return new Vt(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Vt(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return t=uu*Kt(t),e=ou*Kt(e),n=su*Kt(n),new qt(Zt(3.2404542*e-1.5371385*t-.4985314*n),Zt(-.969266*e+1.8760108*t+.041556*n),Zt(.0556434*e-.2040259*t+1.0572252*n),this.opacity)}})),Wo(Qt,function(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Qt)return new Qt(t.h,t.c,t.l,t.opacity);t instanceof Vt||(t=Bt(t));var e=Math.atan2(t.b,t.a)*au;return new Qt(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new Qt(t,e,n,null==r?1:r)},$t(Lt,{brighter:function(t){return new Qt(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Qt(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return Bt(this).rgb()}}));var du=-.14861,pu=1.78277,gu=-.29227,vu=-.90649,mu=1.97294,yu=mu*vu,bu=mu*pu,_u=pu*gu-vu*du;Wo(ee,te,$t(Lt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ee(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ee(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*iu,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new qt(255*(e+n*(du*r+pu*i)),255*(e+n*(gu*r+vu*i)),255*(e+n*(mu*r)),this.opacity)}}));var xu,wu,Mu,ku,Au=function(t){return function(){return t}},Eu=function t(e){function n(t,e){var n=r((t=Rt(t)).r,(e=Rt(e)).r),i=r(t.g,e.g),a=r(t.b,e.b),o=re(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}var r=function(t){return 1==(t=+t)?re:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Au(isNaN(e)?n:e)}}(e);return n.gamma=t,n}(1),Tu=function(t,e){return t=+t,e-=t,function(n){return t+e*n}},Su=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Cu=new RegExp(Su.source,"g"),Nu=function(t,e){var n,r,i,a=Su.lastIndex=Cu.lastIndex=0,o=-1,u=[],s=[];for(t+="",e+="";(n=Su.exec(t))&&(r=Cu.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),u[o]?u[o]+=i:u[++o]=i),(n=n[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,s.push({i:o,x:Tu(n,r)})),a=Cu.lastIndex;return a<e.length&&(i=e.slice(a),u[o]?u[o]+=i:u[++o]=i),u.length<2?s[0]?function(t){return function(e){return t(e)+""}}(s[0].x):function(t){return function(){return t}}(e):(e=s.length,function(t){for(var n,r=0;r<e;++r)u[(n=s[r]).i]=n.x(t);return u.join("")})},Pu=function(t,e){var n,r=void 0===e?"undefined":gr(e);return null==e||"boolean"===r?Au(e):("number"===r?Tu:"string"===r?(n=Ft(e))?(e=n,Eu):Nu:e instanceof Ft?Eu:e instanceof Date?function(t,e){var n=new Date;return t=+t,e-=t,function(r){return n.setTime(t+e*r),n}}:Array.isArray(e)?function(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(r),o=new Array(r);for(n=0;n<i;++n)a[n]=Pu(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?function(t,e){var n,r={},i={};null!==t&&"object"===(void 0===t?"undefined":gr(t))||(t={}),null!==e&&"object"===(void 0===e?"undefined":gr(e))||(e={});for(n in e)n in t?r[n]=Pu(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}:Tu)(t,e)},zu=function(t,e){return t=+t,e-=t,function(n){return Math.round(t+e*n)}},Ou=180/Math.PI,Du={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},ju=function(t,e,n,r,i,a){var o,u,s;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(s=t*n+e*r)&&(n-=t*s,r-=e*s),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,s/=u),t*r<e*n&&(t=-t,e=-e,s=-s,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Ou,skewX:Math.atan(s)*Ou,scaleX:o,scaleY:u}},$u=ie(function(t){return"none"===t?Du:(xu||(xu=document.createElement("DIV"),wu=document.documentElement,Mu=document.defaultView),xu.style.transform=t,t=Mu.getComputedStyle(wu.appendChild(xu),null).getPropertyValue("transform"),wu.removeChild(xu),t=t.slice(7,-1).split(","),ju(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),Lu=ie(function(t){return null==t?Du:(ku||(ku=document.createElementNS("http://www.w3.org/2000/svg","g")),ku.setAttribute("transform",t),(t=ku.transform.baseVal.consolidate())?(t=t.matrix,ju(t.a,t.b,t.c,t.d,t.e,t.f)):Du)},", ",")",")");ae(function(t,e){var n=e-t;return n?ne(t,n>180||n<-180?n-360*Math.round(n/360):n):Au(isNaN(t)?e:t)});var Fu=ae(re),Uu=function(t,e){var n;return("number"==typeof e?Tu:e instanceof Ft?Eu:(n=Ft(e))?(e=n,Eu):Nu)(t,e)},Hu=A.prototype.constructor,Yu=0,Ru=A.prototype;ue.prototype=se.prototype={constructor:ue,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Ur(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var u,s,c=r[o],l=c.length,f=a[o]=new Array(l),h=0;h<l;++h)(u=c[h])&&(s=t.call(u,u.__data__,h,c))&&("__data__"in u&&(s.__data__=u.__data__),f[h]=s,qo(f[h],e,n,h,f,jt(u,n)));return new ue(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Hr(t));for(var r=this._groups,i=r.length,a=[],o=[],u=0;u<i;++u)for(var s,c=r[u],l=c.length,f=0;f<l;++f)if(s=c[f]){for(var h,d=t.call(s,s.__data__,f,c),p=jt(s,n),g=0,v=d.length;g<v;++g)(h=d[g])&&qo(h,e,n,g,d,p);a.push(d),o.push(s)}return new ue(a,o,e,n)},filter:function(t){"function"!=typeof t&&(t=Dr(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],u=o.length,s=r[i]=[],c=0;c<u;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&s.push(a);return new ue(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),u=0;u<a;++u)for(var s,c=e[u],l=n[u],f=c.length,h=o[u]=new Array(f),d=0;d<f;++d)(s=c[d]||l[d])&&(h[d]=s);for(;u<r;++u)o[u]=e[u];return new ue(o,this._parents,this._name,this._id)},selection:function(){return new Hu(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=ce(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,u=r[a],s=u.length,c=0;c<s;++c)if(o=u[c]){var l=jt(o,e);qo(o,t,n,c,u,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new ue(r,this._parents,t,n)},call:Ru.call,nodes:Ru.nodes,node:Ru.node,size:Ru.size,empty:Ru.empty,each:Ru.each,on:function(t,e){var n=this._id;return arguments.length<2?jt(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,a=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?Ot:Dt;return function(){var o=a(this,t),u=o.on;u!==r&&(i=(r=u).copy()).on(e,n),o.on=i}}(n,t,e))},attr:function(t,e){var n=Cr(t),r="transform"===n?Lu:Uu;return this.attrTween(t,"function"==typeof e?(n.local?function(t,e,n){var r,i,a;return function(){var o,u=n(this);if(null!=u)return(o=this.getAttributeNS(t.space,t.local))===u?null:o===r&&u===i?a:a=e(r=o,i=u);this.removeAttributeNS(t.space,t.local)}}:function(t,e,n){var r,i,a;return function(){var o,u=n(this);if(null!=u)return(o=this.getAttribute(t))===u?null:o===r&&u===i?a:a=e(r=o,i=u);this.removeAttribute(t)}})(n,r,oe(this,"attr."+t,e)):null==e?(n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(n):(n.local?function(t,e,n){var r,i;return function(){var a=this.getAttributeNS(t.space,t.local);return a===n?null:a===r?i:i=e(r=a,n)}}:function(t,e,n){var r,i;return function(){var a=this.getAttribute(t);return a===n?null:a===r?i:i=e(r=a,n)}})(n,r,e+""))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=Cr(t);return this.tween(n,(r.local?function(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttributeNS(t.space,t.local,r(e))}}return n._value=e,n}:function(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttribute(t,r(e))}}return n._value=e,n})(r,e))},style:function(t,e,n){var r="transform"==(t+="")?$u:Uu;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var a=m(this,t),o=(this.style.removeProperty(t),m(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}(t,r)).on("end.style."+t,function(t){return function(){this.style.removeProperty(t)}}(t)):this.styleTween(t,"function"==typeof e?function(t,e,n){var r,i,a;return function(){var o=m(this,t),u=n(this);return null==u&&(this.style.removeProperty(t),u=m(this,t)),o===u?null:o===r&&u===i?a:a=e(r=o,i=u)}}(t,r,oe(this,"style."+t,e)):function(t,e,n){var r,i;return function(){var a=m(this,t);return a===n?null:a===r?i:i=e(r=a,n)}}(t,r,e+""),n)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){function r(){var r=this,i=e.apply(r,arguments);return i&&function(e){r.style.setProperty(t,i(e),n)}}return r._value=e,r}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(oe(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=jt(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==e?function(t,e){var n,r;return function(){var i=Dt(this,t),a=i.tween;if(a!==n)for(var o=0,u=(r=n=a).length;o<u;++o)if(r[o].name===e){(r=r.slice()).splice(o,1);break}i.tween=r}}:function(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=Dt(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var u={name:e,value:n},s=0,c=i.length;s<c;++s)if(i[s].name===e){i[s]=u;break}s===c&&i.push(u)}a.tween=i}})(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){Ot(this,t).delay=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){Ot(this,t).delay=e}})(e,t)):jt(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){Dt(this,t).duration=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){Dt(this,t).duration=e}})(e,t)):jt(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){Dt(this,t).ease=e}}(e,t)):jt(this.node(),e).ease}};var qu={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};A.prototype.interrupt=function(t){return this.each(function(){Xo(this,t)})},A.prototype.transition=function(t){var e,n;t instanceof ue?(e=t._id,t=t._name):(e=ce(),(n=qu).time=l(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,u=r[a],s=u.length,c=0;c<s;++c)(o=u[c])&&qo(o,t,e,c,u,n||function(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return qu.time=l(),qu;return n}(o,e));return new ue(r,this._parents,t,e)};var Xu,Wu=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},Iu=400,Bu="75%",Vu=["visual","container"],Gu={live:[],types:{},papers:{},options:Mo,events:T("before-init","after-init","resize","before-draw","after-draw")},Ku=er({},{initialise:function(){},draw:function(){},redraw:function(t){if(this.drawing){var e=this,n="after-draw."+this.toString();Gu.events.on(n,function(){Gu.events.on(n,null),e.redraw(t)})}else this.drawing=this.draw(t);return this.drawing},select:function(t){return Wr(t)},event:function(){return $r},destroy:function(){},toString:function(){return this.visualType+"-"+this.model.uid},getModel:function(t){t||(t=this.visualType);var e=this.model[t];if(!e&&t in Mo){var n=ar(this.options,t),r=this;this.visualParent?e=this.visualParent.getModel(t).$child(n):(e=this.model.$new(Mo[t])).$update(n),this.model[t]=e,e.$on(function(){return r.redraw(!1)})}return e},idname:function(t){return t||(t=this.visualType),t+"-"+this.model.uid},modelProperty:function(t,e){var n=this.getModel()[t];return void 0===n?e[t]:n},dim:function(t,e,n,r){return Eo(le(t,e),n,r)},pop:function(t){if(t){var e=t.live.indexOf(this);e>-1&&t.live.splice(e,1)}},getVisualSchema:function(t){var e=this.options.visuals?this.options.visuals[t]:null,n=this.visualParent;if(n&&o(e)?(t=e,e=n.getVisualSchema(t)):n&&!e&&(e=n.getVisualSchema(t)),a(e))return de(e)}},ri),Zu=function(t,e){function n(e,n,r,i){Object.defineProperties(this,{visualType:{get:function(){return t}},isViz:{get:function(){return-1===Vu.indexOf(t)}},visualRoot:{get:function(){return this.visualParent?this.visualParent.visualRoot:this}}}),this.visualParent=r,this.model=r?r.model.$new():i||W(),this.options=n||{},this.drawing=!1,Gu.events.call("before-init",void 0,this),this.initialise(e),Gu.events.call("after-init",void 0,this)}var r=ar(e,"options");return r&&(Mo[t]=r),n.prototype=er({},Ku,e),n.prototype.constructor=n,Gu.types[t]=n,n},Ju=Array.prototype,Qu=Ju.map,ts=Ju.slice,es={name:"implicit"},ns=function(t){return function(){return t}},rs=function(t){return+t},is=[0,1],as=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},os=function(t){return(t=as(Math.abs(t)))?t[1]:NaN},us=function(t,e){var n=as(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},ss={"":function(t,e){t:for(var n,r=(t=t.toPrecision(e)).length,i=1,a=-1;i<r;++i)switch(t[i]){case".":a=n=i;break;case"0":0===a&&(a=i),n=i;break;case"e":break t;default:a>0&&(a=0)}return a>0?t.slice(0,a)+t.slice(n+1):t},"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return us(100*t,e)},r:us,s:function(t,e){var n=as(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(Xu=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+as(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},cs=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;_e.prototype=xe.prototype,xe.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var ls,fs,hs,ds=function(t){return t},ps=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],gs=function(t){function e(t){function e(t){var e,r,o,l=v,_=m;if("c"===g)_=y(t)+_,t="";else{var x=(t=+t)<0;if(t=y(Math.abs(t),p),x&&0==+t&&(x=!1),l=(x?"("===c?c:"-":"-"===c||"("===c?"":c)+l,_=_+("s"===g?ps[8+Xu/3]:"")+(x&&"("===c?")":""),b)for(e=-1,r=t.length;++e<r;)if(48>(o=t.charCodeAt(e))||o>57){_=(46===o?i+t.slice(e+1):t.slice(e))+_,t=t.slice(0,e);break}}d&&!f&&(t=n(t,1/0));var w=l.length+t.length+_.length,M=w<h?new Array(h-w+1).join(u):"";switch(d&&f&&(t=n(M+t,M.length?h-_.length:1/0),M=""),s){case"<":t=l+t+_+M;break;case"=":t=l+M+t+_;break;case"^":t=M.slice(0,w=M.length>>1)+l+t+_+M.slice(w);break;default:t=M+l+t+_}return a(t)}var u=(t=_e(t)).fill,s=t.align,c=t.sign,l=t.symbol,f=t.zero,h=t.width,d=t.comma,p=t.precision,g=t.type,v="$"===l?r[0]:"#"===l&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",m="$"===l?r[1]:/[%p]/.test(g)?o:"",y=ss[g],b=!g||/[defgprs%]/.test(g);return p=null==p?g?6:12:/[gprs]/.test(g)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p)),e.toString=function(){return t+""},e}var n=t.grouping&&t.thousands?function(t,e){return function(n,r){for(var i=n.length,a=[],o=0,u=t[0],s=0;i>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),a.push(n.substring(i-=u,i+u)),!((s+=u+1)>r));)u=t[o=(o+1)%t.length];return a.reverse().join(e)}}(t.grouping,t.thousands):ds,r=t.currency,i=t.decimal,a=t.numerals?function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(t.numerals):ds,o=t.percent||"%";return{format:e,formatPrefix:function(t,n){var r=e((t=_e(t),t.type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(os(n)/3))),a=Math.pow(10,-i),o=ps[8+i/3];return function(t){return r(a*t)+o}}}};!function(t){ls=gs(t),fs=ls.format,hs=ls.formatPrefix}({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var vs=function(t,e,n){var r,i=t[0],a=t[t.length-1],o=ct(i,a,null==e?10:e);switch((n=_e(null==n?",f":n)).type){case"s":var u=Math.max(Math.abs(i),Math.abs(a));return null!=n.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(os(e)/3)))-os(Math.abs(t)))}(o,u))||(n.precision=r),hs(n,u);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,os(e)-os(t))+1}(o,Math.max(Math.abs(i),Math.abs(a))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=function(t){return Math.max(0,-os(Math.abs(t)))}(o))||(n.precision=r-2*("%"===n.type))}return fs(n)},ms=function(t,e){var n,r=0,i=(t=t.slice()).length-1,a=t[r],o=t[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),t[r]=e.floor(a),t[i]=e.ceil(o),t},ys=1e3,bs=60*ys,_s=60*bs,xs=24*_s,ws=7*xs,Ms=30*xs,ks=365*xs,As=function(t){return t.match(/.{6}/g).map(function(t){return"#"+t})},Es=As("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Ts=As("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),Ss=As("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),Cs=As("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),Ns=Fu(te(300,.5,0),te(-240,.5,1)),Ps=Fu(te(-100,.75,.35),te(80,1.5,.8)),zs=Fu(te(260,.75,.35),te(80,1.5,.8)),Os=te(),Ds=function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return Os.h=360*t-100,Os.s=1.5-1.5*e,Os.l=.8-.9*e,Os+""},js=je(As("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),$s=je(As("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Ls=je(As("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Fs=je(As("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),Us=Object.freeze({scaleBand:ge,scalePoint:function(){return ve(ge().paddingInner(1))},scaleIdentity:ke,scaleLinear:Me,scaleLog:Se,scaleOrdinal:pe,scaleImplicit:es,scalePow:Ne,scaleSqrt:function(){return Ne().exponent(.5)},scaleQuantile:Pe,scaleQuantize:ze,scaleThreshold:Oe,scaleTime:function(){return De(ao,io,eo,to,Qa,Ja,Za,Va,vo).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},scaleUtc:function(){return De(po,ho,co,so,uo,oo,Za,Va,mo).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},schemeCategory10:Es,schemeCategory20b:Ts,schemeCategory20c:Ss,schemeCategory20:Cs,interpolateCubehelixDefault:Ns,interpolateRainbow:Ds,interpolateWarm:Ps,interpolateCool:zs,interpolateViridis:js,interpolateMagma:$s,interpolateInferno:Ls,interpolatePlasma:Fs,scaleSequential:$e}),Hs=Zu("visual",{options:{render:"svg",width:null,height:"70%",heightElement:null},initialise:function(t){if(!t)throw new Error("HTMLElement required by visual group");if(this.visualParent&&"container"!==this.visualParent.visualType)throw new Error("Visual parent can be a container only");this.select(t).select(".paper").node()||this.select(t).append("div").classed("paper",!0),Object.defineProperties(this,{element:{get:function(){return t}},paperElement:{get:function(){return this.sel.select(".paper")}},sel:{get:function(){return Wr(t)}},size:{get:function(){return[this.width,this.height]}}}),this.sel.classed("d3-visual",!0),this.layers=[],this.drawCount=0,Gu.live.push(this),t.__visual__=this,this.visualParent&&this.visualParent.live.push(this)},activate:function(){this.layers.forEach(function(t){return t.activate()})},deactivate:function(){this.layers.forEach(function(t){return t.deactivate()})},getVisual:function(){return this},draw:function(t){if(this.drawing)return qa(this.toString()+" already drawing"),this.drawing;this.drawCount?(this.drawCount++,this.clear()):(this.drawCount=1,this.fit());var e=this;return Gu.events.call("before-draw",void 0,this),Promise.all(this.layers.map(function(e){return e.redraw(t)})).then(function(){delete e.drawing,Gu.events.call("after-draw",void 0,e)},function(t){delete e.drawing,qa("Could not draw "+e.toString()+": "+t,t)})},clear:function(){},addVisual:function(t){var e=ar(t,"type"),n=Gu.types[e];if(n)return new n(this.element,t,this);qa('Cannot add visual "'+e+'", not available')},fit:function(){return this.resize(null,!0),this},resize:function(t,e){t||(t=function(t,e){var n={width:e.width,height:e.height};return n.width||(n.width=function(t){var e=fe(t,"width");if(e)return function(t){var e=t.getBoundingClientRect().width,n=Wr(t),r=he(n.style("padding-left")),i=he(n.style("padding-right"));return e-r-i}(e)}(t),n.width?n.widthElement=function(t){return fe(t,"width")}(t):n.width=Iu),n.height||(n.height=function(t){var e=fe(t,"width");if(e)return function(t){var e=t.getBoundingClientRect().height,n=Wr(t),r=he(n.style("padding-top")),i=he(n.style("padding-bottom"));return e-r-i}(e)}(t),n.height?n.heightElement=function(t){return fe(t,"height")}(t):n.height=Bu),n.height=Eo(le(n.height,n.width),void 0,window.innerHeight),n}(this.element.parentNode||this.element,this.getModel()));var n=this.size;return(e||n[0]!==t.width||n[1]!==t.height)&&(e||ur('Resizing "'+this.toString()+'"'),this.width=t.width,this.height=t.height,this.paperElement.style("height",this.height+"px"),Gu.events.call("resize",void 0,this),e||this.draw(!1)),this},paper:function(){var t=this.__paper,e=this.getModel().render;if(t&&t.paperType===e)return t;var n=Gu.papers[e];if(!n)throw new Error("Unknown paper "+e);return t=new n(this),this.__paper=t,t},getPaperGroup:function(t){return this.paper().group(t)},destroy:function(){this.pop(this.visualParent),this.pop(Gu)}});if(rr){new MutationObserver(function(t){t.forEach(function(t){var e=t.removedNodes;e&&e.length&&e.forEach(function(t){t.querySelectorAll&&(t.__visual__?Le.call(t):Wr(t).selectAll(".d3-visual").each(Le))})})}).observe(document.documentElement,{childList:!0,subtree:!0})}var Ys=function(t,e,n,r){return n.substring(0,e.length)!==e&&(n=""+e+n[0].toUpperCase()+n.substring(1)),r?t[n]:t[n]()},Rs=function(t){lr.visualPlugins&&(!function(t){var e=void 0,n=void 0;Object.keys(t).forEach(function(r){e=t[r].options,n=t[r].prototype,e&&(Gu.options[r]=e),n&&er(qs,n)})}(lr.visualPlugins),lr.visualPlugins=null);for(var e=[{},qs,Xs],n=1;n<arguments.length;++n)e.push(arguments[n]);return Zu(t,er.apply(void 0,e))},qs={initialise:function(t){var e=this.visualParent;if(void 0!==this.options.active?this.active=ar(this.options,"active"):this.active=!0,e){if(!e.layers)throw new Error("visual parent of "+this.visualType+" does not have layers")}else this.visualParent=e=new Hs(t,this.options,null,this.model),this.model=e.model.$new(),this.options={};e.layers.push(this)},paper:function(){return this.visualParent.paper()},activate:function(t){return this.active||(this.active=!0,this.group().transition(this.model.uid).on("end",function(){t&&t()}).style("opacity",1)),this},deactivate:function(t){return this.active&&(this.active=!1,this.group().transition(this.model.uid).on("end",function(){t&&t()}).style("opacity",0)),this},getVisual:function(){return this.visualParent.getVisual()},group:function(t){var e=this.visualType+"-"+this.model.uid,n=this.visualParent.getPaperGroup(e);return t&&t!==this.visualType?this.paper().childGroup(n,t):n},translate:function(t,e){return u(t)?function(n){return"translate("+(t(n)||0)+", "+(e(n)||0)+")"}:"translate("+t+", "+e+")"},getScale:function(t){return o(t)&&(t={type:t}),function(t,e){return(e.$events?e.$events.keys():Object.keys(e)).forEach(function(n){u(t[n])&&t[n](e[n])}),t}(Ys(Us,"scale",t.type),t)},displayError:function(){}},Xs={draw:function(t){var e=this;if(this.drawing)return qa(this.toString()+" already drawing"),this.drawing;var n=this,r=this.doDraw;if(this.paper().size(this.boundingBox(!0)),this.active){if(Gu.events.call("before-draw",void 0,this),!1!==t||!this._drawArgs)return Promise.all([this.requires?ua.apply(void 0,this.requires):[],this.getData()]).then(function(t){delete n.drawing;var i=t[1];i&&((t=s(t[0])?t[0]:[t[0]]).unshift(i),e._drawArgs=t,r.apply(n,t),Gu.events.call("after-draw",void 0,n))},function(t){delete n.drawing,qa("Could not draw "+n.toString()+": "+t,t),e.displayError(t)});delete n.drawing,r.apply(n,this._drawArgs),Gu.events.call("after-draw",void 0,n)}}},Ws={initialise:function(){},transition:function(){},size:function(t){return this.sel.attr("width",t.width).attr("height",t.height),this},group:function(t,e){return this.childGroup(this.sel,t,e)},childGroup:function(t,e,n){e||(e="main");var r=t.selectAll("."+e).data([0]).enter().append("g").classed(e,!0);return n&&r.attr("transform",n).merge().attr("transform",n),t.select("."+e)},dim:function(t){return t}};Fe("svg",{initialise:function(t,e){e||t.model.uid;var n=t.paperElement.select("svg#"+e);return n.size()||(n=t.paperElement.append("svg").attr("id",e).classed(t.visualType,!0).style("position","absolute")),n.node()}}),Fe("div",{initialise:function(t){var e=t.model.uid,n=t.visualParent,r=n.paperElement.select("div#"+e);return r.size()||(r=n.paperElement.append("div").attr("id",e).classed(n.visualType,!0).style("position","absolute")),r.node()},size:function(t){return this.sel.style("width",t.width+"px").style("height",t.height+"px"),this},childGroup:function(t,e){return e||(e="main"),t.selectAll("."+e).data([0]).enter().append("div").classed(e,!0),t.select("."+e)}});Mo.menu={display:!1,height:"8%",maxHeight:50,minHeight:20},Gu.events.on("after-init.menu",function(t){if("visual"===t.visualType){t.getModel("menu").display&&(t.menu=t.sel.insert("nav",":first-child").classed("d3-nav navbar p-1",!0),t.menu.append("h4").classed("title",!0))}}),Gu.events.on("before-draw.menu",function(t){t&&t.menu&&function(t){var e=t.getModel("menu"),n=t.dim(e.height,t.height,e.minHeight,e.maxHeight);t.menu.style("height",n+"px")}(t)});var Is=n(),Bs=n();if(Gu.options.dataContext={$format:function(t,e){var n=Is.get(t);return n||(n=fs(t),Is.set(t,n)),n(e)},$formatTime:function(t,e){var n=Bs.get(t);return n||(n=vo(t),Bs.set(t,n)),n(e)}},qs.getData=function(){var t=this.model.data;return t?this.dataStore.getData(t,{$visual:this}):(qa("Visual "+this.visualType+" without data name, cannot get data"),ti())},qs.getContext=function(t){return this.dataStore.model.$child(t)},Gu.events.on("before-init.data",function(t){t.isViz&&(t.data=ar(t.options,"data"))}),Gu.events.on("after-init.data",function(t){Object.defineProperties(t,{dataStore:{get:function(){return t.model.root.dataStore}}}),t.isViz?function(t){var e=t.dataStore,n=ar(t,"data");n&&(o(n)&&(n={source:n}),n.name||(n.name=t.model.uid),(n=e.addSources(n))?t.model.$set("data",n.name):qa("Could not create data source "+n.name))}(t):function(t){var e=t.dataStore,n=ar(t.options,"data");e||(e=new zt(t.getModel("dataContext")),t.model.root.dataStore=e),e.addSources(n)}(t)}),Gu.options.font={size:"3%",minSize:10,maxSize:20,stroke:"#333",family:null},qs.font=function(t,e){e=e||this.getModel("font");var n=this.getModel(),r=this.dim(e.size,t.height,e.minSize,e.maxSize);return n.fontSizeMultiplier&&(r*=n.fontSizeMultiplier),r},Mo.resizeDelay||(Mo.resizeDelay=200),rr){var Vs=Er(function(){Gu.live.forEach(function(t){return t.resize()})},Mo.resizeDelay);Wr(window).on("resize.visuals",Vs)}Mo.title={text:null,size:"3%",minSize:15,maxSize:25,offset:["10%",0]},Gu.events.on("before-init.title",function(t){var e=t.options.title;o(e)&&(t.options.title={text:e})}),Gu.events.on("after-draw.title",function(t){var e=t.getModel("title"),n=t;if("visual"===n.visualType)delete n.__title;else{if(!t.isViz)return;n=t.visualParent}if(e.text)if(n.menu&&!n.__title)n.__title=e,function(t,e){var n=function(t){return+t.substring(0,t.length-2)}(t.menu.style("height")),r=e.maxSize?Math.min(n-4,e.maxSize):n-4,i=t.dim(e.size,t.width,e.minSize,r);t.menu.select(".title").html(e.text).style("font-size",i+"px").style("line-height",n+"px")}(n,e);else if(t.isViz){var r=t.boundingBox(!0),i=t.getModel("font"),a=e.stroke||i.stroke,o=t.font(r,e),u=t.group().selectAll("text.chartitle").data([e.text]),s=t.dim(e.offset[0],r.vizHeight),c=t.dim(e.offset[1],r.vizWidth),l=t.translate(r.margin.left+r.innerWidth/2+c,s);u.enter().append("text").classed("chartitle",!0).attr("transform",l).style("text-anchor","middle").style("font-size",o).style("fill",a).text(function(t){return t}).merge(u).transition().attr("transform",l).style("font-size",o).style("fill",a).text(function(t){return t})}});var Gs=["top","bottom","left","right"],Ks=["left","right"];Mo.margin={top:20,bottom:20,left:20,right:20},Mo.padding={top:0,bottom:0,left:0,right:0},qs.boundingBox=function(t){if(t&&Ye(this),!this.__boundingBox){var e=this.visualParent.width,n=this.visualParent.height,r=He(this.getModel("padding"),e,n),i=e-r.left-r.right,a=n-r.top-r.bottom,o=He(this.getModel("margin"),i,a),u=Gs.reduce(function(t,e){return t[e]=o[e]+r[e],t},{});this.__boundingBox={margin:o,padding:r,total:u,width:e,height:n,vizWidth:i,vizHeight:a,innerWidth:e-u.left-u.right,innerHeight:n-u.top-u.bottom,$nomargins:function(){return{width:this.innerWidth,height:this.innerHeight,margin:Re(0),padding:Re(0),total:Re(0),innerWidth:this.innerWidth,innerHeight:this.innerHeight,$nomargins:this.$nomargins}}}}return this.__boundingBox},Gu.events.on("after-init.margin",function(t){t.margin=Ue("margin",t),t.padding=Ue("padding",t)}),Gu.events.on("before-draw.margin",function(t){t.isViz&&Ye(t)});var Zs=Array.prototype.slice,Js=function(t){return t},Qs=1,tc=2,ec=3,nc=4,rc=1e-6,ic=n({top:function(t){return qe(Qs,t)},bottom:function(t){return qe(ec,t)},left:function(t){return qe(nc,t)},right:function(t){return qe(tc,t)}}),ac={ticks:5,tickSize:6,tickSizeOuter:null,rotate:null,ancor:"end",format:null,timeFormat:"%Y-%m-%d",stroke:"#333",hide:null,title:null,titleRotate:null,titleOffset:.7};Gu.options.xAxis=er({location:"bottom"},ac),Gu.options.yAxis=er({location:"left"},ac),qs.xAxis1=function(t,e,n,r){var i=this.getModel("xAxis"),a=Xe(t,e,i,r),o=this.group("x-axis");return this.applyTransform(o,this.translateAxis(t,n)),We(o.transition(this.transition("x-axis")).call(a),i,e),i.title&&this.axisTitle(o,t,e,n,i),o},qs.yAxis1=function(t,e,n,r){var i=this.getModel("yAxis"),a=Xe(t,e,i,r),o=this.group("y-axis");return this.applyTransform(o,this.translateAxis(t,n)),We(o.transition(this.transition("x-axis")).call(a),i,e),i.title&&this.axisTitle(o,t,e,n,i),o},qs.axis=function(t,e){return ic.get(t)(e)},qs.axisTitle=function(t,e,n,r,i){var a=t.selectAll("text.title").data([i.title]),o=i.titleRotate||0,u=0,s=0;o||"right"!==e&&"left"!==e||(o=-90),"left"==e&&(u=-i.titleOffset*r.margin.left,s=r.innerHeight/2);var c="translate("+u+","+s+") rotate("+o+")",l=this.font(r);a.enter().append("text").classed("title",!0).attr("transform",c).style("text-anchor","middle").style("font-size",l).style("fill",i.stroke).text(function(t){return t}).merge(a).transition().attr("transform",c).style("font-size",l).style("fill",i.stroke).text(function(t){return t})},qs.translateAxis=function(t,e){return"top"===t||"left"===t?this.translate(e.margin.left,e.margin.top):"bottom"===t?this.translate(e.margin.left,e.margin.top+e.innerHeight):this.translate(e.margin.left+e.innerWidth,e.margin.top)};var oc=Math.PI,uc=2*oc,sc=uc-1e-6;Ie.prototype=Be.prototype={constructor:Ie,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,u=n-t,s=r-e,c=a-t,l=o-e,f=c*c+l*l;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(f>1e-6)if(Math.abs(l*u-s*c)>1e-6&&i){var h=n-a,d=r-o,p=u*u+s*s,g=h*h+d*d,v=Math.sqrt(p),m=Math.sqrt(f),y=i*Math.tan((oc-Math.acos((p+f-g)/(2*v*m)))/2),b=y/m,_=y/v;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*c)+","+(e+b*l)),this._+="A"+i+","+i+",0,0,"+ +(l*h>c*d)+","+(this._x1=t+_*u)+","+(this._y1=e+_*s)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,a){t=+t,e=+e;var o=(n=+n)*Math.cos(r),u=n*Math.sin(r),s=t+o,c=e+u,l=1^a,f=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+s+","+c:(Math.abs(this._x1-s)>1e-6||Math.abs(this._y1-c)>1e-6)&&(this._+="L"+s+","+c),n&&(f<0&&(f=f%uc+uc),f>sc?this._+="A"+n+","+n+",0,1,"+l+","+(t-o)+","+(e-u)+"A"+n+","+n+",0,1,"+l+","+(this._x1=s)+","+(this._y1=c):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=oc)+","+l+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var cc=function(t){return function(){return t}},lc=Math.abs,fc=Math.atan2,hc=Math.cos,dc=Math.max,pc=Math.min,gc=Math.sin,vc=Math.sqrt,mc=1e-12,yc=Math.PI,bc=yc/2,_c=2*yc;Ke.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var xc=function(t){return new Ke(t)},wc=function(){function t(t){var u,s,c,l=t.length,f=!1;for(null==i&&(o=a(c=Be())),u=0;u<=l;++u)!(u<l&&r(s=t[u],u,t))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(s,u,t),+n(s,u,t));if(c)return o=null,c+""||null}var e=Ze,n=Je,r=cc(!0),i=null,a=xc,o=null;return t.x=function(n){return arguments.length?(e="function"==typeof n?n:cc(+n),t):e},t.y=function(e){return arguments.length?(n="function"==typeof e?e:cc(+e),t):n},t.defined=function(e){return arguments.length?(r="function"==typeof e?e:cc(!!e),t):r},t.curve=function(e){return arguments.length?(a=e,null!=i&&(o=a(i)),t):a},t.context=function(e){return arguments.length?(null==e?i=o=null:o=a(i=e),t):i},t},Mc=function(){function t(t){var e,l,f,h,d,p=t.length,g=!1,v=new Array(p),m=new Array(p);for(null==u&&(c=s(d=Be())),e=0;e<=p;++e){if(!(e<p&&o(h=t[e],e,t))===g)if(g=!g)l=e,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),f=e-1;f>=l;--f)c.point(v[f],m[f]);c.lineEnd(),c.areaEnd()}g&&(v[e]=+n(h,e,t),m[e]=+i(h,e,t),c.point(r?+r(h,e,t):v[e],a?+a(h,e,t):m[e]))}if(d)return c=null,d+""||null}function e(){return wc().defined(o).curve(s).context(u)}var n=Ze,r=null,i=cc(0),a=Je,o=cc(!0),u=null,s=xc,c=null;return t.x=function(e){return arguments.length?(n="function"==typeof e?e:cc(+e),r=null,t):n},t.x0=function(e){return arguments.length?(n="function"==typeof e?e:cc(+e),t):n},t.x1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:cc(+e),t):r},t.y=function(e){return arguments.length?(i="function"==typeof e?e:cc(+e),a=null,t):i},t.y0=function(e){return arguments.length?(i="function"==typeof e?e:cc(+e),t):i},t.y1=function(e){return arguments.length?(a=null==e?null:"function"==typeof e?e:cc(+e),t):a},t.lineX0=t.lineY0=function(){return e().x(n).y(i)},t.lineY1=function(){return e().x(n).y(a)},t.lineX1=function(){return e().x(r).y(i)},t.defined=function(e){return arguments.length?(o="function"==typeof e?e:cc(!!e),t):o},t.curve=function(e){return arguments.length?(s=e,null!=u&&(c=s(u)),t):s},t.context=function(e){return arguments.length?(null==e?u=c=null:c=s(u=e),t):u},t},kc=Array.prototype.slice,Ac={draw:function(t,e){var n=Math.sqrt(e/yc);t.moveTo(n,0),t.arc(0,0,n,0,_c)}},Ec=Math.sin(yc/10)/Math.sin(7*yc/10),Tc=Math.sin(_c/10)*Ec,Sc=-Math.cos(_c/10)*Ec,Cc={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=Tc*n,i=Sc*n;t.moveTo(0,-n),t.lineTo(r,i);for(var a=1;a<5;++a){var o=_c*a/5,u=Math.cos(o),s=Math.sin(o);t.lineTo(s*n,-u*n),t.lineTo(u*r-s*i,s*r+u*i)}t.closePath()}},Nc={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},Pc=function(){function t(){var t;if(r||(r=t=Be()),e.apply(this,arguments).draw(r,+n.apply(this,arguments)),t)return r=null,t+""||null}var e=cc(Ac),n=cc(64),r=null;return t.type=function(n){return arguments.length?(e="function"==typeof n?n:cc(n),t):e},t.size=function(e){return arguments.length?(n="function"==typeof e?e:cc(+e),t):n},t.context=function(e){return arguments.length?(r=null==e?null:e,t):r},t},zc=function(){};tn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Qe(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Qe(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};en.prototype={areaStart:zc,areaEnd:zc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Qe(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};nn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Qe(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};rn.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],a=e[0],o=t[n]-i,u=e[n]-a,s=-1;++s<=n;)r=s/n,this._basis.point(this._beta*t[s]+(1-this._beta)*(i+r*o),this._beta*e[s]+(1-this._beta)*(a+r*u));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var Oc=function t(e){function n(t){return 1===e?new tn(t):new rn(t,e)}return n.beta=function(e){return t(+e)},n}(.85);on.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:an(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:an(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Dc=function t(e){function n(t){return new on(t,e)}return n.tension=function(e){return t(+e)},n}(0);un.prototype={areaStart:zc,areaEnd:zc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:an(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var jc=function t(e){function n(t){return new un(t,e)}return n.tension=function(e){return t(+e)},n}(0);sn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:an(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var $c=function t(e){function n(t){return new sn(t,e)}return n.tension=function(e){return t(+e)},n}(0);ln.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:cn(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Lc=function t(e){function n(t){return e?new ln(t,e):new on(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);fn.prototype={areaStart:zc,areaEnd:zc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:cn(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Fc=function t(e){function n(t){return e?new fn(t,e):new un(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);hn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:cn(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Uc=function t(e){function n(t){return e?new hn(t,e):new sn(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);dn.prototype={areaStart:zc,areaEnd:zc,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};yn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:mn(this,this._t0,vn(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,t!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,mn(this,vn(this,n=gn(this,t,e)),n);break;default:mn(this,this._t0,n=gn(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(bn.prototype=Object.create(yn.prototype)).point=function(t,e){yn.prototype.point.call(this,e,t)},_n.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},xn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=wn(t),i=wn(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var Hc=function(t){return new xn(t)},Yc=function(t,e){if((i=t.length)>1)for(var n,r,i,a=1,o=t[e[0]],u=o.length;a<i;++a)for(r=o,o=t[e[a]],n=0;n<u;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]},Rc=function(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n},qc=function(t){var e=t.map(Mn);return Rc(t).sort(function(t,n){return e[t]-e[n]})},Xc=n({circle:Ac,square:Nc,star:Cc}),Wc=n({ascending:qc,descending:function(t){return qc(t).reverse()},insideout:function(t){var e,n,r=t.length,i=t.map(Mn),a=Rc(t).sort(function(t,e){return i[e]-i[t]}),o=0,u=0,s=[],c=[];for(e=0;e<r;++e)n=a[e],o<u?(o+=i[n],s.push(n)):(u+=i[n],c.push(n));return c.reverse().concat(s)},none:Rc,reverse:function(t){return Rc(t).reverse()}}),Ic=n({expand:function(t,e){if((r=t.length)>0){for(var n,r,i,a=0,o=t[0].length;a<o;++a){for(i=n=0;n<r;++n)i+=t[n][a][1]||0;if(i)for(n=0;n<r;++n)t[n][a][1]/=i}Yc(t,e)}},diverging:function(t,e){if((u=t.length)>1)for(var n,r,i,a,o,u,s=0,c=t[e[0]].length;s<c;++s)for(a=o=0,n=0;n<u;++n)(i=(r=t[e[n]][s])[1]-r[0])>=0?(r[0]=a,r[1]=a+=i):i<0?(r[1]=o,r[0]=o+=i):r[0]=a},none:Yc,silhouette:function(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],a=i.length;r<a;++r){for(var o=0,u=0;o<n;++o)u+=t[o][r][1]||0;i[r][1]+=i[r][0]=-u/2}Yc(t,e)}},wiggle:function(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,a=0,o=1;o<r;++o){for(var u=0,s=0,c=0;u<i;++u){for(var l=t[e[u]],f=l[o][1]||0,h=(f-(l[o-1][1]||0))/2,d=0;d<u;++d){var p=t[e[d]];h+=(p[o][1]||0)-(p[o-1][1]||0)}s+=f,c+=h*f}n[o-1][1]+=n[o-1][0]=a,s&&(a-=c/s)}n[o-1][1]+=n[o-1][0]=a,Yc(t,e)}}});qs.getSymbol=function(t){var e=Xc.get(t);return Pc().type(e)},qs.getStack=function(){var t=this.getModel();if(t.stack){var e=function(){function t(t){var a,o,u=e.apply(this,arguments),s=t.length,c=u.length,l=new Array(c);for(a=0;a<c;++a){for(var f,h=u[a],d=l[a]=new Array(s),p=0;p<s;++p)d[p]=f=[0,+i(t[p],h,p,t)],f.data=t[p];d.key=h}for(a=0,o=n(l);a<c;++a)l[o[a]].index=a;return r(l,o),l}var e=cc([]),n=Rc,r=Yc,i=function(t,e){return t[e]};return t.keys=function(n){return arguments.length?(e="function"==typeof n?n:cc(kc.call(n)),t):e},t.value=function(e){return arguments.length?(i="function"==typeof e?e:cc(+e),t):i},t.order=function(e){return arguments.length?(n=null==e?Rc:"function"==typeof e?e:cc(kc.call(e)),t):n},t.offset=function(e){return arguments.length?(r=null==e?Yc:e,t):r},t}();return t.stackOrder&&e.order(Wc.get(t.stackOrder)),t.stackOffset&&e.offset(Ic.get(t.stackOffset)),e}return null};var Bc=n();Mo.color={scale:"cool",scaleMinPoints:6,scaleOffset:0,stroke:"#333",strokeOpacity:1,fillOpacity:1},Bc.set("viridis",function(){return $e(js)}),Bc.set("inferno",function(){return $e(Ls)}),Bc.set("magma",function(){return $e($s)}),Bc.set("plasma",function(){return $e(Fs)}),Bc.set("warm",function(){return $e(Ps)}),Bc.set("cool",function(){return $e(zs)}),Bc.set("rainbow",function(){return $e(Ds)}),Bc.set("cubehelix",function(){return $e(Ns)}),qs.colors=function(t,e){var n=this.getModel("color"),r=!1,i=void 0,o=void 0;if(s(n.scale))o=this.getScale("ordinal").range(n.scale);else{if(!(i=Bc.get(n.scale)))throw new Error("Unknown scale "+n.scale);a(i)||(i={scale:i}),void 0===i.minPoints&&(i.minPoints=n.scaleMinPoints),o=i.scale(),r=i.reversed}if(u(o.interpolator)){var c=n.scaleOffset,l=t+c,f=Math.max(l,i.minPoints),h=r?[f-1,0]:[0,f-1];o.domain(h);var d=void 0;return pa(c,Math.min(l,f)).map(function(t){return d=Ft(o(t)),d.opacity=e,d})}var p=o.range().slice();r&&p.reverse();for(var g=void 0,v=void 0,m=void 0,y=0;y<n.scaleOffset;++y)p.push(p.shift());return pa(t).map(function(){return g=p.shift(),v=Ft(g),m=Ft(g),v.opacity=e,p.push(""+m.brighter(.2)),v})},qs.fill=function(t){function e(t,e){return i[e]}var n=this.getModel("color"),r=this.modelProperty("fillOpacity",n),i=this.colors(t.length,r);return e.colors=i,e},qs.stroke=function(t){function e(t,e){return i[e]}var n=this.getModel("color"),r=this.modelProperty("strokeOpacity",n),i=this.colors(t.length,r);return e.colors=i,e},qs.linearGradient=function(t,e,n,r){var i=this.paper().sel,a=i.select("defs");a.node()||(a=i.append("defs"));var o=a.selectAll("#"+r).data([0]),u=Ft(t);u.opacity=.1,o.enter().append("linearGradient").attr("id",r).attr("x1","0%").attr("y1","0%").attr("x2","vertical"===n?"0%":"100%").attr("y2","vertical"===n?"100%":"0%");var s=a.select("#"+r).selectAll("stop").data([{offset:"0%",color:t},{offset:"100%",color:u}]);return s.enter().append("stop").merge(s).attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color}),"url(#"+r+")"};var Vc="http://www.w3.org/1999/xhtml",Gc={svg:"http://www.w3.org/2000/svg",xhtml:Vc,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Kc=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Gc.hasOwnProperty(e)?{space:Gc[e],local:t}:t},Zc=function(t){var e=Kc(t);return(e.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Vc&&e.documentElement.namespaceURI===Vc?e.createElement(t):e.createElementNS(n,t)}})(e)},Jc=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var Qc=document.documentElement;if(!Qc.matches){var tl=Qc.webkitMatchesSelector||Qc.msMatchesSelector||Qc.mozMatchesSelector||Qc.oMatchesSelector;Jc=function(t){return function(){return tl.call(this,t)}}}}var el=Jc,nl={};if("undefined"!=typeof document){"onmouseenter"in document.documentElement||(nl={mouseenter:"mouseover",mouseleave:"mouseout"})}var rl=function(t){return null==t?function(){}:function(){return this.querySelector(t)}},il=function(t){return new Array(t.length)};An.prototype={constructor:An,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var al="$",ol=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};Sn.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var ul=[null];zn.prototype=function(){return new zn([[document.documentElement]],ul)}.prototype={constructor:zn,select:function(t){"function"!=typeof t&&(t=rl(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o,u=e[i],s=u.length,c=r[i]=new Array(s),l=0;l<s;++l)(a=u[l])&&(o=t.call(a,a.__data__,l,u))&&("__data__"in a&&(o.__data__=a.__data__),c[l]=o);return new zn(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=function(t){return null==t?function(){return[]}:function(){return this.querySelectorAll(t)}}(t));for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o,u=e[a],s=u.length,c=0;c<s;++c)(o=u[c])&&(r.push(t.call(o,o.__data__,c,u)),i.push(o));return new zn(r,i)},filter:function(t){"function"!=typeof t&&(t=el(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],u=o.length,s=r[i]=[],c=0;c<u;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&s.push(a);return new zn(r,this._parents)},data:function(t,e){if(!t)return d=new Array(this.size()),c=-1,this.each(function(t){d[++c]=t}),d;var n=e?function(t,e,n,r,i,a,o){var u,s,c,l={},f=e.length,h=a.length,d=new Array(f);for(u=0;u<f;++u)(s=e[u])&&(d[u]=c=al+o.call(s,s.__data__,u,e),c in l?i[u]=s:l[c]=s);for(u=0;u<h;++u)(s=l[c=al+o.call(t,a[u],u,a)])?(r[u]=s,s.__data__=a[u],l[c]=null):n[u]=new An(t,a[u]);for(u=0;u<f;++u)(s=e[u])&&l[d[u]]===s&&(i[u]=s)}:function(t,e,n,r,i,a){for(var o,u=0,s=e.length,c=a.length;u<c;++u)(o=e[u])?(o.__data__=a[u],r[u]=o):n[u]=new An(t,a[u]);for(;u<s;++u)(o=e[u])&&(i[u]=o)},r=this._parents,i=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var a=i.length,o=new Array(a),u=new Array(a),s=new Array(a),c=0;c<a;++c){var l=r[c],f=i[c],h=f.length,d=t.call(l,l&&l.__data__,c,r),p=d.length,g=u[c]=new Array(p),v=o[c]=new Array(p);n(l,f,g,v,s[c]=new Array(h),d,e);for(var m,y,b=0,_=0;b<p;++b)if(m=g[b]){for(b>=_&&(_=b+1);!(y=v[_])&&++_<p;);m._next=y||null}}return o=new zn(o,r),o._enter=u,o._exit=s,o},enter:function(){return new zn(this._enter||this._groups.map(il),this._parents)},exit:function(){return new zn(this._exit||this._groups.map(il),this._parents)},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),u=0;u<a;++u)for(var s,c=e[u],l=n[u],f=c.length,h=o[u]=new Array(f),d=0;d<f;++d)(s=c[d]||l[d])&&(h[d]=s);for(;u<r;++u)o[u]=e[u];return new zn(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){t||(t=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN});for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i){for(var a,o=e[i],u=o.length,s=r[i]=new Array(u),c=0;c<u;++c)(a=o[c])&&(s[c]=a);s.sort(function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n})}return new zn(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,u=a.length;o<u;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=Kc(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}:function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){var r;return arguments.length>1?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):ol(r=this.node()).getComputedStyle(r,null).getPropertyValue(t)},property:function(t,e){return arguments.length>1?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=En(t+"");if(arguments.length<2){for(var r=Tn(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?Cn:Nn)(this,t)}}:e?function(t){return function(){Cn(this,t)}}:function(t){return function(){Nn(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?function(){this.textContent=""}:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?function(){this.innerHTML=""}:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(function(){this.nextSibling&&this.parentNode.appendChild(this)})},lower:function(){return this.each(function(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)})},append:function(t){var e="function"==typeof t?t:Zc(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:Zc(t),r=null==e?function(){return null}:"function"==typeof e?e:rl(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}),o=a.length;{if(!(arguments.length<2)){for(u=e?function(t,e,n){var r=nl.hasOwnProperty(t.type)?function(t,e,n){return t=kn(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}:kn;return function(i,a,o){var u,s=this.__on,c=r(e,a,o);if(s)for(var l=0,f=s.length;l<f;++l)if((u=s[l]).type===t.type&&u.name===t.name)return this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=c,u.capture=n),void(u.value=e);this.addEventListener(t.type,c,n),u={type:t.type,name:t.name,value:e,listener:c,capture:n},s?s.push(u):this.__on=[u]}}:function(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}},null==n&&(n=!1),r=0;r<o;++r)this.each(u(a[r],e,n));return this}var u=this.node().__on;if(u)for(var s,c=0,l=u.length;c<l;++c)for(r=0,s=u[c];r<o;++r)if((i=a[r]).type===s.type&&i.name===s.name)return s.value}},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return Pn(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return Pn(this,t,e)}})(t,e))}};var sl={value:function(){}};Dn.prototype=On.prototype={constructor:Dn,on:function(t,e){var n,r=this._,i=function(t,e){return t.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}(t+"",r),a=-1,o=i.length;{if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<o;)if(n=(t=i[a]).type)r[n]=jn(r[n],t.name,e);else if(null==e)for(n in r)r[n]=jn(r[n],t.name,null);return this}for(;++a<o;)if((n=(t=i[a]).type)&&(n=function(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}(r[n],t.name)))return n}},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Dn(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};var cl,ll=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},fl=function(t){return 1===t.length&&(t=function(t){return function(e,n){return ll(t(e),n)}}(t)),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)<0?r=a+1:i=a}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)>0?i=a:r=a+1}return r}}}(ll).right,hl=Math.sqrt(50),dl=Math.sqrt(10),pl=Math.sqrt(2),gl=function(t,e,n){var r,i,a,o,u=-1;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=function(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=hl?10:a>=dl?5:a>=pl?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=hl?10:a>=dl?5:a>=pl?2:1)}(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(i=Math.ceil(e-t+1));++u<i;)a[u]=(t+u)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(i=Math.ceil(t-e+1));++u<i;)a[u]=(t-u)/o;return r&&a.reverse(),a},vl=Array.prototype,ml=vl.map,yl=vl.slice,bl=function(t){return function(){return t}},_l=function(t){return+t},xl=[0,1],wl=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},Ml=function(t){return(t=wl(Math.abs(t)))?t[1]:NaN},kl=function(t,e){var n=wl(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},Al={"":function(t,e){t:for(var n,r=(t=t.toPrecision(e)).length,i=1,a=-1;i<r;++i)switch(t[i]){case".":a=n=i;break;case"0":0===a&&(a=i),n=i;break;case"e":break t;default:a>0&&(a=0)}return a>0?t.slice(0,a)+t.slice(n+1):t},"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return kl(100*t,e)},r:kl,s:function(t,e){var n=wl(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(cl=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+wl(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},El=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;Fn.prototype=Un.prototype,Un.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var Tl,Sl,Cl,Nl=function(t){return t},Pl=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],zl=function(t){function e(t){function e(t){var e,r,o,l=v,_=m;if("c"===g)_=y(t)+_,t="";else{var x=(t=+t)<0;if(t=y(Math.abs(t),p),x&&0==+t&&(x=!1),l=(x?"("===c?c:"-":"-"===c||"("===c?"":c)+l,_=_+("s"===g?Pl[8+cl/3]:"")+(x&&"("===c?")":""),b)for(e=-1,r=t.length;++e<r;)if(48>(o=t.charCodeAt(e))||o>57){_=(46===o?i+t.slice(e+1):t.slice(e))+_,t=t.slice(0,e);break}}d&&!f&&(t=n(t,1/0));var w=l.length+t.length+_.length,M=w<h?new Array(h-w+1).join(u):"";switch(d&&f&&(t=n(M+t,M.length?h-_.length:1/0),M=""),s){case"<":t=l+t+_+M;break;case"=":t=l+M+t+_;break;case"^":t=M.slice(0,w=M.length>>1)+l+t+_+M.slice(w);break;default:t=M+l+t+_}return a(t)}var u=(t=Fn(t)).fill,s=t.align,c=t.sign,l=t.symbol,f=t.zero,h=t.width,d=t.comma,p=t.precision,g=t.type,v="$"===l?r[0]:"#"===l&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",m="$"===l?r[1]:/[%p]/.test(g)?o:"",y=Al[g],b=!g||/[defgprs%]/.test(g);return p=null==p?g?6:12:/[gprs]/.test(g)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p)),e.toString=function(){return t+""},e}var n=t.grouping&&t.thousands?function(t,e){return function(n,r){for(var i=n.length,a=[],o=0,u=t[0],s=0;i>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),a.push(n.substring(i-=u,i+u)),!((s+=u+1)>r));)u=t[o=(o+1)%t.length];return a.reverse().join(e)}}(t.grouping,t.thousands):Nl,r=t.currency,i=t.decimal,a=t.numerals?function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(t.numerals):Nl,o=t.percent||"%";return{format:e,formatPrefix:function(t,n){var r=e((t=Fn(t),t.type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Ml(n)/3))),a=Math.pow(10,-i),o=Pl[8+i/3];return function(t){return r(a*t)+o}}}};!function(t){Tl=zl(t),Sl=Tl.format,Cl=Tl.formatPrefix}({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var Ol=function(t,e,n){var r,i=t[0],a=t[t.length-1],o=$n(i,a,null==e?10:e);switch((n=Fn(null==n?",f":n)).type){case"s":var u=Math.max(Math.abs(i),Math.abs(a));return null!=n.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ml(e)/3)))-Ml(Math.abs(t)))}(o,u))||(n.precision=r),Cl(n,u);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Ml(e)-Ml(t))+1}(o,Math.max(Math.abs(i),Math.abs(a))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=function(t){return Math.max(0,-Ml(Math.abs(t)))}(o))||(n.precision=r-2*("%"===n.type))}return Sl(n)},Dl=function(t){return t.match(/.{6}/g).map(function(t){return"#"+t})};Dl("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Dl("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),Dl("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),Dl("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),Fu(te(300,.5,0),te(-240,.5,1));Fu(te(-100,.75,.35),te(80,1.5,.8)),Fu(te(260,.75,.35),te(80,1.5,.8)),te();Yn(Dl("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));Yn(Dl("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Yn(Dl("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Yn(Dl("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));var jl,$l=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},Ll=function(t){return(t=$l(Math.abs(t)))?t[1]:NaN},Fl=function(t,e){var n=$l(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},Ul={"":function(t,e){t:for(var n,r=(t=t.toPrecision(e)).length,i=1,a=-1;i<r;++i)switch(t[i]){case".":a=n=i;break;case"0":0===a&&(a=i),n=i;break;case"e":break t;default:a>0&&(a=0)}return a>0?t.slice(0,a)+t.slice(n+1):t},"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Fl(100*t,e)},r:Fl,s:function(t,e){var n=$l(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(jl=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+$l(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Hl=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i,Yl=function(t){return new Rn(t)};Rn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var Rl,ql,Xl=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],Wl=function(t){function e(t){function e(t){var e,r,s,y=p,b=g;if("c"===d)b=v(t)+b,t="";else{var _=((t=+t)<0||1/t<0)&&(t*=-1,!0);if(t=v(t,h),_)for(e=-1,r=t.length,_=!1;++e<r;)if(48<(s=t.charCodeAt(e))&&s<58||"x"===d&&96<s&&s<103||"X"===d&&64<s&&s<71){_=!0;break}if(y=(_?"("===u?u:"-":"-"===u||"("===u?"":u)+y,b=b+("s"===d?Xl[8+jl/3]:"")+(_&&"("===u?")":""),m)for(e=-1,r=t.length;++e<r;)if(48>(s=t.charCodeAt(e))||s>57){b=(46===s?i+t.slice(e+1):t.slice(e))+b,t=t.slice(0,e);break}}f&&!c&&(t=n(t,1/0));var x=y.length+t.length+b.length,w=x<l?new Array(l-x+1).join(a):"";switch(f&&c&&(t=n(w+t,w.length?l-b.length:1/0),w=""),o){case"<":return y+t+b+w;case"=":return y+w+t+b;case"^":return w.slice(0,x=w.length>>1)+y+t+b+w.slice(x)}return w+y+t+b}var a=(t=Yl(t)).fill,o=t.align,u=t.sign,s=t.symbol,c=t.zero,l=t.width,f=t.comma,h=t.precision,d=t.type,p="$"===s?r[0]:"#"===s&&/[boxX]/.test(d)?"0"+d.toLowerCase():"",g="$"===s?r[1]:/[%p]/.test(d)?"%":"",v=Ul[d],m=!d||/[defgprs%]/.test(d);return h=null==h?d?6:12:/[gprs]/.test(d)?Math.max(1,Math.min(21,h)):Math.max(0,Math.min(20,h)),e.toString=function(){return t+""},e}var n=t.grouping&&t.thousands?function(t,e){return function(n,r){for(var i=n.length,a=[],o=0,u=t[0],s=0;i>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),a.push(n.substring(i-=u,i+u)),!((s+=u+1)>r));)u=t[o=(o+1)%t.length];return a.reverse().join(e)}}(t.grouping,t.thousands):function(t){return t},r=t.currency,i=t.decimal;return{format:e,formatPrefix:function(t,n){var r=e((t=Yl(t),t.type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Ll(n)/3))),a=Math.pow(10,-i),o=Xl[8+i/3];return function(t){return r(a*t)+o}}}};!function(t){Rl=Wl(t),ql=Rl.format}({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var Il=function(t,e){var n,r,i=-1,a=t.length;if(null==e){for(;++i<a;)if(null!=(r=t[i])&&r>=r){n=r;break}for(;++i<a;)null!=(r=t[i])&&r>n&&(n=r)}else{for(;++i<a;)if(null!=(r=e(t[i],i,t))&&r>=r){n=r;break}for(;++i<a;)null!=(r=e(t[i],i,t))&&r>n&&(n=r)}return n},Bl=function(t,e){var n,r=0,i=t.length,a=-1;if(null==e)for(;++a<i;)(n=+t[a])&&(r+=n);else for(;++a<i;)(n=+e(t[a],a,t))&&(r+=n);return r},Vl="function"==typeof Symbol&&"symbol"===gr(Symbol.iterator)?function(t){return void 0===t?"undefined":gr(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":gr(t)},Gl=function(t){return t},Kl=function(t){for(var e=[],n=0,r=t.length;n<r;n++)e[n]=t[r-n-1];return e},Zl=function(t,e){t.each(function(){for(var t,n=function(t){return"string"==typeof t?new zn([[document.querySelector(t)]],[document.documentElement]):new zn([[t]],ul)}(this),r=n.text().split(/\s+/).reverse(),i=[],a=(n.attr("y"),parseFloat(n.attr("dy"))||0),o=n.text(null).append("tspan").attr("x",0).attr("dy",a+"em");t=r.pop();)i.push(t),o.text(i.join(" ")),o.node().getComputedTextLength()>e&&i.length>1&&(i.pop(),o.text(i.join(" ")),i=[t],o=n.append("tspan").attr("x",0).attr("dy",1.2+a+"em").text(t))})},Jl={d3_drawShapes:function(t,e,n,r,i,a){"rect"===t?e.attr("height",n).attr("width",r):"circle"===t?e.attr("r",i):"line"===t?e.attr("x1",0).attr("x2",r).attr("y1",0).attr("y2",0):"path"===t&&e.attr("d",a)},d3_addText:function(t,e,n,r,i){e.append("text").attr("class",r+"label");var a=t.selectAll("g."+r+"cell text."+r+"label").data(n).text(Gl);return i&&t.selectAll("g."+r+"cell text."+r+"label").call(Zl,i),a},d3_calcType:function(t,e,n,r,i,a){var o=t.invertExtent?function(t,e,n){var r=t.range().map(function(r){var i=t.invertExtent(r);return e(i[0])+" "+n+" "+e(i[1])});return{data:t.range(),labels:r,feature:Gl}}(t,i,a):t.ticks?function(t,e,n){var r=[];if(e.length>1)r=e;else for(var i=t.domain(),a=(i[i.length-1]-i[0])/(e-1),o=0;o<e;o++)r.push(i[0]+o*a);return{data:r,labels:r.map(n),feature:function(e){return t(e)}}}(t,n,i):function(t){return{data:t.domain(),labels:t.domain(),feature:function(e){return t(e)}}}(t),u=t.range&&t.range()||t.domain();return o.labels=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1],n=arguments[2],r=arguments[3];if("object"===(void 0===e?"undefined":Vl(e))){if(0===e.length)return t;for(var i=e.length;i<t.length;i++)e.push(t[i]);return e}if("function"==typeof e){for(var a=[],o=t.length,u=0;u<o;u++)a.push(e({i:u,genLength:o,generatedLabels:t,domain:n,range:r}));return a}return t}(o.labels,r,t.domain(),u),e&&(o.labels=Kl(o.labels),o.data=Kl(o.data)),o},d3_filterCells:function(t,e){var n=t.data.map(function(e,n){return{data:e,label:t.labels[n]}}).filter(e),r=n.map(function(t){return t.data}),i=n.map(function(t){return t.label});return t.data=t.data.filter(function(t){return-1!==r.indexOf(t)}),t.labels=t.labels.filter(function(t){return-1!==i.indexOf(t)}),t},d3_placement:function(t,e,n,r,i,a){e.attr("transform",n),r.attr("transform",i),"horizontal"===t&&r.style("text-anchor",a)},d3_addEvents:function(t,e){t.on("mouseover.legend",function(t){!function(t,e,n){t.call("cellover",n,e)}(e,t,this)}).on("mouseout.legend",function(t){!function(t,e,n){t.call("cellout",n,e)}(e,t,this)}).on("click.legend",function(t){!function(t,e,n){t.call("cellclick",n,e)}(e,t,this)})},d3_title:function(t,e,n,r){if(""!==e){t.selectAll("text."+n+"legendTitle").data([e]).enter().append("text").attr("class",n+"legendTitle"),t.selectAll("text."+n+"legendTitle").text(e),r&&t.selectAll("text."+n+"legendTitle").call(Zl,r);var i=t.select("."+n+"legendCells"),a=t.select("."+n+"legendTitle").nodes().map(function(t){return t.getBBox().height})[0],o=-i.nodes().map(function(t){return t.getBBox().x})[0];i.attr("transform","translate("+o+","+a+")")}}};Mo.legend={location:"top-right",orient:"vertical",fontSize:"3%",title:"",titleWidth:"20%",labelFormat:null,titleMinWidth:30,titleMaxWidth:60,minFontSize:10,maxFontSize:20,offset:[10,10],shapeWidth:15,shapeHeight:15,hide:300};var Ql={color:function(){function t(t){var M=Jl.d3_calcType(e,b,u,c,d,v);t.selectAll("g").data([e]).enter().append("g").attr("class",l+"legendCells"),s&&Jl.d3_filterCells(M,s);var k=t.select("."+l+"legendCells").selectAll("."+l+"cell").data(M.data),A=k.enter().append("g").attr("class",l+"cell");A.append(n).attr("class",l+"swatch");var E=t.selectAll("g."+l+"cell "+n);Jl.d3_addEvents(A,w),k.exit().transition().style("opacity",0).remove(),Jl.d3_drawShapes(n,E,i,r,a,_),Jl.d3_addText(t,A,M.labels,l,m);var T=(k=A.merge(k)).selectAll("text"),S=T.nodes().map(function(t){return t.getBBox()}),C=E.nodes().map(function(t){return t.getBBox()});f?E.attr("class",function(t){return l+"swatch "+M.feature(t)}):"line"==n?E.style("stroke",M.feature):E.style("fill",M.feature);var N=void 0,P=void 0,z="start"==g?0:"middle"==g?.5:1;"vertical"===y?function(){var t=S.map(function(t,e){return Math.max(t.height,C[e].height)});N=function(e,n){return"translate(0, "+(Bl(t.slice(0,n))+n*o)+")"},P=function(t,e){return"translate( "+(C[e].width+C[e].x+p)+", "+(C[e].y+C[e].height/2+5)+")"}}():"horizontal"===y&&(N=function(t,e){return"translate("+e*(C[e].width+o)+",0)"},P=function(t,e){return"translate("+(C[e].width*z+C[e].x)+",\n          "+(C[e].height+C[e].y+p+8)+")"}),Jl.d3_placement(y,k,N,T,P,g),Jl.d3_title(t,h,l,x),k.transition().style("opacity",1)}var e=Hn(),n="rect",r=15,i=15,a=10,o=2,u=[5],s=void 0,c=[],l="",f=!1,h="",d=ql(".01f"),p=10,g="middle",v="to",m=void 0,y="vertical",b=!1,_=void 0,x=void 0,w=On("cellover","cellout","cellclick");return t.scale=function(n){return arguments.length?(e=n,t):e},t.cells=function(e){return arguments.length?((e.length>1||e>=2)&&(u=e),t):u},t.cellFilter=function(e){return arguments.length?(s=e,t):s},t.shape=function(e,r){return arguments.length?(("rect"==e||"circle"==e||"line"==e||"path"==e&&"string"==typeof r)&&(n=e,_=r),t):n},t.shapeWidth=function(e){return arguments.length?(r=+e,t):r},t.shapeHeight=function(e){return arguments.length?(i=+e,t):i},t.shapeRadius=function(e){return arguments.length?(a=+e,t):a},t.shapePadding=function(e){return arguments.length?(o=+e,t):o},t.labels=function(e){return arguments.length?(c=e,t):c},t.labelAlign=function(e){return arguments.length?("start"!=e&&"end"!=e&&"middle"!=e||(g=e),t):g},t.labelFormat=function(e){return arguments.length?(d="string"==typeof e?ql(e):e,t):d},t.labelOffset=function(e){return arguments.length?(p=+e,t):p},t.labelDelimiter=function(e){return arguments.length?(v=e,t):v},t.labelWrap=function(e){return arguments.length?(m=e,t):m},t.useClass=function(e){return arguments.length?(!0!==e&&!1!==e||(f=e),t):f},t.orient=function(e){return arguments.length?("horizontal"!=(e=e.toLowerCase())&&"vertical"!=e||(y=e),t):y},t.ascending=function(e){return arguments.length?(b=!!e,t):b},t.classPrefix=function(e){return arguments.length?(l=e,t):l},t.title=function(e){return arguments.length?(h=e,t):h},t.titleWidth=function(e){return arguments.length?(x=e,t):x},t.textWrap=function(e){return arguments.length?(textWrap=e,t):textWrap},t.on=function(){var e=w.on.apply(w,arguments);return e===w?t:e},t},size:function(){function t(t){var _=Jl.d3_calcType(e,v,a,u,l,d),x=t.selectAll("g").data([e]);o&&Jl.d3_filterCells(_,o),x.enter().append("g").attr("class",s+"legendCells");var w=t.select("."+s+"legendCells").selectAll("."+s+"cell").data(_.data),M=w.enter().append("g").attr("class",s+"cell");M.append(n).attr("class",s+"swatch");var k=t.selectAll("g."+s+"cell "+n);Jl.d3_addEvents(M,b),w.exit().transition().style("opacity",0).remove(),"line"===n?(Jl.d3_drawShapes(n,k,0,r),k.attr("stroke-width",_.feature)):Jl.d3_drawShapes(n,k,_.feature,_.feature,_.feature,m);var A=Jl.d3_addText(t,M,_.labels,s,p);w=M.merge(w);var E=A.nodes().map(function(t){return t.getBBox()}),T=k.nodes().map(function(t,r){var i=t.getBBox(),a=e(_.data[r]);return"line"===n&&"horizontal"===g?i.height=i.height+a:"line"===n&&"vertical"===g&&(i.width=i.width),i}),S=Il(T,function(t){return t.height+t.y}),C=Il(T,function(t){return t.width+t.x}),N=void 0,P=void 0,z="start"==h?0:"middle"==h?.5:1;"vertical"===g?function(){var t=E.map(function(t,e){return Math.max(t.height,T[e].height)}),e="circle"==n||"line"==n?T[0].height/2:0;N=function(n,r){var a=Bl(t.slice(0,r));return"translate(0, "+(e+a+r*i)+")"},P=function(t,e){return"translate( "+(C+f)+",\n          "+(T[e].y+T[e].height/2+5)+")"}}():"horizontal"===g&&(N=function(t,e){return"translate("+(Bl(T.slice(0,e),function(t){return t.width})+e*i)+", "+("circle"==n||"line"==n?S/2:0)+")"},P=function(t,e){return"translate( "+(T[e].width*z+T[e].x)+",\n              "+(S+f)+")"}),Jl.d3_placement(g,w,N,A,P,h),Jl.d3_title(t,c,s,y),w.transition().style("opacity",1)}var e=Hn(),n="rect",r=15,i=2,a=[5],o=void 0,u=[],s="",c="",l=ql(".01f"),f=10,h="middle",d="to",p=void 0,g="vertical",v=!1,m=void 0,y=void 0,b=On("cellover","cellout","cellclick");return t.scale=function(n){return arguments.length?(e=n,t):e},t.cells=function(e){return arguments.length?((e.length>1||e>=2)&&(a=e),t):a},t.cellFilter=function(e){return arguments.length?(o=e,t):o},t.shape=function(e,r){return arguments.length?("rect"!=e&&"circle"!=e&&"line"!=e||(n=e,m=r),t):n},t.shapeWidth=function(e){return arguments.length?(r=+e,t):r},t.shapePadding=function(e){return arguments.length?(i=+e,t):i},t.labels=function(e){return arguments.length?(u=e,t):u},t.labelAlign=function(e){return arguments.length?("start"!=e&&"end"!=e&&"middle"!=e||(h=e),t):h},t.labelFormat=function(e){return arguments.length?(l="string"==typeof e?ql(e):e,t):l},t.labelOffset=function(e){return arguments.length?(f=+e,t):f},t.labelDelimiter=function(e){return arguments.length?(d=e,t):d},t.labelWrap=function(e){return arguments.length?(p=e,t):p},t.orient=function(e){return arguments.length?("horizontal"!=(e=e.toLowerCase())&&"vertical"!=e||(g=e),t):g},t.ascending=function(e){return arguments.length?(v=!!e,t):v},t.classPrefix=function(e){return arguments.length?(s=e,t):s},t.title=function(e){return arguments.length?(c=e,t):c},t.titleWidth=function(e){return arguments.length?(y=e,t):y},t.on=function(){var e=b.on.apply(b,arguments);return e===b?t:e},t},symbol:function(){function t(t){var x=Jl.d3_calcType(e,y,u,c,h,g),w=t.selectAll("g").data([e]);s&&Jl.d3_filterCells(x,s),w.enter().append("g").attr("class",l+"legendCells");var M=t.select("."+l+"legendCells").selectAll("."+l+"cell").data(x.data),k=M.enter().append("g").attr("class",l+"cell");k.append(n).attr("class",l+"swatch");var A=t.selectAll("g."+l+"cell "+n);Jl.d3_addEvents(k,_),M.exit().transition().style("opacity",0).remove(),Jl.d3_drawShapes(n,A,i,r,a,x.feature),Jl.d3_addText(t,k,x.labels,l,v);var E=(M=k.merge(M)).selectAll("text"),T=E.nodes().map(function(t){return t.getBBox()}),S=A.nodes().map(function(t){return t.getBBox()}),C=Il(S,function(t){return t.height}),N=Il(S,function(t){return t.width}),P=void 0,z=void 0,O="start"==d?0:"middle"==d?.5:1;"vertical"===m?function(){var t=T.map(function(t,e){return Math.max(C,t.height)});P=function(e,n){return"translate(0, "+(Bl(t.slice(0,n))+n*o)+" )"},z=function(t,e){return"translate( "+(N+p)+",\n              "+(S[e].y+S[e].height/2+5)+")"}}():"horizontal"===m&&(P=function(t,e){return"translate( "+e*(N+o)+",0)"},z=function(t,e){return"translate( "+(S[e].width*O+S[e].x)+",\n              "+(C+p)+")"}),Jl.d3_placement(m,M,P,E,z,d),Jl.d3_title(t,f,l,b),M.transition().style("opacity",1)}var e=Hn(),n="path",r=15,i=15,a=10,o=5,u=[5],s=void 0,c=[],l="",f="",h=ql(".01f"),d="middle",p=10,g="to",v=void 0,m="vertical",y=!1,b=void 0,_=On("cellover","cellout","cellclick");return t.scale=function(n){return arguments.length?(e=n,t):e},t.cells=function(e){return arguments.length?((e.length>1||e>=2)&&(u=e),t):u},t.cellFilter=function(e){return arguments.length?(s=e,t):s},t.shapePadding=function(e){return arguments.length?(o=+e,t):o},t.labels=function(e){return arguments.length?(c=e,t):c},t.labelAlign=function(e){return arguments.length?("start"!=e&&"end"!=e&&"middle"!=e||(d=e),t):d},t.labelFormat=function(e){return arguments.length?(h="string"==typeof e?ql(e):e,t):h},t.labelOffset=function(e){return arguments.length?(p=+e,t):p},t.labelDelimiter=function(e){return arguments.length?(g=e,t):g},t.labelWrap=function(e){return arguments.length?(v=e,t):v},t.orient=function(e){return arguments.length?("horizontal"!=(e=e.toLowerCase())&&"vertical"!=e||(m=e),t):m},t.ascending=function(e){return arguments.length?(y=!!e,t):y},t.classPrefix=function(e){return arguments.length?(l=e,t):l},t.title=function(e){return arguments.length?(f=e,t):f},t.titleWidth=function(e){return arguments.length?(b=e,t):b},t.on=function(){var e=_.on.apply(_,arguments);return e===_?t:e},t}};qs.legend=function(t,e){var n=this.getModel(),r=this.getModel("legend"),i=this.getModel("font"),a=ar(t,"type")||n.legendType,o=Math.max(e.vizHeight,e.vizWidth),u=this.dim(r.fontSize,o,r.minFontSize,r.maxFontSize),s=Ql[a];if(r.location){if(!s)return qa("Could not load legend "+a);if(s=s().orient(r.orient),r.title&&(s.title(r.title),r.titleWidth)){var c=this.dim(r.titleWidth,o,r.titleMinWidth,r.titleMaxWidth);s.titleWidth(c)}r.labelFormat&&s.labelFormat(r.labelFormat),s.shapeWidth(r.shapeWidth).shapeHeight(r.shapeHeight);for(var l in t)s[l](t[l]);var f=this.group("legend").style("font-size",u+"px").html("").call(s),h=f.node().getBBox(),d=tf.get(r.location).call(this,h,e,r),p=this.translate(d.x,d.y);f.selectAll("text").style("fill",r.stroke||i.stroke),this.applyTransform(f,p),r.hide&&(o<r.hide?f.style("opacity",0):f.style("opacity",1))}};var tf=n({top:function(t,e,n){var r=this.dim(n.offset[1],e.vizHeight);return{x:e.margin.left+(e.innerWidth-t.width)/2,y:r}},bottom:function(t,e,n){var r=this.dim(n.offset[1],e.vizHeight);return{x:e.margin.left+(e.innerWidth-t.width)/2,y:e.vizHeight-t.height-r}},right:function(t,e,n){var r=this.dim(n.offset[0],e.vizWidth);return{x:e.vizWidth-t.width-r,y:e.margin.top+(e.innerHeight-t.height)/2}},left:function(t,e,n){var r=this.dim(n.offset[0],e.vizWidth);return{x:e.margin.left-r,y:e.margin.top+(e.innerHeight-t.height)/2}},"top-left":function(t,e,n){var r=this.dim(n.offset[0],e.vizWidth),i=this.dim(n.offset[1],e.vizHeight);return{x:e.margin.left+(e.innerWidth-t.width)/2+r,y:i}},"top-right":function(t,e,n){var r=this.dim(n.offset[0],e.vizWidth),i=this.dim(n.offset[1],e.vizHeight);return{x:e.vizWidth-t.width-r,y:i}},"bottom-left":function(t,e,n){var r=this.dim(n.offset[0],e.vizWidth),i=this.dim(n.offset[1],e.vizHeight);return{x:t.width+r,y:e.vizHeight-t.height-i}},"bottom-right":function(t,e,n){var r=this.dim(n.offset[0],e.vizWidth),i=this.dim(n.offset[1],e.vizHeight);return{x:e.vizWidth-t.width-r,y:e.vizHeight-t.height-i}}}),ef=function(t){return function(){return t}},nf=function(t){return u(t)?t:ef(t)},rf=function(t){return t},af=n({darker:function(){function t(t,e){var n=t.getModel("mouse"),r=Ft(e.style("fill")),i=r.darker(n.darkerFactor);e.node().__mouse_over__.fill=r,e.style("fill",i)}return t.out=function(t,e){var n=e.node().__mouse_over__.fill;n&&e.style("fill",n)},t}(),fill:function(){function t(t,e){var n=t.getModel("mouse"),r=Ft(e.style("fill"));e.node().__mouse_over__.fill=r,e.transition().style("fill",n.fillColor)}return t.out=function(t,e){var n=e.node().__mouse_over__.fill;n&&e.transition().style("fill",n)},t}()});Gu.options.mouse={over:["darker"],darkerFactor:.5,fillColor:"#addd8e"},qs.mouseOver=function(){var t=this,e=this.getModel("mouse");return function(n,r){this.__mouse_over__||(this.__mouse_over__={});var i=t.select(this),a=void 0;e.over.forEach(function(e){(a=af.get(e))?a(t,i,n,r):qa("Unknown mouse strategy "+e)})}},qs.mouseOut=function(){var t=this,e=this.getModel("mouse");return function(n,r){this.__mouse_over__||(this.__mouse_over__={});var i=t.select(this),a=void 0;e.over.forEach(function(e){(a=af.get(e))?a.out(t,i,n,r):qa("Unknown mouse strategy "+e)})}},Gu.options.tooltip={location:"top",offset:[10,10],html:""},qs.tooltip=rr?function(){function t(){return null===u&&(u=Wr(document.body).append("div").classed("d3-tooltip",!0).style("position","absolute").style("top",0).style("opacity",0).style("pointer-events","none").style("box-sizing","border-box").node(),s=Wr(document.body).append("svg").style("opacity",0).style("pointer-events","none").node().createSVGPoint()),Wr(u)}function e(){}function r(t){for(;null==t.getScreenCTM&&null==t.parentNode;)t=t.parentNode;var e={},n=t.getScreenCTM(),r=t.getBBox(),i=r.width,a=r.height,o=r.x,u=r.y;return s.x=o,s.y=u,e.nw=s.matrixTransform(n),s.x+=i,e.ne=s.matrixTransform(n),s.y+=a,e.se=s.matrixTransform(n),s.x-=i,e.sw=s.matrixTransform(n),s.y-=a/2,e.w=s.matrixTransform(n),s.x+=i,e.e=s.matrixTransform(n),s.x-=i/2,s.y-=a/2,e.n=s.matrixTransform(n),s.y+=a,e.s=s.matrixTransform(n),e}var i=nf("top"),a=nf([0,0]),o=nf(" "),u=null,s=null,c=n({top:function(t,e){var n=r(t);return{left:n.n.x-u.offsetWidth/2,top:n.n.y-u.offsetHeight-e[1]}},bottom:function(t,e,n){return{top:e.total.left+(e.innerWidth-t.width)/2,left:e.height-t.height-n.offsetY}},right:function(t,e){var n=r(t);return{left:n.e.x+e[0],top:n.e.y-u.offsetHeight/2}},left:function(t,e,n){return{x:e.total.left+(e.innerWidth-t.width)/2,y:n.offsetY}},"top-left":function(t,e,n){return{x:e.total.left+(e.innerWidth-t.width)/2,y:n.offsetY}},"top-right":function(t,e,n){return{x:e.width-t.width-n.offsetX,y:n.offsetY}},"bottom-left":function(t,e,n){return{x:e.total.left+(e.innerWidth-t.width)/2,y:e.height-t.height-n.offsetY}},"bottom-right":function(t,e,n){return{x:e.total.left+(e.innerWidth-t.width)/2,y:e.height-t.height-n.offsetY}}}),l=c.keys();return e.show=function(n){var r,u=Array.prototype.slice.call(arguments),s=t(),f=o.apply(this,u)||"",h=a.apply(this,u),d=i.apply(this,u),p=document.documentElement.scrollTop||document.body.scrollTop,g=document.documentElement.scrollLeft||document.body.scrollLeft;s.html(f).style("opacity",1).style("pointer-events","all");for(var v=l.length;v--;)s.classed(l[v],!1);return r=c.get(d).call(this,n,h),s.classed(d,!0).style("top",r.top+p+"px").style("left",r.left+g+"px"),e},e.hide=function(){return t().style("opacity",0).style("pointer-events","none"),e},e.location=function(t){return arguments.length?(i=null===t?t:nf(t),e):i},e.html=function(t){return arguments.length?(o=null===t?t:nf(t),e):o},e.offset=function(t){return arguments.length?(a=null==t?t:nf(t),e):a},e}():rf,af.set("tooltip",function(){function t(t,e,n,r){var i=t.tooltipHtml(e,n,r);if(i){var a=t.getModel("tooltip");t.tooltip.location(a.location).offset(a.offset).html(i).show(e.node())}}return t.out=function(t){t.tooltip.hide()},t}()),qs.tooltipHtml=function(t,e,n){var r=this.getModel("tooltip");if(r.html)return this.dataStore.eval(r.html,{d:e,index:n,model:this.getModel()})},Gu.options.expand={location:"top-right",expandText:"expand",collapseText:"collapse",height:15,width:15,radius:3,offset:[0,0],stroke:"#adadad",fill:"#fff",fillOver:"#e6e6e6",textColor:"#111"},Gu.events.on("after-draw.expand",function(t){function e(){t.select(this).select("rect.button").attr("fill",r.fill)}var n=t.visualParent;if(t.isViz&&!(n.layers.length<=1)){var r=t.getModel("expand");if(t.__expanded||r.location&&function(t){return t.left||t.right||t.top||t.bottom}(t.getModel("padding"))){var i=t.getModel("font"),a=t.boundingBox(),o=t.group("expand"),u=o.node(),s=Math.floor(.8*Math.min(r.width,r.height)),c=t.__expanded?r.collapseText:r.expandText,l=!1;o.select("rect").size()||(l=!0,o.attr("cursor","pointer").on("mouseover",function(){t.select(this).select("rect.button").attr("fill",r.fillOver)}).on("mouseout",e),o.append("rect").classed("button",!0).attr("x",0).attr("y",0).attr("rx",r.radius).attr("ry",r.radius).attr("width",r.width).attr("height",r.height).attr("stroke",r.stroke).attr("fill",r.fill).attr("cursor","pointer"),o.append("text").attr("x",r.width/2).attr("y",r.height/2).attr("fill",r.textColor).attr("font-family",r.fontFamily||i.family).attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",s),o.append("rect").classed("placeholder",!0).attr("x",0).attr("y",0).attr("rx",r.radius).attr("ry",r.radius).attr("width",r.width).attr("height",r.height).attr("stroke","none").attr("fill","transparent").on("click",function(){var r=t.getModel("padding");if(e.call(this),t.__expanded){var i=t.__expanded.padding;delete t.__expanded,n.activate(),Gs.forEach(function(t){i[t]&&(r[t]=i[t])})}else t.__expanded={padding:Gs.reduce(function(t,e){return r[e]&&(t[e]=r[e],r[e]=0),t},{})},n.deactivate(),t.activate();n.redraw(!1)})),o.select("text").text(function(){return c});var f=tf.get(r.location).call(t,u.getBBox(),a,r);l||(o=o.transition(t.transition("expand"))),o.attr("transform",t.translate(f.x,f.y))}}}),Gu.options.transition={duration:250,delay:0,ease:null},qs.transition=function(t){var e=this.idname(t),n=this.getModel("transition");return se(e).duration(n.duration)},qs.applyTransform=function(t,e){t.attr("transform")||t.attr("transform",e),t.transition().attr("transform",e)};var of=function(){$r.preventDefault(),$r.stopImmediatePropagation()},uf=function(t){var e=t.document.documentElement,n=Wr(t).on("dragstart.drag",of,!0);"onselectstart"in e?n.on("selectstart.drag",of,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};(function(t,e,n,r,i,a,o,u,s,c){this.target=t,this.type=e,this.subject=n,this.identifier=r,this.active=i,this.x=a,this.y=o,this.dx=u,this.dy=s,this._=c}).prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var sf=function(t){return function(){return t}},cf=function(t,e,n){this.target=t,this.type=e,this.selection=n},lf=function(){$r.preventDefault(),$r.stopImmediatePropagation()},ff={name:"drag"},hf={name:"space"},df={name:"handle"},pf={name:"center"},gf={name:"x",handles:["e","w"].map(Xn),input:function(t,e){return t&&[[t[0],e[0][1]],[t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},vf={name:"y",handles:["n","s"].map(Xn),input:function(t,e){return t&&[[e[0][0],t[0]],[e[1][0],t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},mf={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(Xn),input:function(t){return t},output:function(t){return t}},yf={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},bf={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},_f={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},xf={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},wf={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};qs.brushX=function(){return Bn(gf)},qs.brushY=function(){return Bn(vf)},qs.brush=function(){return Bn(mf)};var Mf=Zu("container",{initialise:function(){this.live=[],this.visualParent&&this.visualParent.live.push(this)},draw:function(t){if(this.drawing)return qa(this.toString()+" already drawing"),this.drawing;var e=this;return Gu.events.call("before-draw",void 0,e),Promise.all(this.live.map(function(e){return e.redraw(t)})).then(function(){delete e.drawing,Gu.events.call("after-draw",void 0,e)})},destroy:function(){this.pop(this.visualParent)}}),kf={props:["schema","datasource","plugins","options"],render:function(t,e,n){var r=this,i=this.select(n).html();return this.getSchema(t.schema,function(n){return a(n)||(n={}),n=er({},t.options,n),r.build(n,i,e)})},getSchema:function(t,e){var n=this.model.visual;if(n&&n!==this.model&&o(t)){var r=n.getVisualSchema(t);r&&(t=r)}return o(t)?this.json(t).then(e).catch(function(e){qa("Could not reach "+t+": "+e,e)}):e(t)},build:function(){}},Af=er({},kf,{build:function(t,e,n){var r=this.model,i=this.createElement("div"),a=r.root;return n.class&&i.attr("class",n.class),t.visuals||(t.visuals={}),r.visual=new Mf(i.node(),t,r.visual,r.visual?null:r.$new()),a.visualDashboard||(a.visualDashboard=r.visual),i.html(e)}}),Ef=er({},kf,{build:function(t,e,n){var r,i=this.createElement("div"),a=t.type||"visual",o=this.model,u=ar(t,"visualDrawOnMount"),s={};return n.class&&i.attr("class",n.class),"visual"===a?(r=ar(t,"layers"),s=t):s.visual=ar(t,"visual")||{},void 0!==u&&(o.visualDrawOnMount=u),o.visual=new Hs(i.node(),s,o.visual,o.visual?null:o.$new()),"visual"!==a?o.visual.addVisual(t):r&&r.forEach(function(t){return o.visual.addVisual(t)}),i},mounted:function(){!1!==this.model.visualDrawOnMount&&this.model.visual.redraw()}}),Tf={install:function(t){t.addComponent("dashboard",Af),t.addComponent("visual",Ef)}},Sf=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},Cf=function(t,e){var n=t[0],r=(t[1]-n)/e,i=Math.floor(Math.log10(r)),a=Math.pow(10,i);r/a>5&&(a*=10);var o=(a*=.1)*Math.ceil(r/a),u=a*Math.floor(n/a);return[u,u+e*o]},Nf=function(t,e,n){return.299*(t=Ft(t)).r+.587*t.g+.114*t.b>186?n||"#000":e||"#fff"},Pf=function(t,e,n){e=nf(e),t.each(function(t,r){var i=Wr(this),a=parseFloat(i.attr("dy"))||0,o=e(t,r),u=i.text().split("\n"),s=void 0,c=void 0,l=void 0,f=i.text(null).append("tspan").attr("x",0).attr("dy",a+"em");u.forEach(function(t,e){for(l=[],c=t.split(/\s+/).reverse(),e&&(f=i.append("tspan").attr("x",0).attr("dy",1.2+a+"em"));s=c.pop();)l.push(s),f.text(l.join(" ")),f.node().getComputedTextLength()>o&&l.length>1&&(l.pop(),f.text(l.join(" ")),l=[s],f=i.append("tspan").attr("x",0).attr("dy",1.2+a+"em").text(s))}),n&&i.selectAll("tspan").each(n)})},zf=function(){function t(t){var u=!1,s=void 0,c=void 0,l=void 0;return e&&(c=t.dimension(e).group().top(1/0).map(function(t){return t.key}).sort()).length<=1&&(c=null),c?(t=t.pivot(n,e,r),i&&(t=t.sortby("total")),s=t.data,a&&(o&&(s=function(t){return t}(s)),s=a.keys(c)(s),u=!0)):(s=t.data,c=[r]),u||(s=c.map(function(t,e){return l=s.map(function(e){return l=[0,e[t]],l.data=e,l}),l.index=e,l.key=t,l})),new Vn(s,n,r,u)}var e=null,n="x",r="y",i=!1,a=null,o=!1;return t.groupby=function(n){return arguments.length?(e=n,t):e},t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t.normalize=function(e){return arguments.length?(o=e,t):o},t.stack=function(e){return arguments.length?(a=e,t):a},t};Vn.prototype={rangeX:function(){return this.range(this.x)},rangeY:function(){return this.range()},range:function(t){var e=void 0,n=void 0;return n=t?this.data.reduce(function(n,r){return e=da(r,function(e){return e.data[t]}),n.push(e[0]),n.push(e[1]),n},[]):this.data.reduce(function(t,n){return e=da(n,function(t){return t[0]}),t.push(e[0]),t.push(e[1]),e=da(n,function(t){return t[1]}),t.push(e[0]),t.push(e[1]),t},[]),da(n)}};var Of={curveBasisClosed:function(t){return new en(t)},curveBasisOpen:function(t){return new nn(t)},curveBasis:function(t){return new tn(t)},curveBundle:Oc,curveCardinalClosed:jc,curveCardinalOpen:$c,curveCardinal:Dc,curveCatmullRomClosed:Fc,curveCatmullRomOpen:Uc,curveCatmullRom:Lc,curveLinearClosed:function(t){return new dn(t)},curveLinear:xc,curveMonotoneX:function(t){return new yn(t)},curveMonotoneY:function(t){return new bn(t)},curveNatural:Hc},Df={curve:function(t){var e=Ys(Of,"curve",t,!0);return e||(qa('Could not locate curve type "'+t+'"'),e=Hc),e},range:function(t,e,n,r){var i={x:da(t,e),y:da(t,n)};r&&(Array.prototype.push.apply(r.x,i.x),Array.prototype.push.apply(r.y,i.y))},newRange:function(){return{x:[],y:[]}},x:function(t,e){var n=this.getModel(),r=this.getScale(n.scaleX).domain(da(e)).range([0,t.innerWidth]);return function(t){return r(t[n.x])}},y:function(t,e,n){var r=this.getModel(),i=this.getScale(r.scaleY).domain(da(e)).range([t.innerHeight,0]);return 2===arguments.length&&(n=function(t){return t[r.y]}),function(t){return i(n(t))}}};Rs("linechart",Df,{options:{lineWidth:1,curve:"natural",x:"x",y:"y",groupby:null,scaleX:"linear",scaleY:"linear",axisX:!0,axisY:!0},doDraw:function(t){function e(t,e){return g[e]}var n=this.getModel(),r=n.x,i=n.y,a=this.boundingBox(),o=zf().groupby(n.groupby).x(r).y(i)(t),s=o.rangeX(),c=o.rangeY(),l=this.getScale(n.scaleX).domain(s).rangeRound([0,a.innerWidth]),f=this.getScale(n.scaleY).domain(c).rangeRound([a.innerHeight,0]).nice(),h=this.group(),d=this.group("chart"),p=d.selectAll(".line").data(o.data),g=this.stroke(o.data).colors,v=0,m=wc().x(function(t){return l(t.data[r])+v}).y(function(t){return f(t[1])}).curve(this.curve(n.curve));this.applyTransform(h,this.translate(a.padding.left,a.padding.top)),this.applyTransform(d,this.translate(a.margin.left,a.margin.top)),u(l.bandwidth)&&(l.domain(o.data[0].map(function(t){return t.data[r]})),v=l.bandwidth()/2),p.enter().append("path").attr("class","line").attr("fill","none").attr("stroke",e).attr("stroke-width",n.lineWidth).attr("d",m).merge(p).transition().attr("stroke",e).attr("stroke-width",n.lineWidth).attr("d",m),p.exit().transition().style("opacity",0).remove(),n.axisX&&this.xAxis1(!0===n.axisX?"bottom":n.axisX,f,a),n.axisY&&this.yAxis1(!0===n.axisY?"left":n.axisY,f,a)}});var jf={center:"middle",top:"hanging",bottom:"baseline",outside:"baseline"},$f={center:function(t,e){return e/2},top:function(t,e,n){return n},bottom:function(t,e,n){return e-n},outside:function(t,e,n){return-n}};Rs("barchart",Df,{options:{orientation:"vertical",sortby:null,stack:!0,stackOrder:"descending",waffle:!1,normalize:!1,scaleX:{type:"band",padding:.2},scaleY:"linear",x:"x",y:"y",label:null,labelLocation:"center",labelOffset:10,labelWidth:.7,radius:0,groupby:null,axisY:!0,axisX:!0,valueformat:".1f",legendType:"color",legendLabel:"label"},doDraw:function(t){var e=this.getModel(),n=t.data,r=this.boundingBox(),i=this.group(),a=this.group("chart"),o=e.x,u=e.y,s=e.groupby,c="vertical"===e.orientation?new Gn(this):new Kn(this),l=void 0,f=!1;if(this.applyTransform(i,this.translate(r.padding.left,r.padding.top)),this.applyTransform(a,this.translate(r.margin.left,r.margin.top)),s&&(l=t.dimension(s).group().top(1/0).map(function(t){return t.key})).length<=1&&(l=null),l){var h=t.pivot(o,s,u);"y"===e.sortby&&(h=h.sortby("total")),n=h.data,c.sz.domain(l).range(this.fill(l).colors),e.stack&&(e.normalize&&(n=this.normalize(h)),f=!0)}else c.sz.domain([u]).range(this.fill([u]).colors),f=!0;var d=n.map(function(t){return t[o]});c.sx.domain(d),f||!l?c.stacked(a,n,l):c.grouped(a,n,l),c.axis(d),c.legend(l)}});var Lf={init:function(t){this.viz=t,this.model=t.getModel(),this.box=t.boundingBox(),this.sx=t.getScale(this.model.scaleX),this.sy=t.getScale(this.model.scaleY),this.sz=t.getScale("ordinal")},legend:function(t){this.model.legendType&&t&&this.viz.legend({scale:this.sz},this.box)},stacked:function(t,e,n){function r(t){return h(t[1-M])-h(t[M])}function i(t){return f(t.data[p])}function a(t){return h(t[M])}function o(t){return t.forEach(function(e){e.key=t.key,e.value=e.data[t.key]}),t}function u(t,e){var n=x(t,e)+b(t,e)/2,r=w(t,e)+N(t,_(t,e),z);return v.translate(n,r)}function s(t){return Nf(d(t.key),"#fff",A.stroke)}function c(t,e){return v.dataStore.eval(E,{d:t,index:e})}var l=this.viz.getModel("color"),f=this.sx,h=this.sy,d=this.sz,p=this.model.x,g=this.model.y,v=this.viz,m=this.model.radius,y=t.selectAll(".group"),b=void 0,_=void 0,x=void 0,w=void 0,M=void 0,k=void 0;if(n?this.sy.domain([0,_a(e,function(t){return t.total})]).nice():(this.sy.domain([0,_a(e,function(t){return t[g]})]).nice(),n=[this.model.y]),this.vertical?(x=i,w=a,b=f.bandwidth,_=r,M=1):(x=a,w=i,b=r,_=f.bandwidth,M=0),e=v.getStack().keys(n)(e),(y=y.data(e)).exit().transition().style("opacity",0).remove(),(k=y.enter().append("g").classed("group",!0).attr("fill",function(t){return d(t.key)}).merge(y).attr("fill",function(t){return d(t.key)}).attr("stroke",v.modelProperty("stroke",l)).attr("stroke-opacity",v.modelProperty("strokeOpacity",l)).selectAll("rect").data(o)).enter().append("rect").attr("x",x).attr("y",w).attr("height",_).attr("width",b).attr("rx",m).attr("ry",m).on("mouseover",v.mouseOver()).on("mouseout",v.mouseOut()).merge(k).transition().attr("x",x).attr("y",w).attr("height",_).attr("width",b),k.exit().transition().style("opacity",0).remove(),this.model.label){var A=v.getModel("font"),E=this.model.label,T=v.font(this.box)+"px",S=t.selectAll(".labels").data(e),C=this.vertical?jf[this.model.labelLocation]||"baseline":"middle",N=$f[this.model.labelLocation],P=this.model.labelWidth,z=this.model.labelOffset;(k=S.enter().append("g").classed("labels",!0).merge(S).selectAll("text").data(o)).enter().append("text").classed("label",!0).attr("transform",u).style("fill",s).style("font-size",T).text(c).merge(k).text(c).style("font-size",T).call(Pf,function(t){return P*b(t)},function(){v.select(this).attr("alignment-baseline",C).attr("text-anchor","middle")}).transition(v.transition("text")).attr("transform",u).style("fill",s)}},grouped:function(t,e,n){function r(t){return u(t[l])}function i(t){return s(t.value)}function a(t){return s(0)-s(t.value)}var o=this.viz.getModel("color"),u=this.sx,s=this.sy,c=this.sz,l=this.model.x,f=this.viz,h=this.model.radius,d=u.paddingInner(),p=f.getScale("band").domain(n).paddingInner(.5*d),g=t.selectAll(".group"),v=void 0,m=void 0,y=void 0,b=void 0;s.domain([0,_a(e,function(t){return n.reduce(function(e,n){return Math.max(e,t[n])},0)})]).nice(),this.vertical?(p.rangeRound([0,u.bandwidth()]),y=r,v=p.bandwidth,m=a):(y=r,m=p.bandwidth,v=a),(g=g.data(e)).exit().remove(),(b=g.enter().append("g").classed("group",!0).attr("transform",function(t){return f.translate(y(t),0)}).merge(g).attr("transform",function(t){return f.translate(y(t),0)}).selectAll("rect").data(function(t){return n.map(function(e){return{key:e,value:t[e]}})})).exit().transition().style("opacity",0).remove(),b.enter().append("rect").attr("x",function(t){return p(t.key)}).attr("y",i).attr("rx",h).attr("ry",h).attr("height",m).attr("width",v).attr("stroke",o.stroke).attr("stroke-opacity",0).attr("fill",function(t){return c(t.key)}).on("mouseover",f.mouseOver()).on("mouseout",f.mouseOut()).merge(b).transition(f.transition("rect")).attr("x",function(t){return p(t.key)}).attr("y",i).attr("height",m).attr("width",v).attr("stroke",o.stroke).attr("stroke-opacity",o.strokeOpacity).attr("fill",function(t){return c(t.key)}),b.exit().remove()}};Gn.prototype=er({},Lf,{axis:function(t){this.model.axisX&&this.viz.xAxis1(!0===this.model.axisX?"bottom":this.model.axisX,this.sx,this.box,t[0]),this.model.axisY&&this.viz.yAxis1(!0===this.model.axisY?"left":this.model.axisY,this.sy,this.box)}}),Kn.prototype=er({},Lf,{axis:function(t){this.model.axisX&&this.viz.xAxis1(!0===this.model.axisX?"left":this.model.axisX,this.sx,this.box,t[0]),this.model.axisY&&this.viz.yAxis1(!0===this.model.axisY?"bottom":this.model.axisY,this.sy,this.box)}}),Rs("boxchart",Df,{options:{orientation:"vertical",lineWidth:1,x:"x",y:"y",scaleX:"linear",scaleY:"linear",gradient:!0},doDraw:function(t){var e=this.getModel(),n=this.getDataInfo(t),r=this.boundingBox(),i=function(){function t(t){var c=this;t.each(function(l,f){var h=(l=l.map(a).sort(sa)).length,d=l[0],p=l[h-1],g=l.quartiles=u(l),v=o&&o(l),m=v&&v.map(function(t){return l[t]}),y=v?pa(0,v[0]).concat(pa(v[1]+1,h)):pa(h),b=Me().domain(i&&i.call(c,l,f)||[d,p]).range([n,0]),_=c.__chart__||Me().domain([0,1/0]).range(b.range());c.__chart__=b;var x=t.selectAll("line.center").data(m?[m]:[]);x.enter().insert("line","rect").attr("class","center").attr("x1",e/2).attr("y1",function(t){return _(t[0])}).attr("x2",e/2).attr("y2",function(t){return _(t[1])}).style("opacity",1e-6).transition().duration(r).style("opacity",1).attr("y1",function(t){return b(t[0])}).attr("y2",function(t){return b(t[1])}),x.transition().duration(r).style("opacity",1).attr("y1",function(t){return b(t[0])}).attr("y2",function(t){return b(t[1])}),x.exit().transition().duration(r).style("opacity",1e-6).attr("y1",function(t){return b(t[0])}).attr("y2",function(t){return b(t[1])}).remove();var w=t.selectAll("rect.box").data([g]);w.enter().append("rect").attr("class","box").attr("x",0).attr("y",function(t){return _(t[2])}).attr("width",e).attr("height",function(t){return _(t[0])-_(t[2])}).transition().duration(r).attr("y",function(t){return b(t[2])}).attr("height",function(t){return b(t[0])-b(t[2])}),w.transition().duration(r).attr("y",function(t){return b(t[2])}).attr("height",function(t){return b(t[0])-b(t[2])});var M=t.selectAll("line.median").data([g[1]]);M.enter().append("line").attr("class","median").attr("x1",0).attr("y1",_).attr("x2",e).attr("y2",_).transition().duration(r).attr("y1",b).attr("y2",b),M.transition().duration(r).attr("y1",b).attr("y2",b);var k=t.selectAll("line.whisker").data(m||[]);k.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",_).attr("x2",e).attr("y2",_).style("opacity",1e-6).transition().duration(r).attr("y1",b).attr("y2",b).style("opacity",1),k.transition().duration(r).attr("y1",b).attr("y2",b).style("opacity",1),k.exit().transition().duration(r).attr("y1",b).attr("y2",b).style("opacity",1e-6).remove();var A=t.selectAll("circle.outlier").data(y,Number);A.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",e/2).attr("cy",function(t){return _(l[t])}).style("opacity",1e-6).transition().duration(r).attr("cy",function(t){return b(l[t])}).style("opacity",1),A.transition().duration(r).attr("cy",function(t){return b(l[t])}).style("opacity",1),A.exit().transition().duration(r).attr("cy",function(t){return b(l[t])}).style("opacity",1e-6).remove();var E=s||b.tickFormat(8),T=t.selectAll("text.box").data(g);T.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",function(t,e){return 1&e?6:-6}).attr("x",function(t,n){return 1&n?e:0}).attr("y",_).attr("text-anchor",function(t,e){return 1&e?"start":"end"}).text(E).transition().duration(r).attr("y",b),T.transition().duration(r).text(E).attr("y",b);var S=t.selectAll("text.whisker").data(m||[]);S.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",e).attr("y",_).text(E).style("opacity",1e-6).transition().duration(r).attr("y",b).style("opacity",1),S.transition().duration(r).text(E).attr("y",b).style("opacity",1),S.exit().transition().duration(r).attr("y",b).style("opacity",1e-6).remove()})}var e=1,n=1,r=0,i=null,a=Number,o=function(t){return[0,t.length-1]},u=function(t){return[ba(t,.25),ba(t,.5),ba(t,.75)]},s=null;return t.width=function(n){return arguments.length?(e=n,t):e},t.height=function(e){return arguments.length?(n=e,t):n},t.tickFormat=function(e){return arguments.length?(s=e,t):s},t.duration=function(e){return arguments.length?(r=e,t):r},t.domain=function(e){return arguments.length?(i=null===e?e:ef(e),t):i},t.value=function(e){return arguments.length?(a=e,t):a},t.whiskers=function(e){return arguments.length?(o=e,t):o},t.quartiles=function(e){return arguments.length?(u=e,t):u},t}(),a=this.paper().size(r),o=La(e.x),u=a.group().attr("transform",this.translate(r.total.left,r.total.top)).selectAll(".box").data(n.data),s=t.groupby(e.x),c=this.getScale(e.scaleX).domain(da(t.data,o)),l=r.innerWidth;"vertical"===e.orientation?c.range([0,r.innerWidth]):(c.range([0,r.innerHeight]),l=this.innerHeight),i.width(this.dim(e.width,l,l/s.length-2)),u.enter().append("g").classed("box",!0).call(i)}}),Rs("areachart",Df,{options:{lineWidth:1,curve:"natural",x:"x",y:"y",groupby:null,scaleX:"linear",scaleY:"linear",gradient:!0,lineDarken:.2,stack:!0,stackOrder:"none",axisX:!0,axisY:!0},doDraw:function(t){function e(t){return h(t.data[a])}function n(t){return d(t[1])}var r=this,i=this.getModel(),a=i.x,o=i.y,u=this.getModel("color"),s=this.boundingBox(),c=zf().groupby(i.groupby).stack(this.getStack()).x(a).y(o)(t),l=c.rangeX(),f=c.rangeY(),h=this.getScale(i.scaleX).domain(l).rangeRound([0,s.innerWidth]),d=this.getScale(i.scaleY).domain(f).rangeRound([s.innerHeight,0]).nice(),p=this.group(),g=this.group("chart"),v=g.selectAll(".areagroup").data(c.data),m=this.colors(c.data.length),y=i.gradient?m.map(function(t,e){return r.linearGradient(t,s,"vertical","fill"+r.model.uid+"-"+e)}):m,b=this.curve(i.curve);this.applyTransform(p,this.translate(s.padding.left,s.padding.top)),this.applyTransform(g,this.translate(s.margin.left,s.margin.top)),v.exit().transition().style("opacity",0).remove();var _=v.enter().append("g").classed("areagroup",!0).merge(v).selectAll("path").data(function(t){var r=Mc().curve(b).x(e).y1(n).y0(function(t){return d(t[0])}),a=wc().curve(b).x(e).y(n),o=Ft(m[t.index]);return[{type:"area",data:t,draw:r(t),stroke:"none",fill:y[t.index]},{type:"line",data:t,draw:a(t),fill:"none",stroke:o.darker(i.lineDarken)}]});_.enter().append("path").attr("class",function(t){return t.type}).attr("fill",function(t){return t.fill}).attr("stroke",function(t){return t.stroke}).attr("d",function(t){return t.draw}).merge(_).transition(this.transition("area")).attr("d",function(t){return t.draw}).attr("fill",function(t){return t.fill}).attr("stroke",function(t){return t.stroke}).attr("fill-opacity",u.fillOpacity).attr("stroke-width",i.lineWidth).attr("stroke-opacity",u.strokeOpacity),_.exit().transition().style("opacity",0).remove(),i.axisX&&this.xAxis1(!0===i.axisX?"bottom":i.axisX,h,s,l[0]),i.axisY&&this.yAxis1(!0===i.axisY?"left":i.axisY,d,s,f[0]),c.data.length>1&&this.legend({type:"color",scale:this.getScale("ordinal").range(m).domain(c.data.map(function(t){return t.key}))},s)},ticks:function(t,e){return Math.max(Math.floor(t/e),1)}});var Ff=Math.PI/180,Uf={proportionalData:function(t,e){return t.dimension(e).top(1/0)},total:function(t){function e(e){return n+=e[t],e[t]}var n=0;return e.total=function(){return n},e}};Rs("piechart",Uf,{options:{field:"data",label:"label",startAngle:0,endAngle:360,sort:!1,innerRadius:0,padAngle:0,cornerRadius:0,lineWidth:1,fractionFormat:".1%",legendType:"color",legendLabel:"label + ' - ' + format(fraction)",center:null,centerOpacity:1,centerFontSize:"7%"},doDraw:function(t){var e=this.getModel(),r=this.getModel("color"),i=e.field,a=this.boundingBox(),o=Math.min(a.innerWidth,a.innerHeight)/2,u=le(e.innerRadius,o),s=this.total(i),c=function(){function t(t){var u,s,c,l,f,h=t.length,d=0,p=new Array(h),g=new Array(h),v=+i.apply(this,arguments),m=Math.min(_c,Math.max(-_c,a.apply(this,arguments)-v)),y=Math.min(Math.abs(m)/h,o.apply(this,arguments)),b=y*(m<0?-1:1);for(u=0;u<h;++u)(f=g[p[u]=u]=+e(t[u],u,t))>0&&(d+=f);for(null!=n?p.sort(function(t,e){return n(g[t],g[e])}):null!=r&&p.sort(function(e,n){return r(t[e],t[n])}),u=0,c=d?(m-h*b)/d:0;u<h;++u,v=l)s=p[u],l=v+((f=g[s])>0?f*c:0)+b,g[s]={data:t[s],index:u,value:f,startAngle:v,endAngle:l,padAngle:y};return g}var e=function(t){return t},n=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},r=null,i=cc(0),a=cc(_c),o=cc(0);return t.value=function(n){return arguments.length?(e="function"==typeof n?n:cc(+n),t):e},t.sortValues=function(e){return arguments.length?(n=e,r=null,t):n},t.sort=function(e){return arguments.length?(r=e,n=null,t):r},t.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:cc(+e),t):i},t.endAngle=function(e){return arguments.length?(a="function"==typeof e?e:cc(+e),t):a},t.padAngle=function(e){return arguments.length?(o="function"==typeof e?e:cc(+e),t):o},t}().padAngle(Ff*e.padAngle).startAngle(Ff*e.startAngle).endAngle(Ff*e.endAngle).value(s),l=function(){function t(){var t,c,l=+e.apply(this,arguments),f=+n.apply(this,arguments),h=a.apply(this,arguments)-bc,d=o.apply(this,arguments)-bc,p=lc(d-h),g=d>h;if(s||(s=t=Be()),f<l&&(c=f,f=l,l=c),f>mc)if(p>_c-mc)s.moveTo(f*hc(h),f*gc(h)),s.arc(0,0,f,h,d,!g),l>mc&&(s.moveTo(l*hc(d),l*gc(d)),s.arc(0,0,l,d,h,g));else{var v,m,y=h,b=d,_=h,x=d,w=p,M=p,k=u.apply(this,arguments)/2,A=k>mc&&(i?+i.apply(this,arguments):vc(l*l+f*f)),E=pc(lc(f-l)/2,+r.apply(this,arguments)),T=E,S=E;if(A>mc){var C=Ve(A/l*gc(k)),N=Ve(A/f*gc(k));(w-=2*C)>mc?(C*=g?1:-1,_+=C,x-=C):(w=0,_=x=(h+d)/2),(M-=2*N)>mc?(N*=g?1:-1,y+=N,b-=N):(M=0,y=b=(h+d)/2)}var P=f*hc(y),z=f*gc(y),O=l*hc(x),D=l*gc(x);if(E>mc){var j=f*hc(b),$=f*gc(b),L=l*hc(_),F=l*gc(_);if(p<yc){var U=w>mc?function(t,e,n,r,i,a,o,u){var s=L-t,c=F-e,l=o-i,f=u-a,h=(l*(e-a)-f*(t-i))/(f*s-l*c);return[t+h*s,e+h*c]}(P,z,0,0,j,$,O,D):[O,D],H=P-U[0],Y=z-U[1],R=j-U[0],q=$-U[1],X=1/gc(function(t){return t>1?0:t<-1?yc:Math.acos(t)}((H*R+Y*q)/(vc(H*H+Y*Y)*vc(R*R+q*q)))/2),W=vc(U[0]*U[0]+U[1]*U[1]);T=pc(E,(l-W)/(X-1)),S=pc(E,(f-W)/(X+1))}}M>mc?S>mc?(v=Ge(L,F,P,z,f,S,g),m=Ge(j,$,O,D,f,S,g),s.moveTo(v.cx+v.x01,v.cy+v.y01),S<E?s.arc(v.cx,v.cy,S,fc(v.y01,v.x01),fc(m.y01,m.x01),!g):(s.arc(v.cx,v.cy,S,fc(v.y01,v.x01),fc(v.y11,v.x11),!g),s.arc(0,0,f,fc(v.cy+v.y11,v.cx+v.x11),fc(m.cy+m.y11,m.cx+m.x11),!g),s.arc(m.cx,m.cy,S,fc(m.y11,m.x11),fc(m.y01,m.x01),!g))):(s.moveTo(P,z),s.arc(0,0,f,y,b,!g)):s.moveTo(P,z),l>mc&&w>mc?T>mc?(v=Ge(O,D,j,$,l,-T,g),m=Ge(P,z,L,F,l,-T,g),s.lineTo(v.cx+v.x01,v.cy+v.y01),T<E?s.arc(v.cx,v.cy,T,fc(v.y01,v.x01),fc(m.y01,m.x01),!g):(s.arc(v.cx,v.cy,T,fc(v.y01,v.x01),fc(v.y11,v.x11),!g),s.arc(0,0,l,fc(v.cy+v.y11,v.cx+v.x11),fc(m.cy+m.y11,m.cx+m.x11),g),s.arc(m.cx,m.cy,T,fc(m.y11,m.x11),fc(m.y01,m.x01),!g))):s.arc(0,0,l,x,_,g):s.lineTo(O,D)}else s.moveTo(0,0);if(s.closePath(),t)return s=null,t+""||null}var e=function(t){return t.innerRadius},n=function(t){return t.outerRadius},r=cc(0),i=null,a=function(t){return t.startAngle},o=function(t){return t.endAngle},u=function(t){return t&&t.padAngle},s=null;return t.centroid=function(){var t=(+e.apply(this,arguments)+ +n.apply(this,arguments))/2,r=(+a.apply(this,arguments)+ +o.apply(this,arguments))/2-yc/2;return[hc(r)*t,gc(r)*t]},t.innerRadius=function(n){return arguments.length?(e="function"==typeof n?n:cc(+n),t):e},t.outerRadius=function(e){return arguments.length?(n="function"==typeof e?e:cc(+e),t):n},t.cornerRadius=function(e){return arguments.length?(r="function"==typeof e?e:cc(+e),t):r},t.padRadius=function(e){return arguments.length?(i=null==e?null:"function"==typeof e?e:cc(+e),t):i},t.startAngle=function(e){return arguments.length?(a="function"==typeof e?e:cc(+e),t):a},t.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:cc(+e),t):o},t.padAngle=function(e){return arguments.length?(u="function"==typeof e?e:cc(+e),t):u},t.context=function(e){return arguments.length?(s=null==e?null:e,t):s},t}().innerRadius(u).outerRadius(o).cornerRadius(e.cornerRadius),f=this.group(),h=this.group("chart"),d=c(this.proportionalData(t,i)),p=this.fill(d),g=h.selectAll(".slice").data(d);if(this.applyTransform(f,this.translate(a.padding.left,a.padding.top)),this.applyTransform(h,this.translate(a.margin.left+a.innerWidth/2,a.margin.top+a.innerHeight/2)),g.enter().append("path").attr("class","slice").attr("stroke",r.stroke).attr("stroke-opacity",0).attr("fill",p).attr("stroke-width",e.lineWidth).on("mouseover",this.mouseOver()).on("mouseout",this.mouseOut()).merge(g).transition().attr("stroke",r.stroke).attr("stroke-opacity",r.strokeOpacity).attr("d",l).attr("fill",p),g.exit().transition().remove(),e.center){var v=n(d.reduce(function(t,e){return t[e.data.label]=e,t})),m=this.dataStore.eval(e.center,{total:s.total(),d:v});if(m){var y=this.getModel("font"),b=this.dim(e.centerFontSize,a.innerWidth),_=h.selectAll(".info").data([m]);_.enter().append("text").attr("class","info").attr("text-anchor","middle").attr("alignment-baseline","middle").style("font-size",b+"px").style("fill-opacity",0).merge(_).text(m).style("fill-opacity",e.centerOpacity).style("fill",y.stroke).call(Pf,1.5*(u||o))}}if(e.legendType){s=s.total();var x=bi(e.legendLabel),w=fs(e.fractionFormat),M=d.map(function(t,n){return x.eval({d:t,value:t.value,format:w,total:s,fraction:t.value/s,label:t.data[e.label]||n})});this.legend({scale:pe().domain(M).range(p.colors)},a)}}});Rs("pyramidchart",Uf,{options:{field:"data",label:"label",pad:.005,lineWidth:1,inverted:!1,funnel:!1,legendType:"color",invereted:!1,legendLabel:"label + ' - ' + format('.1%', fraction)"},doDraw:function(t){var e=this.getModel(),n=e.field,r=this.getModel("color"),i=this.boundingBox(),a=(e.funnel?function(){function t(t){var a=void 0,o=void 0,u=void 0,s=void 0,c=void 0,l=void 0,f=void 0,h=0,d=0,p=t.length,g=new Array(p),v=new Array(p),m=r/p;for(a=0;a<p;++a)g[v[a]=a]=+e(t[a],a,t);for(v.sort(function(t,e){return Sf(g[t],g[e])}),c=g[v[0]],a=0;a<p;++a)o=v[a],s=g[o]/c,u=[[(l=i*s)/2,d+(f=h)],[-l/2,d+f],[-l/2,d+m-(h=r*(a===p-1?0:.5*n(s,a)))],[l/2,d+m-h]],d+=m,g[o]={index:a,value:g[o],fraction:s,points:u,data:t[o]};return g}var e=rf,n=ef(0),r=1,i=1;return t.value=function(n){return arguments.length?(e="function"==typeof n?n:ef(+n),t):e},t.base=function(e){return arguments.length?(i=e,t):i},t.height=function(e){return arguments.length?(r=e,t):r},t.pad=function(e){return arguments.length?(n="function"==typeof e?e:ef(+e),t):n},t}():function(){function t(t){var a=void 0,o=void 0,u=void 0,s=void 0,c=void 0,l=void 0,f=void 0,h=void 0,d=void 0,p=void 0,g=void 0,v=t.length,m=.5*i/r,y=new Array(v),b=new Array(v);for(a=0;a<v;++a)y[b[a]=a]=+e(t[a],a,t);for(b.sort(function(t,e){return Sf(y[t],y[e])}),d=y[b[0]],l=null,a=v-1;a>=0;--a)s=[],null===l?s.push([0,0]):(f=(h=l+p)*m,s.push([f,h]),s.push([-f,h])),o=b[a],u=v-a-1,c=y[o]/d,g=Math.sqrt(c),f=(h=(l=r*g)-(p=a?n(g,u):0))*m,s.push([-f,h]),s.push([f,h]),y[o]={index:u,value:y[o],fraction:c,points:s,data:t[o]};return y}var e=rf,n=ef(0),r=1,i=1;return t.value=function(n){return arguments.length?(e="function"==typeof n?n:ef(+n),t):e},t.base=function(e){return arguments.length?(i=e,t):i},t.height=function(e){return arguments.length?(r=e,t):r},t.pad=function(e){return arguments.length?(n="function"==typeof e?e:ef(+e),t):n},t}()).pad(e.pad).value(function(t){return t[n]}),o=this.getScale("linear").rangeRound([0,i.innerWidth]),u=this.getScale("linear").rangeRound(e.inverted?[i.innerHeight,0]:[0,i.innerHeight]),s=t.new(a(this.proportionalData(t,n))).dimension("fraction").bottom(1/0),c=Pc().type(function(t){return function(t){return{draw:function(e){t.forEach(function(t,n){n?e.lineTo(t[0],t[1]):e.moveTo(t[0],t[1])}),e.closePath()}}}(t.points.map(function(t){return[o(t[0]),u(t[1])]}))}).size(1),l=this.fill(s),f=this.group(),h=this.group("chart"),d=h.style("shape-rendering","crispEdges").selectAll(".segment").data(s);if(this.applyTransform(f,this.translate(i.padding.left,i.padding.top)),this.applyTransform(h,this.translate(i.margin.left+i.innerWidth/2,i.margin.top)),d.enter().append("path").attr("class","segment").attr("stroke",r.stroke).attr("stroke-opacity",0).attr("fill",l).attr("stroke-width",e.lineWidth).attr("d",c).on("mouseover",this.mouseOver()).on("mouseout",this.mouseOut()).merge(d).transition().attr("stroke",r.stroke).attr("stroke-opacity",r.strokeOpacity).attr("d",c).attr("fill",l),d.exit().remove(),e.legendType){var p=bi(e.legendLabel),g=this,v=s.map(function(t,n){return p.eval(g.getContext({d:t,value:t.value,fraction:t.fraction,label:t.data[e.label]||n}))});this.legend({scale:this.getScale("ordinal").domain(v).range(l.colors)},i)}}}),Rs("treemap",{requires:["d3-hierarchy"],options:{label:"label",field:"data",padding:2,tile:"resquarify",format:","},doDraw:function(t,e){function n(t){return[t]}function r(t){var e=void 0;return t.map(function(t){return(e=t.children)&&(t._children=r(e),delete t.children),t})}var i=this,a=this.getModel(),o=this.getModel("font"),u=this.boundingBox(),s=La(a.label),c=La(a.field),l=fs(a.format),f=e.hierarchy(function(t){return t={children:r(t)},t[a.label]="root",t}(t.data)).sum(c).sort(function(t,e){return e.value-t.value}).eachBefore(function(t){t.parent?(t.data._counter=t.parent.data._counter,t.parent.data._counter++):t.data._counter=0}),h=e.treemap().tile(Ys(e,"treemap",a.tile,!0)).size([u.innerWidth,u.innerHeight]).round(!0).padding(a.padding),d=this.fill(f.children).colors,p=this.group().attr("transform",this.translate(u.total.left,u.total.top)).style("shape-rendering","crispEdges"),g=h(f).leaves(),v=p.selectAll("g").data(g),m=this;this.paper().size(u),v.exit().remove();var y=(v=v.enter().append("g").attr("transform",function(t){return i.translate(t.x0,t.y0)}).merge(v).attr("transform",function(t){return i.translate(t.x0,t.y0)})).selectAll("rect").data(n);y.enter().append("rect").attr("width",function(t){return t.x1-t.x0}).attr("height",function(t){return t.y1-t.y0}).attr("fill",function(t){return d[t.data._counter]}).attr("stroke","none").on("mouseover",this.mouseOver()).on("mouseout",this.mouseOut()).merge(y).transition().attr("width",function(t){return t.x1-t.x0}).attr("height",function(t){return t.y1-t.y0}).attr("fill",function(t){return d[t.data._counter]}),(y=v.selectAll("text").data(n)).enter().append("text").style("fill",function(t){return Nf(d[t.data._counter],"#fff",o.stroke)}).selectAll("tspan").data(function(t){var e=m.font({height:Math.min(t.x1-t.x0,t.y1-t.y0)}),n=s(t.data).split(/(?=[A-Z][^A-Z])/g);return n.push(l(t.value)),n.map(function(t){return{size:e,text:t}})}).enter().append("tspan").style("font-size",function(t){return t.size}).attr("x",4).attr("y",function(t,e){return 1.5*t.size+1.2*e*t.size}).text(function(t){return t.text})}}),Rs("text",{options:{label:"label",data:"data",text:'label + " " + data',sizeReduction:.7},doDraw:function(t){function e(t,e){return n.translate((e+.5)*l,0)}var n=this,r=this.getModel(),i=this.getModel("font"),a=this.boundingBox(),o=this.font(a),u=this.group(),s=this.group("chart"),c=s.selectAll("text").data(t.data),l=a.innerWidth/t.data.length,f=.4*l,h=this.dataStore,d=this.modelProperty("stroke",i);this.applyTransform(u,this.translate(a.padding.left,a.padding.top)),this.applyTransform(s,this.translate(a.margin.left,a.margin.top+a.innerHeight/2)),c.enter().append("text").attr("transform",e).attr("text-anchor","middle").attr("alignment-baseline","middle").style("fill",d).merge(c).attr("transform",e).text(function(t){return h.eval(r.text,t)}).style("fill",d).call(Pf,f,function(t,e){var i=o;e&&(i=r.sizeReduction*o),n.select(this).attr("font-size",i+"px")}),u.exit().remove()}}),Rs("heatmap",Df,{options:{shape:"square",layout:"heatmap",buckets:10,pad:.005,x:"x",y:"y",z:"data",label:null,axisX:!0,axisY:!0,reverseColors:!0,tableColors:null},doDraw:function(t){function e(t){return t.data[r.label]}function n(t){return Nf(t.color,"#fff",a.stroke)}var r=this.getModel(),i=this.getModel("color"),a=this.getModel("font"),o=r.layout,u=this.boundingBox(),s=da(t.data,La(r.z));s[0]<0&&"punchcard"===o&&(o="heatmap");var c=this.heatmap(o,t,u,s),l=(u.innerWidth-c.width)/2,f=(u.innerHeight-c.height)/2,h=this.getSymbol(r.shape).size(function(t){return t.size*t.size}),d=this.group(),p=this.group("chart"),g=p.selectAll(".shape").data(c.data);if(this.applyTransform(d,this.translate(u.padding.left,u.padding.top)),this.applyTransform(p,this.translate(u.margin.left+l,u.margin.top+f)),pa[0]<0&&"punchcard"===o&&(o="heatmap"),g.enter().append("path").classed("shape",!0).attr("transform",function(t){return"translate("+t.x+", "+t.y+")"}).attr("fill",function(t){return t.color}).attr("fill-opacity",0).attr("stroke-opacity",0).attr("stroke",i.stroke).attr("d",h).on("mouseover",this.mouseOver()).on("mouseout",this.mouseOut()).merge(g).transition(this.transition()).attr("transform",function(t){return"translate("+t.x+", "+t.y+")"}).attr("fill-opacity",i.fillOpacity).attr("fill",function(t){return t.color}).attr("stroke-opacity",i.strokeOpacity).attr("stroke",i.stroke).attr("d",h),r.label&&"heatmap"===o){var v=this.font(u)+"px",m=p.selectAll(".labels").data(c.data);m.enter().append("text").classed("labels",!0).attr("transform",function(t){return"translate("+t.x+", "+t.y+")"}).style("text-anchor","middle").style("alignment-baseline","middle").style("fill",n).style("font-size",v).text(e).merge(m).text(e).style("font-size",v).call(Pf,Math.ceil(.8*c.size)).transition(this.transition("text")).attr("transform",function(t){return"translate("+t.x+", "+t.y+")"}).style("fill",n)}var y={innerWidth:c.width,innerHeight:c.height,margin:{top:u.margin.top+f,left:u.margin.left+l}};r.axisX&&this.xAxis1(!0===r.axisX?"bottom":r.axisX,c.scaleX,y),r.axisY&&this.yAxis1(!0===r.axisY?"left":r.axisY,c.scaleY,y),"heatmap"===o?this.legend({type:"color",shape:r.shape,scale:c.colors},u):"punchcard"===o&&this.legend({type:"size",shape:r.shape,scale:c.sizes},u)},heatmap:function(t,e,r,i){var a=this.getModel(),o=a.pad,u=a.x,s=a.y,c=a.z,l=e.dimension(a.x).group().size(),f=e.dimension(a.y).group().size(),h=Math.min(a.buckets,l*f),d=(1-o*(l+1))*r.innerWidth/l,p=(1-o*(f+1))*r.innerHeight/f,g=[],v=[],m=[],y=n(),b=n(),_=void 0,x=void 0,w=void 0,M=void 0,k=void 0,A=void 0,E=void 0,T=void 0,S=void 0,C=void 0;if(d<p?(T=d,S=r.innerWidth,C=f*(T+(o*=S))+o):(T=p,C=r.innerHeight,S=l*(T+(o*=C))+o),i=Cf(i,h),"heatmap"===t){var N=this.fill(pa(h)).colors;a.reverseColors&&(N=N.reverse()),A=this.getScale("quantile").range(N).domain(i),E=function(){return 1}}else{var P=this.colors(1)[0];A=function(){return P},E=this.getScale("quantile").range(pa(h).map(function(t){return(t+1)/h})).domain(i)}return e.data.forEach(function(t){_=t[u],x=t[s],w=t[c],y.has(_)||(y.set(_,v.length),v.push(_)),b.has(x)||(b.set(x,m.length),m.push(x)),M=y.get(_),k=b.get(x),g.push({i:M,j:k,x:o+T/2+M*(T+o),y:o+T/2+k*(T+o),color:A(w),size:T*E(w),data:t})}),{data:g,size:T,width:S,height:C,scaleX:this.getScale("band").domain(v).range([0,S]),scaleY:this.getScale("band").domain(m).range([0,C]),colors:A,sizes:E}}}),Rs("geochart",{requires:["d3-geo","topojson","d3-geo-projection"],options:{geometry:"countries",geoKey:"id",dataKey:"id",dataLabelKey:"label",dataValueKey:"value",buckets:10,choroplethScale:"quantile",boundGeometry:null,boundScaleFactor:.9,projection:null,graticule:!1,leaflet:!1,scale:200,mouseover:["darken","tooltip"]},doDraw:function(t,e){var n=this.getGeoData(t);if(!n)return qa("Topojson data not available - cannot draw topology");this._geoPath||this.createGeoPath(e,n),this.update(e,n)},update:function(t,e){var n=this.getModel(),r=this.getModel("color"),i=this.boundingBox(),a=this.group(),o=this.group("geo"),u=this._geoPath,s=e.topology.objects[n.geometry],c=s?t.feature(e.topology,s).features:null,l=c?o.selectAll(".geometry").data(c):null,f="none";if(!l){var h=Object.keys(e.topology.objects).map(function(t){return'"'+t+'"'}).join(", ");return qa('Could not find *geometry* "'+n.geometry+'" in ['+h+"] - cannot draw geochart")}a.transition(this.transition("group0")).attr("transform",this.translate(i.padding.left,i.padding.top)),o.transition(this.transition("group1")).attr("transform",this.translate(i.margin.left,i.margin.top)),this.center(t,e),e.data&&(f=this.choropleth(e.data,i)),l.enter().append("path").attr("class","geometry").attr("d",u).style("fill","none").style("stroke",r.stroke).style("stroke-opacity",0).style("fill-opacity",0).on("mouseover",this.mouseOver()).on("mouseout",this.mouseOut()).merge(l).transition(this.transition("geometry")).attr("d",u).style("stroke",r.stroke).style("stroke-opacity",r.strokeOpacity).style("fill",f).style("fill-opacity",r.fillOpacity),l.exit().remove()},createGeoPath:function(t,e){var n,r=this.getModel(),i=Ys(t,"geo",e.projection).scale(r.scale),a=t.geoPath().projection(i),o=this;if(this._geoPath=a,this.center(t,e),r.leaflet){var u="leaflet-"+r.uid,s=this.paper();this.visualParent.paper.append("div").attr("id",u),(n=new t.Map(u,{center:[37.8,-96.9],zoom:4}).addLayer(new t.TileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"))).getPanes().overlayPane.appendChild(s.element),i=t.transform({point:function(e,r){var i=n.latLngToLayerPoint(new t.LatLng(r,e));this.stream.point(i.x,i.y)}}),n.on("viewreset",function(){return o.update(t,e)})}return a},getGeoData:function(t){var e={};if("frameCollection"===t.type?t.frames.each(function(t){"Topology"===t.type?e.topology=t:"dataframe"===t.type&&(e.data=t)}):"Topology"===t.type&&(e.topology=t),e.topology){var n=this.getModel();return n.projection?e.projection=n.proection:e.projection="kavrayskiy7",e}},center:function(t,e){var n=this.getModel();if(n.boundGeometry){var r=this._geoPath,i=r.projection(),a=this.boundingBox(),o=e.topology.objects[n.boundGeometry],u=o?t.feature(e.topology,o).features:null;if(!u)return qa('Could not find *boundGeometry* "'+n.boundGeometry+'" for centering - skip centering geochart');i.scale(1).translate([0,0]);var s=r.bounds(u[0]),c=s[0],l=s[1],f=(l[0]-c[0])/a.innerWidth,h=(l[1]-c[1])/a.innerHeight,d=Math.round(n.boundScaleFactor/Math.max(f,h)),p=[(a.innerWidth-d*(l[0]+c[0]))/2,(a.innerHeight-d*(l[1]+c[1]))/2];i.scale(d).translate(p)}},choropleth:function(t,e){var n=this.getModel(),r=Math.min(n.buckets,t.data.length),i=n.dataKey,a=n.dataLabelKey,o=n.dataValueKey,u=n.geoKey,s=Cf(da(t.data,La(o)),r),c=this.getScale(n.choroplethScale).range(this.colors(r).reverse()).domain(s),l=t.data.reduce(function(t,e){return t[e[i]]=e,t},{}),f=void 0,h=void 0;return this.legend({type:"color",scale:c},e),function(t){return f=t.properties[u]||t[u],h=l[f],t.choropleth={label:h[a]||f,value:h[o],color:c(h[o])},t.choropleth.color}}}),Rs("geochart2",{requires:["d3-geo","topojson","d3-geo-projection"],options:{geometry:"countries",geoKey:"id",dataKey:"id",dataLabelKey:"label",dataValueKey:"value",neighbors:!1,buckets:10,choroplethScale:"quantile",boundGeometry:null,boundScaleFactor:.9,projection:"kavrayskiy7",graticule:!1,leaflet:!1,scale:200,mouseover:["darken","tooltip"]},doDraw:function(t,e){var n=function(t){var e={};return"frameCollection"===t.type?t.frames.each(function(t){"Topology"===t.type?e.topology=t:"dataframe"===t.type&&(e.data=t.data)}):"Topology"===t.type&&(e.topology=t),e}(t);if(!n.topology)return qa("Topojson data not available - cannot draw topology");this._geoPath||this.createGeoPath(e,n),this.update(e,n)},update:function(t,e){var n=this.getModel(),r=this.getModel("color"),i=this.boundingBox(),a=this.group(),o=this.group("geo"),u=this._geoPath,s=function(t,e,n){var r=n.geoKey,i=n.dataKey,a={},o=void 0,u=void 0,s=void 0;if(!e.topology)return qa("No topology object available");var c=e.topology.objects[n.geometry];if(!c)return qa("Topology object "+n.geometry+" is not available");var l=n.neighbors?t.neighbors(c.geometries):null;return o=t.feature(e.topology,c).features,e.data&&(a=e.data.reduce(function(t,e){return t[e[i]]=e,t},{})),o=o.map(function(t){return s=t.properties,u=t[r]||s[r],{id:u,type:t.type,geometry:t.geometry,data:er({},s,a[u])}}),l&&o.forEach(function(t,e){t.neighbors=l[e],t.rank=_a(t.neighbors,function(t){return o[t].rank})+1|0}),o}(t,e,n);if(!s){var c=Object.keys(e.topology.objects).map(function(t){return'"'+t+'"'}).join(", ");return qa('Could not find *geometry* "'+n.geometry+'" in ['+c+"] - cannot draw geochart")}a.transition(this.transition("group0")).attr("transform",this.translate(i.padding.left,i.padding.top)),o.transition(this.transition("group1")).attr("transform",this.translate(i.margin.left,i.margin.top));var l=o.selectAll(".geometry").data(s),f=this.choropleth(s,i);this.center(t,e),l.enter().append("path").attr("class","geometry").attr("d",u).style("fill","none").style("stroke",this.modelProperty("stroke",r)).on("mouseover",this.mouseOver()).on("mouseout",this.mouseOut()).merge(l).transition(this.transition("geometry")).attr("d",u).style("stroke",this.modelProperty("stroke",r)).style("fill",f).style("fill-opacity",r.fillOpacity),l.exit().remove()},createGeoPath:function(t,e){var n,r=this.getModel(),i=Ys(t,"geo",r.projection).scale(r.scale),a=t.geoPath().projection(i),o=this;if(this._geoPath=a,this.center(t,e),r.leaflet){var u="leaflet-"+r.uid,s=this.paper();this.visualParent.paper.append("div").attr("id",u),(n=new t.Map(u,{center:[37.8,-96.9],zoom:4}).addLayer(new t.TileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"))).getPanes().overlayPane.appendChild(s.element),i=t.transform({point:function(e,r){var i=n.latLngToLayerPoint(new t.LatLng(r,e));this.stream.point(i.x,i.y)}}),n.on("viewreset",function(){return o.update(t,e)})}return a},center:function(t,e){var n=this.getModel();if(n.boundGeometry){var r=this._geoPath,i=r.projection(),a=this.boundingBox(),o=e.topology.objects[n.boundGeometry],u=o?t.feature(e.topology,o).features:null;if(!u)return qa('Could not find *boundGeometry* "'+n.boundGeometry+'" for centering - skip centering geochart');i.scale(1).translate([0,0]);var s=r.bounds(u[0]),c=s[0],l=s[1],f=(l[0]-c[0])/a.innerWidth,h=(l[1]-c[1])/a.innerHeight,d=Math.round(n.boundScaleFactor/Math.max(f,h)),p=[(a.innerWidth-d*(l[0]+c[0]))/2,(a.innerHeight-d*(l[1]+c[1]))/2];i.scale(d).translate(p)}},choropleth:function(t,e){var n=this.getModel(),r=n.dataLabelKey,i=n.dataValueKey,a=void 0,o=void 0,u=void 0,s=void 0;return n.neighbors?(a=La("rank"),s=(o=da(t,a))[1]+1):(a=function(t){return t.data[i]},s=Math.min(n.buckets,t.length),o=Cf(da(t,a),s)),u=this.getScale(n.choroplethScale).range(this.colors(s).reverse()).domain(o),this.legend({type:"color",scale:u},e),function(t){return t.label=t.data[r]||t.id,t.value=a(t),t.color=u(t.value),t.color}}}),rr&&window.development&&lr.setDebug(!0),er(Gu.options.dataContext,{$geoDataCode:function(t){if(this.filters){var e=(void this.filters.country).code+"-regions";return t?e+"-"+t:e}},$region:function(){}}),$i(function(){(function(){var t=ji().use(Qi).use(ea).use(Tf);return Si.on("component-mounted",function(t){"d3form"===t.name&&t.model.$on(function(){})}),t})().mount("body")}),t.mapsVersion="0.0.4",t.view=ji,t.viewMount=function(t,e,n,r){var i=Wr(t).html(e).mount(n,r);return i||(i=new Promise(function(t){t()})),i},t.viewBase=ri,t.viewEvents=Si,t.viewModel=W,t.viewExpression=bi,t.viewReady=$i,t.viewProviders=lr,t.viewWarn=fr,t.viewDebug=ur,t.viewForms=Qi,t.viewBootstrapForms=ea,t.viewUid=xi,t.viewDebounce=Er,t.jsep=vi,t.require=ua,t.viewVersion="0.9.3",t.resolvedPromise=ti,t.viewElement=z,t.viewTemplate=N,t.viewHtml=P,t.jsonResponse=D,Object.defineProperty(t,"__esModule",{value:!0})});